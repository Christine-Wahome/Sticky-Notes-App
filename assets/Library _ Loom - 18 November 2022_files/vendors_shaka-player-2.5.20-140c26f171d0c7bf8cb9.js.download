/*! For license information please see vendors~shaka-player-2.5.20-140c26f171d0c7bf8cb9.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{wyJY:function(i,a,o){(function(i){!function(){var o="undefined"!=typeof window?window:i,s={};for(var l in function(i,a,o){var s,l="function"==typeof Object.defineProperties?Object.defineProperty:function(i,a,o){i!=Array.prototype&&i!=Object.prototype&&(i[a]=o.value)},C=void 0!==i&&i===this?this:void 0!==a&&null!=a?a:this;function da(){da=function(){},C.Symbol||(C.Symbol=R)}var R=function(){var i=0;return function(a){return"jscomp_symbol_"+(a||"")+i++}}();function ha(){da();var i=C.Symbol.iterator;i||(i=C.Symbol.iterator=C.Symbol("iterator")),"function"!=typeof Array.prototype[i]&&l(Array.prototype,i,{configurable:!0,writable:!0,value:function(){return ia(this)}}),ha=function(){}}function ia(i){var a=0;return ka((function(){return a<i.length?{done:!1,value:i[a++]}:{done:!0}}))}function ka(i){return ha(),(i={next:i})[C.Symbol.iterator]=function(){return this},i}function t(i){ha();var a=i[Symbol.iterator];return a?a.call(i):ia(i)}function ma(i,a){if(a){for(var o=C,s=i.split("."),R=0;R<s.length-1;R++){var j=s[R];j in o||(o[j]={}),o=o[j]}(j=a(R=o[s=s[s.length-1]]))!=R&&null!=j&&l(o,s,{configurable:!0,writable:!0,value:j})}}function u(i){return function na(i){function c(a){return i.next(a)}function d(a){return i.throw(a)}return new Promise((function(a,o){!function g(i){i.done?a(i.value):Promise.resolve(i.value).then(c,d).then(g,o)}(i.next())}))}(i())}ma("Promise",(function(i){function c(i){this.b=0,this.g=void 0,this.a=[];var a=this.c();try{i(a.resolve,a.reject)}catch(i){a.reject(i)}}function d(){this.a=null}function e(i){return i instanceof c?i:new c((function(a){a(i)}))}if(i)return i;d.prototype.b=function(i){null==this.a&&(this.a=[],this.f()),this.a.push(i)},d.prototype.f=function(){var i=this;this.c((function(){i.h()}))};var a=C.setTimeout;d.prototype.c=function(i){a(i,0)},d.prototype.h=function(){for(;this.a&&this.a.length;){var i=this.a;this.a=[];for(var a=0;a<i.length;++a){var o=i[a];i[a]=null;try{o()}catch(i){this.g(i)}}}this.a=null},d.prototype.g=function(i){this.c((function(){throw i}))},c.prototype.c=function(){function b(o){return function(s){a||(a=!0,o.call(i,s))}}var i=this,a=!1;return{resolve:b(this.u),reject:b(this.f)}},c.prototype.u=function(i){if(i===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(i instanceof c)this.w(i);else{e:switch(typeof i){case"object":var a=null!=i;break e;case"function":a=!0;break e;default:a=!1}a?this.o(i):this.h(i)}},c.prototype.o=function(i){var a=void 0;try{a=i.then}catch(i){return void this.f(i)}"function"==typeof a?this.D(a,i):this.h(i)},c.prototype.f=function(i){this.i(2,i)},c.prototype.h=function(i){this.i(1,i)},c.prototype.i=function(i,a){if(0!=this.b)throw Error("Cannot settle("+i+", "+a+"): Promise already settled in state"+this.b);this.b=i,this.g=a,this.l()},c.prototype.l=function(){if(null!=this.a){for(var i=0;i<this.a.length;++i)o.b(this.a[i]);this.a=null}};var o=new d;return c.prototype.w=function(i){var a=this.c();i.kc(a.resolve,a.reject)},c.prototype.D=function(i,a){var o=this.c();try{i.call(a,o.resolve,o.reject)}catch(i){o.reject(i)}},c.prototype.then=function(i,a){function e(i,a){return"function"==typeof i?function(a){try{o(i(a))}catch(i){s(i)}}:a}var o,s,l=new c((function(i,a){o=i,s=a}));return this.kc(e(i,o),e(a,s)),l},c.prototype.catch=function(i){return this.then(void 0,i)},c.prototype.kc=function(i,a){function d(){switch(s.b){case 1:i(s.g);break;case 2:a(s.g);break;default:throw Error("Unexpected state: "+s.b)}}var s=this;null==this.a?o.b(d):this.a.push(d)},c.resolve=e,c.reject=function(i){return new c((function(a,o){o(i)}))},c.race=function(i){return new c((function(a,o){for(var s=t(i),l=s.next();!l.done;l=s.next())e(l.value).kc(a,o)}))},c.all=function(i){var a=t(i),o=a.next();return o.done?e([]):new c((function(i,s){function g(a){return function(o){l[a]=o,0==--C&&i(l)}}var l=[],C=0;do{l.push(void 0),C++,e(o.value).kc(g(l.length-1),s),o=a.next()}while(!o.done)}))},c})),ma("Promise.prototype.finally",(function(i){return i||function(i){return this.then((function(a){return Promise.resolve(i()).then((function(){return a}))}),(function(a){return Promise.resolve(i()).then((function(){throw a}))}))}}));var j,U="function"==typeof Object.create?Object.create:function(i){function c(){}return c.prototype=i,new c};if("function"==typeof Object.setPrototypeOf)j=Object.setPrototypeOf;else{var _;e:{var O={};try{O.__proto__={Oe:!0},_=O.Oe;break e}catch(i){}_=!1}j=_?function(i,a){if(i.__proto__=a,i.__proto__!==a)throw new TypeError(i+" is not extensible");return i}:null}var B=j;function xa(i,a){if(i.prototype=U(a.prototype),i.prototype.constructor=i,B)B(i,a);else for(var o in a)if("prototype"!=o)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(a,o);s&&Object.defineProperty(i,o,s)}else i[o]=a[o];i.Dg=a.prototype}function ya(){this.g=!1,this.c=null,this.s=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function za(i){if(i.g)throw new TypeError("Generator is already running");i.g=!0}function Aa(i,a){i.a={Yd:a,ie:!0},i.j=i.f||i.b}function v(i,a,o){return i.j=o,{value:a}}function w(i){i.j=0}function Ba(i,a,o){i.f=a,null!=o&&(i.b=o)}function Ca(i,a){i.f=0,i.b=a||0}function Fa(i,a){i.j=a,i.f=0}function Ga(i){i.f=0;var a=i.a.Yd;return i.a=null,a}function Ha(i){i.i=[i.a],i.f=0,i.b=0}function La(i,a){var o=i.i.splice(0)[0];(o=i.a=i.a||o)?o.ie?i.j=i.f||i.b:null!=o.C&&i.b<o.C?(i.j=o.C,i.a=null):i.j=i.b:i.j=a}function Ma(i){this.a=new ya,this.b=i}function Oa(i,a,o,s){try{var l=a.call(i.a.c,o);if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");if(!l.done)return i.a.g=!1,l;var C=l.value}catch(a){return i.a.c=null,Aa(i.a,a),Qa(i)}return i.a.c=null,s.call(i.a,C),Qa(i)}function Qa(i){for(;i.a.j;)try{var a=i.b(i.a);if(a)return i.a.g=!1,{value:a.value,done:!1}}catch(a){i.a.s=void 0,Aa(i.a,a)}if(i.a.g=!1,i.a.a){if(a=i.a.a,i.a.a=null,a.ie)throw a.Yd;return{value:a.return,done:!0}}return{value:void 0,done:!0}}function Ra(i){this.next=function(a){return za(i.a),i.a.c?a=Oa(i,i.a.c.next,a,i.a.h):(i.a.h(a),a=Qa(i)),a},this.throw=function(a){return za(i.a),i.a.c?a=Oa(i,i.a.c.throw,a,i.a.h):(Aa(i.a,a),a=Qa(i)),a},this.return=function(a){return function Na(i,a){za(i.a);var o=i.a.c;return o?Oa(i,"return"in o?o.return:function(i){return{value:i,done:!0}},a,i.a.return):(i.a.return(a),Qa(i))}(i,a)},ha(),this[Symbol.iterator]=function(){return this}}function x(i,a){return Ra.prototype=i.prototype,new Ra(new Ma(a))}function Ta(i,a){return Object.prototype.hasOwnProperty.call(i,a)}function Ua(i,a,o){i instanceof String&&(i=String(i));for(var s=i.length,l=0;l<s;l++){var C=i[l];if(a.call(o,C,l,i))return{fe:l,Je:C}}return{fe:-1,Je:void 0}}function Wa(i,a,o){if(null==i)throw new TypeError("The 'this' value for String.prototype."+o+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+o+" must not be a regular expression");return i+""}ya.prototype.h=function(i){this.s=i},ya.prototype.return=function(i){this.a={return:i},this.j=this.b},ya.prototype.C=function(i){this.j=i},ma("WeakMap",(function(i){function c(i){if(this.a=(o+=Math.random()+1).toString(),i){da(),ha(),i=t(i);for(var a;!(a=i.next()).done;)a=a.value,this.set(a[0],a[1])}}function d(i){Ta(i,a)||l(i,a,{value:{}})}function e(i){var a=Object[i];a&&(Object[i]=function(i){return d(i),a(i)})}if(function(){if(!i||!Object.seal)return!1;try{var a=Object.seal({}),o=Object.seal({}),s=new i([[a,2],[o,3]]);return 2==s.get(a)&&3==s.get(o)&&(s.delete(a),s.set(o,4),!s.has(a)&&4==s.get(o))}catch(i){return!1}}())return i;var a="$jscomp_hidden_"+Math.random();e("freeze"),e("preventExtensions"),e("seal");var o=0;return c.prototype.set=function(i,o){if(d(i),!Ta(i,a))throw Error("WeakMap key fail: "+i);return i[a][this.a]=o,this},c.prototype.get=function(i){return Ta(i,a)?i[a][this.a]:void 0},c.prototype.has=function(i){return Ta(i,a)&&Ta(i[a],this.a)},c.prototype.delete=function(i){return!(!Ta(i,a)||!Ta(i[a],this.a))&&delete i[a][this.a]},c})),ma("Map",(function(i){function c(){var i={};return i.Ja=i.next=i.head=i}function d(i,a){var o=i.a;return ka((function(){if(o){for(;o.head!=i.a;)o=o.Ja;for(;o.next!=o.head;)return o=o.next,{done:!1,value:a(o)};o=null}return{done:!0,value:void 0}}))}function e(i,s){var l=s&&typeof s;"object"==l||"function"==l?a.has(s)?l=a.get(s):(l=""+ ++o,a.set(s,l)):l="p_"+s;var C=i.b[l];if(C&&Ta(i.b,l))for(var R=0;R<C.length;R++){var j=C[R];if(s!=s&&j.key!=j.key||s===j.key)return{id:l,list:C,index:R,ba:j}}return{id:l,list:C,index:-1,ba:void 0}}function f(i){if(this.b={},this.a=c(),this.size=0,i){i=t(i);for(var a;!(a=i.next()).done;)a=a.value,this.set(a[0],a[1])}}if(function(){if(!i||"function"!=typeof i||!i.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),o=new i(t([[a,"s"]]));if("s"!=o.get(a)||1!=o.size||o.get({x:4})||o.set({x:4},"t")!=o||2!=o.size)return!1;var s=o.entries(),l=s.next();return!l.done&&l.value[0]==a&&"s"==l.value[1]&&!((l=s.next()).done||4!=l.value[0].x||"t"!=l.value[1]||!s.next().done)}catch(i){return!1}}())return i;da(),ha();var a=new WeakMap;f.prototype.set=function(i,a){var o=e(this,i);return o.list||(o.list=this.b[o.id]=[]),o.ba?o.ba.value=a:(o.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:i,value:a},o.list.push(o.ba),this.a.Ja.next=o.ba,this.a.Ja=o.ba,this.size++),this},f.prototype.delete=function(i){return!(!(i=e(this,i)).ba||!i.list)&&(i.list.splice(i.index,1),i.list.length||delete this.b[i.id],i.ba.Ja.next=i.ba.next,i.ba.next.Ja=i.ba.Ja,i.ba.head=null,this.size--,!0)},f.prototype.clear=function(){this.b={},this.a=this.a.Ja=c(),this.size=0},f.prototype.has=function(i){return!!e(this,i).ba},f.prototype.get=function(i){return(i=e(this,i).ba)&&i.value},f.prototype.entries=function(){return d(this,(function(i){return[i.key,i.value]}))},f.prototype.keys=function(){return d(this,(function(i){return i.key}))},f.prototype.values=function(){return d(this,(function(i){return i.value}))},f.prototype.forEach=function(i,a){for(var o,s=this.entries();!(o=s.next()).done;)o=o.value,i.call(a,o[1],o[0],this)},f.prototype[Symbol.iterator]=f.prototype.entries;var o=0;return f})),ma("Set",(function(i){function c(i){if(this.a=new Map,i){i=t(i);for(var a;!(a=i.next()).done;)this.add(a.value)}this.size=this.a.size}return function(){if(!i||"function"!=typeof i||!i.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),o=new i(t([a]));if(!o.has(a)||1!=o.size||o.add(a)!=o||1!=o.size||o.add({x:4})!=o||2!=o.size)return!1;var s=o.entries(),l=s.next();return!l.done&&l.value[0]==a&&l.value[1]==a&&(!(l=s.next()).done&&l.value[0]!=a&&4==l.value[0].x&&l.value[1]==l.value[0]&&s.next().done)}catch(i){return!1}}()?i:(da(),ha(),c.prototype.add=function(i){return this.a.set(i,i),this.size=this.a.size,this},c.prototype.delete=function(i){return i=this.a.delete(i),this.size=this.a.size,i},c.prototype.clear=function(){this.a.clear(),this.size=0},c.prototype.has=function(i){return this.a.has(i)},c.prototype.entries=function(){return this.a.entries()},c.prototype.values=function(){return this.a.values()},c.prototype.keys=c.prototype.values,c.prototype[Symbol.iterator]=c.prototype.values,c.prototype.forEach=function(i,a){var o=this;this.a.forEach((function(s){return i.call(a,s,s,o)}))},c)})),ma("Array.prototype.findIndex",(function(i){return i||function(i,a){return Ua(this,i,a).fe}})),ma("Array.prototype.keys",(function(i){return i||function(){return function Va(i,a){ha(),i instanceof String&&(i+="");var o=0,s={next:function(){if(o<i.length){var l=o++;return{value:a(l,i[l]),done:!1}}return s.next=function(){return{done:!0,value:void 0}},s.next()}};return s[Symbol.iterator]=function(){return s},s}(this,(function(i){return i}))}})),ma("Object.is",(function(i){return i||function(i,a){return i===a?0!==i||1/i==1/a:i!=i&&a!=a}})),ma("Array.prototype.includes",(function(i){return i||function(i,a){var o=this;o instanceof String&&(o=String(o));var s=o.length,l=a||0;for(0>l&&(l=Math.max(l+s,0));l<s;l++){var C=o[l];if(C===i||Object.is(C,i))return!0}return!1}})),ma("String.prototype.includes",(function(i){return i||function(i,a){return-1!==Wa(this,i,"includes").indexOf(i,a||0)}})),ma("Array.from",(function(i){return i||function(i,a,o){ha(),a=null!=a?a:function(i){return i};var s=[],l=i[Symbol.iterator];if("function"==typeof l)for(i=l.call(i);!(l=i.next()).done;)s.push(a.call(o,l.value));else{l=i.length;for(var C=0;C<l;C++)s.push(a.call(o,i[C]))}return s}})),ma("String.prototype.startsWith",(function(i){return i||function(i,a){for(var o=Wa(this,i,"startsWith"),s=o.length,l=i.length,C=Math.max(0,Math.min(0|a,o.length)),R=0;R<l&&C<s;)if(o[C++]!=i[R++])return!1;return R>=l}})),ma("Array.prototype.find",(function(i){return i||function(i,a){return Ua(this,i,a).Je}}));var F="function"==typeof Object.assign?Object.assign:function(i,a){for(var o=1;o<arguments.length;o++){var s=arguments[o];if(s)for(var l in s)Ta(s,l)&&(i[l]=s[l])}return i};ma("Object.assign",(function(i){return i||F}));var H=this;function A(i,a){var o,s=i.split("."),l=H;s[0]in l||!l.execScript||l.execScript("var "+s[0]);for(;s.length&&(o=s.shift());)s.length||void 0===a?l=l[o]?l[o]:l[o]={}:l[o]=a}function bb(i,a){function d(){}d.prototype=a.prototype,i.Dg=a.prototype,i.prototype=new d,i.prototype.constructor=i,i.Og=function(i,o,s){return a.prototype[o].apply(i,Array.prototype.slice.call(arguments,2))}}function cb(i){this.c=Math.exp(Math.log(.5)/i),this.b=this.a=0}function db(i,a,o){var s=Math.pow(i.c,a);o=o*(1-s)+s*i.a,isNaN(o)||(i.a=o,i.b+=a)}function eb(i){return i.a/(1-Math.pow(i.c,i.b))}function fb(){this.b=new cb(2),this.c=new cb(5),this.a=0}H.a=!0,fb.prototype.getBandwidthEstimate=function(i){return 128e3>this.a?i:Math.min(eb(this.b),eb(this.c))};var G={mb:0,jc:function(){},Z:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},F:function(){},J:function(){}};function D(i,a,o,s){for(var l=[],C=3;C<arguments.length;++C)l[C-3]=arguments[C];this.severity=i,this.category=a,this.code=o,this.data=l,this.handled=!1}i.console&&i.console.log.bind&&(G.Z=console.warn.bind(console),G.jc=console.error.bind(console),1<=G.mb&&(G.error=console.error.bind(console)),2<=G.mb&&(G.m=console.warn.bind(console)),3<=G.mb&&(G.info=console.info.bind(console)),4<=G.mb&&(G.debug=console.log.bind(console)),5<=G.mb&&(G.F=console.debug.bind(console)),6<=G.mb&&(G.J=console.debug.bind(console))),A("shaka.util.Error",D),D.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},D.Severity={RECOVERABLE:1,CRITICAL:2},D.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},D.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};var W=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function hb(i){var a;i instanceof hb?(ib(this,i.xa),this.jb=i.jb,this.wa=i.wa,jb(this,i.Jb),this.la=i.la,kb(this,i.a.clone()),this.Xa=i.Xa):i&&(a=String(i).match(W))?(ib(this,a[1]||"",!0),this.jb=ob(a[2]||""),this.wa=ob(a[3]||"",!0),jb(this,a[4]),this.la=ob(a[5]||"",!0),kb(this,a[6]||"",!0),this.Xa=ob(a[7]||"")):this.a=new pb(null)}function ib(i,a,o){i.xa=o?ob(a,!0):a,i.xa&&(i.xa=i.xa.replace(/:$/,""))}function jb(i,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);i.Jb=a}else i.Jb=null}function kb(i,a,o){a instanceof pb?i.a=a:(o||(a=qb(a,Ee)),i.a=new pb(a))}function ob(i,a){return i?a?decodeURI(i):decodeURIComponent(i):""}function qb(i,a,o){return"string"==typeof i?(i=encodeURI(i).replace(a,wb),o&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function wb(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}(s=hb.prototype).xa="",s.jb="",s.wa="",s.Jb=null,s.la="",s.Xa="",s.toString=function(){var i=[],a=this.xa;if(a&&i.push(qb(a,$,!0),":"),a=this.wa){i.push("//");var o=this.jb;o&&i.push(qb(o,$,!0),"@"),i.push(encodeURIComponent(a).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(a=this.Jb)&&i.push(":",String(a))}return(a=this.la)&&(this.wa&&"/"!=a.charAt(0)&&i.push("/"),i.push(qb(a,"/"==a.charAt(0)?ye:he,!0))),(a=this.a.toString())&&i.push("?",a),(a=this.Xa)&&i.push("#",qb(a,Me)),i.join("")},s.resolve=function(i){var a=this.clone();"data"===a.xa&&(a=new hb);var o=!!i.xa;o?ib(a,i.xa):o=!!i.jb,o?a.jb=i.jb:o=!!i.wa,o?a.wa=i.wa:o=null!=i.Jb;var s=i.la;if(o)jb(a,i.Jb);else if(o=!!i.la){if("/"!=s.charAt(0))if(this.wa&&!this.la)s="/"+s;else{var l=a.la.lastIndexOf("/");-1!=l&&(s=a.la.substr(0,l+1)+s)}if(".."==s||"."==s)s="";else if(-1!=s.indexOf("./")||-1!=s.indexOf("/.")){l=0==s.lastIndexOf("/",0),s=s.split("/");for(var C=[],R=0;R<s.length;){var j=s[R++];"."==j?l&&R==s.length&&C.push(""):".."==j?((1<C.length||1==C.length&&""!=C[0])&&C.pop(),l&&R==s.length&&C.push("")):(C.push(j),l=!0)}s=C.join("/")}}return o?a.la=s:o=""!==i.a.toString(),o?kb(a,i.a.clone()):o=!!i.Xa,o&&(a.Xa=i.Xa),a},s.clone=function(){return new hb(this)};var $=/[#\/\?@]/g,he=/[#\?:]/g,ye=/[#\?]/g,Ee=/[#\?@]/g,Me=/#/g;function pb(i){this.a=i||null}(s=pb.prototype).ja=null,s.nc=null,s.add=function(i,a){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var o=this.a.split("&"),s=0;s<o.length;s++){var l=o[s].indexOf("="),C=null;if(0<=l){var R=o[s].substring(0,l);C=o[s].substring(l+1)}else R=o[s];R=decodeURIComponent(R.replace(/\+/g," ")),C=C||"",this.add(R,decodeURIComponent(C.replace(/\+/g," ")))}return this.a=null,(o=this.ja.hasOwnProperty(i)&&this.ja[i])||(this.ja[i]=o=[]),o.push(a),this.nc++,this},s.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var i,a=[];for(i in this.ja)for(var o=encodeURIComponent(i),s=this.ja[i],l=0;l<s.length;l++){var C=o;""!==s[l]&&(C+="="+encodeURIComponent(s[l])),a.push(C)}return this.a=a.join("&")},s.clone=function(){var i=new pb;if(i.a=this.a,this.ja){var a,o={};for(a in this.ja)o[a]=this.ja[a].concat();i.ja=o,i.nc=this.nc}return i};var Ie={Ye:function(i,a){return i.reduce(function(i,a,o){return a.catch(i.bind(null,o))}.bind(null,a),Promise.reject())},Oc:function(i,a){return i.concat(a)},wc:function(){},Na:function(i){return null!=i}};function yb(i,a){if(0==a.length)return i;var o=a.map((function(i){return new hb(i)}));return i.map((function(i){return new hb(i)})).map((function(i){return o.map(i.resolve.bind(i))})).reduce(Ie.Oc,[]).map((function(i){return i.toString()}))}function zb(i,a){return{keySystem:i,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:a||[],keyIds:[]}}var Pe={Ua:"video",Nb:"audio",va:"text",Mg:"image",Kg:"application"},Ne=1/15;function E(){var i,a,o=new Promise((function(o,s){i=o,a=s}));return o.resolve=i,o.reject=a,o}function Gb(i){if(!i)return"";239==(i=new Uint8Array(i))[0]&&187==i[1]&&191==i[2]&&(i=i.subarray(3)),i=Hb(i),i=escape(i);try{return decodeURIComponent(i)}catch(i){throw new D(2,2,2004)}}function Ib(i,a,o){if(!i)return"";if(!o&&0!=i.byteLength%2)throw G.error("Data has an incorrect length, must be even."),new D(2,2,2004);if(i instanceof ArrayBuffer)var s=i;else(o=new Uint8Array(i.byteLength)).set(new Uint8Array(i)),s=o.buffer;i=Math.floor(i.byteLength/2),o=new Uint16Array(i),s=new DataView(s);for(var l=0;l<i;l++)o[l]=s.getUint16(2*l,a);return Hb(o)}function Jb(i){var a=new Uint8Array(i);if(239==a[0]&&187==a[1]&&191==a[2])return Gb(a);if(254==a[0]&&255==a[1])return Ib(a.subarray(2),!1);if(255==a[0]&&254==a[1])return Ib(a.subarray(2),!0);var o=function(i,a){return i.byteLength<=a||32<=i[a]&&126>=i[a]}.bind(null,a);if(G.debug("Unable to find byte-order-mark, making an educated guess."),0==a[0]&&0==a[2])return Ib(i,!1);if(0==a[1]&&0==a[3])return Ib(i,!0);if(o(0)&&o(1)&&o(2)&&o(3))return Gb(i);throw new D(2,2,2003)}function Kb(i){i=encodeURIComponent(i),i=unescape(i);for(var a=new Uint8Array(i.length),o=0;o<i.length;++o)a[o]=i.charCodeAt(o);return a.buffer}function Lb(i,a){for(var o=new Uint8Array(2*i.length),s=new DataView(o.buffer),l=0;l<i.length;++l)s.setUint16(2*l,i.charCodeAt(l),a);return o.buffer}function Hb(i){if(!Re)for(var c=function(i){try{var a=new Uint8Array(i);return 0<String.fromCharCode.apply(null,a).length}catch(i){return!1}},a={size:65536};0<a.size;(a={size:a.size}).size/=2)if(c(a.size)){Re=function(i){return function(a){for(var o="",s=0;s<a.length;s+=i.size)o+=String.fromCharCode.apply(null,a.subarray(s,s+i.size));return o}}(a);break}return Re(i)}E.prototype.resolve=function(){},E.prototype.reject=function(){},A("shaka.util.StringUtils.fromUTF8",Gb),A("shaka.util.StringUtils.fromUTF16",Ib),A("shaka.util.StringUtils.fromBytesAutoDetect",Jb),A("shaka.util.StringUtils.toUTF8",Kb),A("shaka.util.StringUtils.toUTF16",Lb);var Re=null;A("shaka.util.StringUtils.resetFromCharCode",(function(){Re=null}));var Le={Hc:function(a,o){var s=Hb(a);return o=null==o||o,s=i.btoa(s).replace(/\+/g,"-").replace(/\//g,"_"),o?s:s.replace(/=*$/,"")}};function Nb(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function Ob(a,o){return!(!i.muxjs||"mp2t"!=a.toLowerCase().split(";")[0].split("/")[1])&&(o?MediaSource.isTypeSupported(Pb(o,a)):MediaSource.isTypeSupported(Pb("audio",a))||MediaSource.isTypeSupported(Pb("video",a)))}function Pb(i,a){var o=a.replace(/mp2t/i,"mp4");"audio"==i&&(o=o.replace("video","audio"));var s=/avc1\.(66|77|100)\.(\d+)/.exec(o);if(s){var l="avc1.",C=s[1],R=Number(s[2]);l=("66"==C?l+"4200":"77"==C?l+"4d00":l+"6400")+(R>>4).toString(16),l+=(15&R).toString(16),o=o.replace(s[0],l)}return o}function Rb(i){this.b=i,this.a=null}function I(i){this.b=i,this.a=null}function Sb(i,a){var o=Tb();this.i=null==i.maxAttempts?o.maxAttempts:i.maxAttempts,this.f=null==i.baseDelay?o.baseDelay:i.baseDelay,this.h=null==i.fuzzFactor?o.fuzzFactor:i.fuzzFactor,this.g=null==i.backoffFactor?o.backoffFactor:i.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==a&&a)&&(this.a=1)}function Ub(i){return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:if(i.a>=i.i){if(!i.c)return s.return(Promise.reject());i.a=1,i.b=i.f}return a=i.a,i.a++,0==a?s.return():(o=i.b*(1+(2*Math.random()-1)*i.h),v(s,new Promise((function(i){new I(i).R(o/1e3)})),2));case 2:i.b*=i.g,w(s)}}))}))}function Tb(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}function J(i,a){this.promise=i,this.me=a,this.a=!1}function Vb(i){return new J(Promise.reject(i),(function(){return Promise.resolve()}))}function Wb(){var i=Promise.reject(new D(2,7,7001));return i.catch((function(){})),new J(i,(function(){return Promise.resolve()}))}function Xb(i){return new J(Promise.resolve(i),(function(){return Promise.resolve()}))}function Yb(i){return new J(i,(function(){return i.catch((function(){}))}))}function Zb(i){return new J(Promise.all(i.map((function(i){return i.promise}))),(function(){return Promise.all(i.map((function(i){return i.abort()})))}))}function K(a,o){for(var s in o=void 0===o?{}:o)this[s]=o[s];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=i.performance&&i.performance.now?i.performance.now():Date.now(),this.type=a,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function ac(){this.a={}}function bc(){this.Sc=new ac,this.gc=this}function cc(i){var a=new Set;return function c(i){switch(typeof i){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return i;default:if(!i||i.buffer&&i.buffer.constructor==ArrayBuffer)return i;if(a.has(i))return null;var o=i.constructor==Array;if(i.constructor!=Object&&!o)return null;a.add(i);var s,l=o?[]:{};for(s in i)l[s]=c(i[s]);return o&&(l.length=i.length),l}}(i)}function ec(i,a){return!("number"!=typeof i||"number"!=typeof a||!isNaN(i)||!isNaN(a))||i===a}function fc(i,a){var o=i.indexOf(a);-1<o&&i.splice(o,1)}function hc(i,a,o){if(o||(o=ec),i.length!=a.length)return!1;a=a.slice();for(var s={},l=(i=t(i)).next();!l.done;s={item:s.item},l=i.next()){if(s.item=l.value,l=a.findIndex(function(i){return function(a){return o(i.item,a)}}(s)),-1==l)return!1;a[l]=a[a.length-1],a.pop()}return 0==a.length}function ic(){this.a=[]}function jc(i,a){i.a.push(a.finally((function(){fc(i.a,a)})))}function L(i){bc.call(this),this.f=!1,this.g=new ic,this.a=new Set,this.b=new Set,this.c=i||null}A("shaka.util.Uint8ArrayUtils.toBase64",Le.Hc),Le.Fa=function(a){a=i.atob(a.replace(/-/g,"+").replace(/_/g,"/"));for(var o=new Uint8Array(a.length),s=0;s<a.length;++s)o[s]=a.charCodeAt(s);return o},A("shaka.util.Uint8ArrayUtils.fromBase64",Le.Fa),Le.Yc=function(a){for(var o=new Uint8Array(a.length/2),s=0;s<a.length;s+=2)o[s/2]=i.parseInt(a.substr(s,2),16);return o},A("shaka.util.Uint8ArrayUtils.fromHex",Le.Yc),Le.Ic=function(i){for(var a="",o=0;o<i.length;++o){var s=i[o].toString(16);1==s.length&&(s="0"+s),a+=s}return a},A("shaka.util.Uint8ArrayUtils.toHex",Le.Ic),Le.Da=function(i,a){if(!i&&!a)return!0;if(!i||!a||i.length!=a.length)return!1;for(var o=0;o<i.length;++o)if(i[o]!=a[o])return!1;return!0},A("shaka.util.Uint8ArrayUtils.equal",Le.Da),Le.concat=function(i){for(var a=[],o=0;o<arguments.length;++o)a[o]=arguments[o];for(var s=o=0;s<a.length;++s)o+=a[s].length;o=new Uint8Array(o);for(var l=s=0;l<a.length;++l)o.set(a[l],s),s+=a[l].length;return o},A("shaka.util.Uint8ArrayUtils.concat",Le.concat),Nb.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},Nb.prototype.i=function(i){this.c=i.captions;var a=new Uint8Array(i.data.byteLength+i.initSegment.byteLength);a.set(i.initSegment,0),a.set(i.data,i.initSegment.byteLength),this.g.push(a)},Nb.prototype.h=function(){var i={data:Le.concat.apply(null,this.g),captions:this.c};this.b.resolve(i),this.f=!1},Rb.prototype.R=function(a){var o=this;this.stop();var s=!0,l=null;return this.a=function(){i.clearTimeout(l),s=!1},l=i.setTimeout((function(){s&&o.b()}),1e3*a),this},Rb.prototype.stop=function(){this.a&&(this.a(),this.a=null)},A("shaka.util.Timer",I),I.prototype.Gc=function(){return this.stop(),this.b(),this},I.prototype.tickNow=I.prototype.Gc,I.prototype.R=function(i){var a=this;return this.stop(),this.a=new Rb((function(){a.b()})).R(i),this},I.prototype.tickAfter=I.prototype.R,I.prototype.Ka=function(i){var a=this;return this.stop(),this.a=new Rb((function(){a.a.R(i),a.b()})).R(i),this},I.prototype.tickEvery=I.prototype.Ka,I.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},I.prototype.stop=I.prototype.stop,A("shaka.util.AbortableOperation",J),J.failed=Vb,J.aborted=Wb,J.completed=Xb,J.notAbortable=Yb,J.prototype.abort=function(){return this.a=!0,this.me()},J.prototype.abort=J.prototype.abort,J.all=Zb,J.prototype.finally=function(i){return this.promise.then((function(){return i(!0)}),(function(){return i(!1)})),this},J.prototype.finally=J.prototype.finally,J.prototype.Y=function(i,a){function d(C){return function(R){if(o.a&&C)s.reject(l);else{var j=C?i:a;j?e=function $b(i,a,o){try{var s=i(a);return s&&s.promise&&s.abort?(o.resolve(s.promise),function(){return s.abort()}):(o.resolve(s),function(){return Promise.resolve(s).then((function(){}),(function(){}))})}catch(i){return o.reject(i),function(){return Promise.resolve()}}}(j,R,s):(C?s.resolve:s.reject)(R)}}}function e(){return s.reject(l),o.abort()}var o=this,s=new E,l=new D(2,7,7001);return this.promise.then(d(!0),d(!1)),new J(s,(function(){return e()}))},J.prototype.chain=J.prototype.Y,A("shaka.util.FakeEvent",K),K.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},K.prototype.stopImmediatePropagation=function(){this.a=!0},K.prototype.stopPropagation=function(){},(s=ac.prototype).push=function(i,a){this.a.hasOwnProperty(i)?this.a[i].push(a):this.a[i]=[a]},s.get=function(i){return(i=this.a[i])?i.slice():null},s.getAll=function(){var i,a=[];for(i in this.a)a.push.apply(a,this.a[i]);return a},s.remove=function(i,a){var o=this.a[i];if(o)for(var s=0;s<o.length;++s)o[s]==a&&(o.splice(s,1),--s)},s.forEach=function(i){for(var a in this.a)i(a,this.a[a])},bc.prototype.addEventListener=function(i,a){this.Sc.push(i,a)},bc.prototype.removeEventListener=function(i,a){this.Sc.remove(i,a)},bc.prototype.dispatchEvent=function(i){for(var a=this.Sc.get(i.type)||[],o=0;o<a.length;++o){i.target=this.gc,i.currentTarget=this.gc;var s=a[o];try{s.handleEvent?s.handleEvent(i):s.call(this,i)}catch(i){G.error("Uncaught exception in event handler",i,i?i.message:null,i?i.stack:null)}if(i.a)break}return i.defaultPrevented},ic.prototype.destroy=function(){var i=[];return this.a.forEach((function(a){a.promise.catch((function(){})),i.push(a.abort())})),this.a=[],Promise.all(i)},bb(L,bc),A("shaka.net.NetworkingEngine",L),L.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},L.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var _e={};function lc(i,a,o){o=o||3;var s=_e[i];(!s||o>=s.priority)&&(_e[i]={priority:o,dg:a})}function mc(i,a){return{uris:i,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:a,licenseRequestType:null,sessionId:null}}function qc(i,a,o,s,l,C,R){var j=new hb(o.uris[l]),U=j.xa,_=!1;U||(ib(j,U=(U=location.protocol).slice(0,-1)),o.uris[l]=j.toString()),U=U.toLowerCase();var O,B=(U=_e[U])?U.dg:null;return B?Yb(Ub(s)).Y((function(){return i.f?Wb():(O=Date.now(),B(o.uris[l],o,a,(function(o,s,l){i.c&&1==a&&(i.c(o,s),_=!0,R.a=l)})))})).Y((function(i){return null==i.timeMs&&(i.timeMs=Date.now()-O),{response:i,Ef:_}}),(function(j){if(j&&7001==j.code)throw j;if(i.f)return Wb();if(j&&1==j.severity)return i.dispatchEvent(new K("retry",{error:j instanceof D?j:null})),l=(l+1)%o.uris.length,qc(i,a,o,s,l,j,R);throw j||C})):Vb(new D(2,1,1e3,j))}function nc(){this.a=0}function oc(i,a,o){J.call(this,i,a),this.b=o}function sc(){}function M(){this.a=new ac}function tc(i,a,o,s){this.target=i,this.type=a,this.listener=o,this.a=function uc(i,a){if(null==a)return!1;if("boolean"==typeof a)return a;var o=new Set(["passive","capture"]);return Object.keys(a).filter((function(i){return!o.has(i)})),function vc(i){var a=Oe;if(null==a){a=!1;try{var o={},s={get:function(){return a=!0,!1}};Object.defineProperty(o,"passive",s),Object.defineProperty(o,"capture",s),s=function(){},i.addEventListener("test",s,o),i.removeEventListener("test",s,o)}catch(i){a=!1}Oe=a}return a||!1}(i)?a:a.capture||!1}(i,s),this.target.addEventListener(a,o,this.a)}L.registerScheme=lc,L.unregisterScheme=function(i){delete _e[i]},L.prototype.fg=function(i){this.a.add(i)},L.prototype.registerRequestFilter=L.prototype.fg,L.prototype.Fg=function(i){this.a.delete(i)},L.prototype.unregisterRequestFilter=L.prototype.Fg,L.prototype.We=function(){this.a.clear()},L.prototype.clearAllRequestFilters=L.prototype.We,L.prototype.gg=function(i){this.b.add(i)},L.prototype.registerResponseFilter=L.prototype.gg,L.prototype.Gg=function(i){this.b.delete(i)},L.prototype.unregisterResponseFilter=L.prototype.Gg,L.prototype.Xe=function(){this.b.clear()},L.prototype.clearAllResponseFilters=L.prototype.Xe,L.defaultRetryParameters=function(){return Tb()},L.makeRequest=mc,L.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},L.prototype.destroy=L.prototype.destroy,L.prototype.request=function(i,a){var o=this,s=new nc;if(this.f){var l=Promise.reject(new D(2,7,7001));return l.catch((function(){})),new oc(l,(function(){return Promise.resolve()}),s)}a.method=a.method||"GET",a.headers=a.headers||{},a.retryParameters=a.retryParameters?cc(a.retryParameters):Tb(),a.uris=cc(a.uris),l=function pc(i,a,o){for(var s=Xb(void 0),l={},C=(i=t(i.a)).next();!C.done;l={Ad:l.Ad},C=i.next())l.Ad=C.value,s=s.Y(function(i){return function(){return i.Ad(a,o)}}(l));return s.Y(void 0,(function(i){if(i&&7001==i.code)throw i;throw new D(2,1,1006,i)}))}(this,i,a);var C=l.Y((function(){return qc(o,i,a,new Sb(a.retryParameters,!1),0,null,s)})),R=C.Y((function(a){return function rc(i,a,o){for(var s=Xb(void 0),l=(i=t(i.b)).next();!l.done;l=i.next())s=s.Y(l.value.bind(null,a,o.response));return s.Y((function(){return o}),(function(i){if(i&&7001==i.code)throw i;var a=2;throw i instanceof D&&(a=i.severity),new D(a,1,1007,i)}))}(o,i,a)})),j=Date.now(),U=0;l.promise.then((function(){U=Date.now()-j}),(function(){}));var _=0;return C.promise.then((function(){_=Date.now()}),(function(){})),l=R.Y((function(a){var s=Date.now()-_,l=a.response;return l.timeMs+=U,l.timeMs+=s,a.Ef||!o.c||l.fromCache||1!=i||o.c(l.timeMs,l.data.byteLength),l}),(function(i){throw i&&(i.severity=2),i})),l=new oc(l.promise,l.me,s),jc(this.g,l),l},L.prototype.request=L.prototype.request,L.NumBytesRemainingClass=nc,xa(oc,J),L.PendingRequest=oc,oc.all=Zb,oc.notAbortable=Yb,oc.completed=Xb,oc.aborted=Wb,oc.failed=Vb,A("shaka.util.IReleasable",sc),sc.prototype.release=function(){},A("shaka.util.EventManager",M),M.prototype.release=function(){this.hb(),this.a=null},M.prototype.release=M.prototype.release,M.prototype.B=function(i,a,o,s){this.a&&(i=new tc(i,a,o,s),this.a.push(a,i))},M.prototype.listen=M.prototype.B,M.prototype.ua=function(i,a,o,s){var l=this;this.B(i,a,(function f(s){l.pa(i,a,f),o(s)}),s)},M.prototype.listenOnce=M.prototype.ua,M.prototype.pa=function(i,a,o){if(this.a)for(var s=this.a.get(a)||[],l=(s=t(s)).next();!l.done;l=s.next())(l=l.value).target!=i||o!=l.listener&&o||(l.pa(),this.a.remove(a,l))},M.prototype.unlisten=M.prototype.pa,M.prototype.hb=function(){if(this.a){for(var i=this.a.getAll(),a=(i=t(i)).next();!a.done;a=i.next())a.value.pa();this.a.a={}}},M.prototype.removeAll=M.prototype.hb,tc.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},tc.prototype.unlisten=tc.prototype.pa;var Oe=void 0;function xc(i){return new hb(i=Jb(i)).wa}function yc(i,a,o){function e(i){new DataView(s.buffer).setUint32(l,i.byteLength,!0),l+=4,s.set(i,l),l+=i.byteLength}if(!o||!o.byteLength)throw new D(2,6,6015);a="string"==typeof a?new Uint8Array(Lb(a,!0)):new Uint8Array(a),i=Lb(i=Jb(i),!0);var s=new Uint8Array(12+i.byteLength+a.byteLength+o.byteLength),l=0;return e(new Uint8Array(i)),e(a),e(new Uint8Array(o)),s}function zc(i,a){for(var o=[],s=t(i),l=s.next();!l.done;l=s.next())o.push(a(l.value));return o}function Ac(i,a){for(var o=t(i),s=o.next();!s.done;s=o.next())if(!a(s.value))return!1;return!0}function Bc(i){var a=new Map;return Object.keys(i).forEach((function(o){a.set(o,i[o])})),a}function Cc(i){var a={};return i.forEach((function(i,o){a[o]=i})),a}function Dc(i,a){var o=i;return a&&(o+='; codecs="'+a+'"'),o}function Gc(i){var a=(i=i.split("."))[0];return i.pop(),[a,i.join(".")]}A("shaka.util.FairPlayUtils.defaultGetContentId",xc),A("shaka.util.FairPlayUtils.initDataTransform",yc);var Ke=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Hc(){return!(!i.MediaSource||!MediaSource.isTypeSupported)}function Ic(i){return""!=Jc().canPlayType(i)}function Kc(){return Lc("Tizen")}function Mc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Kc()}function Nc(){if(!Mc())return null;var i=navigator.userAgent.match(/Version\/(\d+)/);return i||(i=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(i[1],10):null}function Lc(i){return(navigator.userAgent||"").includes(i)}function Jc(){return He||(Ye||(Ye=new I((function(){He=null}))),(He=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(He=document.createElement("video")),Ye.R(1),He)}var Ye=null,He=null;function Qc(i,a){var o=this;a=void 0===a?1:a,this.D=i,this.u=new Set,this.h=this.l=null,this.V=!1,this.K=0,this.a=null,this.i=new M,this.b=new Map,this.w=[],this.o=new E,this.f=null,this.g=function(a){o.o.reject(a),i.onError(a)},this.sa=new Map,this.$=new Map,this.T=new I((function(){return function Rc(i){var a=i.sa,o=i.$;o.clear(),a.forEach((function(i,a){return o.set(a,i)})),(a=Array.from(o.values())).length&&a.every((function(i){return"expired"==i}))&&i.g(new D(2,6,6014)),i.D.yc(Cc(o))}(o)})),this.c=!1,this.qa=new E,this.G=!1,this.H=[],this.ra=!1,this.ea=new I((function(){!function Sc(i){i.b.forEach((function(a,o){var s=a.rd,l=o.expiration;isNaN(l)&&(l=1/0),l!=s&&(i.D.onExpirationUpdated(o.sessionId,l),a.rd=l)}))}(o)})).Ka(a),this.o.catch((function(){}))}function Xc(i,a,o){return i.w=o,i.G=0<o.length,Wc(i,a)}function Wc(a,o){var s=function $c(a){if(0==(a=Bc(a.f.clearKeys)).size)return null;var o=[],s=[];a.forEach((function(i,a){var l=Le.Yc(a),C=Le.Yc(i);l={kty:"oct",kid:Le.Hc(l,!1),k:Le.Hc(C,!1)},o.push(l),s.push(l.kid)})),a=JSON.stringify({keys:o});var l=JSON.stringify({kids:s});return l=[{initData:new Uint8Array(Kb(l)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+i.btoa(a),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:l,keyIds:[]}}(a);if(s)for(var l=t(o),C=l.next();!C.done;C=l.next())C.value.drmInfos=[s];for(s=o.some((function(i){return 0<i.drmInfos.length})),s||function ad(i,a){var o=[];a.forEach((function(i,a){o.push({keySystem:a,licenseServerUri:i,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})}));for(var s=t(i),l=s.next();!l.done;l=s.next())l.value.drmInfos=o}(o,C=Bc(a.f.servers)),C=(l=t(o)).next();!C.done;C=l.next())for(var R=(C=t(C.value.drmInfos)).next();!R.done;R=C.next())bd(R.value,Bc(a.f.servers),Bc(a.f.advanced||{}));return C=function cd(i,a){for(var o=new Set,s=t(a),l=s.next();!l.done;l=s.next()){var C=t(l.value.drmInfos);for(l=C.next();!l.done;l=C.next())o.add(l.value)}for(s=t(o),l=s.next();!l.done;l=s.next())bd(l.value,Bc(i.f.servers),Bc(i.f.advanced||{}));C=i.G?"required":"optional";var R=i.G?["persistent-license"]:["temporary"];for(s=new Map,o=t(o),l=o.next();!l.done;l=o.next())l=l.value,s.set(l.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:C,sessionTypes:R,label:l.keySystem,drmInfos:[]});for(o=t(a),l=o.next();!l.done;l=o.next()){C=(l=l.value).audio,R=l.video;var j=C?nd(C):"",U=R?nd(R):"",_=t(l.drmInfos);for(l=_.next();!l.done;l=_.next()){l=l.value;var O=s.get(l.keySystem);O.drmInfos.push(l),l.distinctiveIdentifierRequired&&(O.distinctiveIdentifier="required"),l.persistentStateRequired&&(O.persistentState="required"),C&&(O.audioCapabilities.push({robustness:l.audioRobustness||"",contentType:j}),"ac-3"==C.codecs.toLowerCase()&&Kc()&&O.audioCapabilities.push({robustness:l.audioRobustness||"",contentType:Dc(C.mimeType,"ec-3")})),R&&O.videoCapabilities.push({robustness:l.videoRobustness||"",contentType:U})}}return s}(a,o),C.size?(C=Zc(a,C),s?C:C.catch((function(){}))):(a.V=!0,Promise.resolve())}function ed(i){return u((function d(){var a;return x(d,(function(o){switch(o.j){case 1:if(!(i.l&&i.a&&i.a.serverCertificate&&i.a.serverCertificate.length)){o.C(0);break}return Ba(o,3),v(o,i.l.setServerCertificate(i.a.serverCertificate),5);case 5:o.s||G.m("Server certificates are not supported by the key system.  The server certificate has been ignored."),Fa(o,0);break;case 3:return a=Ga(o),o.return(Promise.reject(new D(2,6,6004,a.message)))}}))}))}function fd(i){var a=i.a?i.a.initData:[];return a.forEach((function(a){return gd(i,a.initDataType,a.initData)})),i.w.forEach((function(a){return id(i,a)})),a.length||i.w.length||i.o.resolve(),i.o}function gd(i,a,o){for(var s=i.b.values(),l=(s=t(s)).next();!l.done;l=s.next())if(Le.Da(o,l.value.initData)&&!Lc("Tizen 2"))return void G.debug("Ignoring duplicate init data.");!function jd(i,a,o){try{if(i.G){G.F("Creating new persistent session");var s=i.l.createSession("persistent-license")}else G.F("Creating new temporary session"),s=i.l.createSession()}catch(a){return void i.g(new D(2,6,6005,a.message))}i.i.B(s,"message",i.se.bind(i)),i.i.B(s,"keystatuseschange",i.qe.bind(i)),i.b.set(s,{initData:o,loaded:!1,rd:1/0,Ca:null});try{o=i.f.initDataTransform(o,i.a)}catch(o){return a=o,o instanceof D||(a=new D(2,6,6016,o)),void i.g(a)}s.generateRequest(a,o).catch((function(a){if(!i.c){if(i.b.delete(s),a.errorCode&&a.errorCode.systemCode){var o=a.errorCode.systemCode;0>o&&(o+=Math.pow(2,32)),o="0x"+o.toString(16)}i.g(new D(2,6,6006,a.message,a,o))}}))}(i,a,o)}function kd(i){return i?i.keySystem:""}function ld(i,a){if(navigator.userAgent.match(/Edge\//))return!0;if(a=a.toLowerCase(),Kc()&&a.includes('codecs="ac-3"')){var o=a.replace("ac-3","ec-3");return i.u.has(a)||i.u.has(o)}return i.u.has(a)}function md(i){return i=zc(i=i.b.keys(),(function(i){return i.sessionId})),Array.from(i)}function nd(i){var a=Dc(i.mimeType,i.codecs);return Ob(a)?Pb(i.type,a):a}function Zc(i,a){if(1==a.size&&a.has(""))return Promise.reject(new D(2,6,6e3));for(var o=t(a.values()),s=o.next();!s.done;s=o.next())0==(s=s.value).audioCapabilities.length&&delete s.audioCapabilities,0==s.videoCapabilities.length&&delete s.videoCapabilities;var l=o=new E;return[!0,!1].forEach(function(i){var o=this;a.forEach((function(a,s){a.drmInfos.some((function(i){return!!i.licenseServerUri}))==i&&(l=l.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(s,[a])}.bind(o)))}))}.bind(i)),l=(l=l.catch((function(){return Promise.reject(new D(2,6,6001))}))).then(function(i){if(this.c)return Promise.reject();this.u.clear();var o=i.getConfiguration(),s=o.videoCapabilities||[],l=t(o.audioCapabilities||[]);for(o=l.next();!o.done;o=l.next())this.u.add(o.value.contentType.toLowerCase());for(o=(s=t(s)).next();!o.done;o=s.next())this.u.add(o.value.contentType.toLowerCase());s=i.keySystem,l=[];var C=[],R=[],j=[];return function od(i,a,o,s,l){i.forEach((function(i){if(a.includes(i.licenseServerUri)||a.push(i.licenseServerUri),i.serverCertificate&&(o.some((function(a){return Le.Da(a,i.serverCertificate)}))||o.push(i.serverCertificate)),i.initData&&i.initData.forEach((function(i){s.some((function(a){return!(!a.keyId||a.keyId!=i.keyId)||a.initDataType==i.initDataType&&Le.Da(a.initData,i.initData)}))||s.push(i)})),i.keyIds)for(var C=0;C<i.keyIds.length;++C)l.includes(i.keyIds[C])||l.push(i.keyIds[C])}))}((o=a.get(i.keySystem)).drmInfos,l,C,R,j),1<C.length&&G.m("Multiple unique server certificates found! Only the first will be used."),1<l.length&&G.m("Multiple unique license server URIs found! Only the first will be used."),this.a={keySystem:s,licenseServerUri:l[0],distinctiveIdentifierRequired:"required"==o.distinctiveIdentifier,persistentStateRequired:"required"==o.persistentState,audioRobustness:(o.audioCapabilities?o.audioCapabilities[0].robustness:"")||"",videoRobustness:(o.videoCapabilities?o.videoCapabilities[0].robustness:"")||"",serverCertificate:C[0],initData:R,keyIds:j},this.a.licenseServerUri?i.createMediaKeys():Promise.reject(new D(2,6,6012,this.a.keySystem))}.bind(i)).then(function(i){if(this.c)return Promise.reject();G.info("Created MediaKeys object for key system",this.a.keySystem),this.l=i,this.V=!0}.bind(i)).catch(function(i){if(!this.c)return this.a=null,this.u.clear(),i instanceof D?Promise.reject(i):Promise.reject(new D(2,6,6002,i.message))}.bind(i)),o.reject(),l}function id(i,a){try{G.F("Attempting to load an offline session",a);var o=i.l.createSession("persistent-license")}catch(a){var s=new D(2,6,6005,a.message);return i.g(s),Promise.reject(s)}i.i.B(o,"message",i.se.bind(i)),i.i.B(o,"keystatuseschange",i.qe.bind(i));var l={initData:null,loaded:!1,rd:1/0,Ca:null};return i.b.set(o,l),o.load(a).then(function(i){return this.c?Promise.reject():(G.J("Loaded offline session",a,i),i?(l.loaded=!0,pd(this)&&this.o.resolve(),o):(this.b.delete(o),void this.g(new D(2,6,6013))))}.bind(i),function(i){this.c||(this.b.delete(o),this.g(new D(2,6,6005,i.message)))}.bind(i))}function qd(i,a){if(kd(a).startsWith("com.apple.fps")){var o=a.serverCertificate;i=yc(i,xc(i),o)}return i}function dd(i,a){var o=a.target;G.F("Sending license request for session",o.sessionId,"of type",a.messageType);var s=i.b.get(o),l=i.a.licenseServerUri,C=i.f.advanced[i.a.keySystem];"individualization-request"==a.messageType&&C&&C.individualizationServer&&(l=C.individualizationServer),(l=mc([l],i.f.retryParameters)).body=a.message,l.method="POST",l.licenseRequestType=a.messageType,l.sessionId=o.sessionId,"com.microsoft.playready"!=i.a.keySystem&&"com.chromecast.playready"!=i.a.keySystem||function rd(i){var a=Ib(i.body,!0,!0);if(a.includes("PlayReadyKeyMessage")){G.debug("Unwrapping PlayReady request.");for(var o=(a=(new DOMParser).parseFromString(a,"application/xml")).getElementsByTagName("HttpHeader"),s=0;s<o.length;++s)i.headers[o[s].getElementsByTagName("name")[0].textContent]=o[s].getElementsByTagName("value")[0].textContent;i.body=Le.Fa(a.getElementsByTagName("Challenge")[0].textContent).buffer}else G.debug("PlayReady request is already unwrapped."),i.headers["Content-Type"]="text/xml; charset=utf-8"}(l),i.a.keySystem.startsWith("com.apple.fps")&&i.f.fairPlayTransform&&function sd(i){var a=new Uint8Array(i.body);a="spc="+Le.Hc(a),i.headers["Content-Type"]="application/x-www-form-urlencoded",i.body=Kb(a)}(l);var R=Date.now();i.D.Db.request(2,l).promise.then(function(i){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function td(i){try{var a=Gb(i.data)}catch(i){return}"<ckc>"===(a=a.trim()).substr(0,5)&&"</ckc>"===a.substr(-6)&&(a=a.slice(5,-6));try{a=JSON.parse(a).ckc}catch(i){}i.data=Le.Fa(a).buffer}(i),this.K+=(Date.now()-R)/1e3,G.F("Updating session",o.sessionId),o.update(i.data).then(function(){var i=this;this.D.onEvent(new K("drmsessionupdate")),s&&(s.Ca&&s.Ca.resolve(),new I((function(){s.loaded=!0,pd(i)&&i.o.resolve()})).R(We))}.bind(this)))}.bind(i),function(i){this.c||(i=new D(2,6,6007,i),this.g(i),s&&s.Ca&&s.Ca.reject(i))}.bind(i)).catch(function(i){this.c||(i=new D(2,6,6008,i.message),this.g(i),s&&s.Ca&&s.Ca.reject(i))}.bind(i))}function wd(){var i=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],a=[{videoCapabilities:i,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:i}],o=new Map;return i="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map((function(i){return function b(i){return u((function h(){var s,l,C;return x(h,(function(R){switch(R.j){case 1:return Ba(R,2),v(R,navigator.requestMediaKeySystemAccess(i,a),4);case 4:return s=R.s,C=!!(l=s.getConfiguration().sessionTypes)&&l.includes("persistent-license"),Lc("Tizen 3")&&(C=!1),o.set(i,{persistentState:C}),v(R,s.createMediaKeys(),5);case 5:Fa(R,0);break;case 2:Ga(R),o.set(i,null),w(R)}}))}))}(i)})),Promise.all(i).then((function(){return Cc(o)}))}function xd(i,a){var o=a.audio,s=a.video;if(o&&o.encrypted&&!ld(i,o=nd(o))||s&&s.encrypted&&!ld(i,s=nd(s)))return!1;var l=kd(i.a);return 0==a.drmInfos.length||a.drmInfos.some((function(i){return i.keySystem==l}))}function yd(i,a){if(!i.length)return a;if(!a.length)return i;for(var o=[],s=0;s<i.length;s++)for(var l=0;l<a.length;l++)if(i[s].keySystem==a[l].keySystem){var C=i[s];l=a[l];var R=[];R=(R=R.concat(C.initData||[])).concat(l.initData||[]);var j=[];j=(j=j.concat(C.keyIds)).concat(l.keyIds),o.push({keySystem:C.keySystem,licenseServerUri:C.licenseServerUri||l.licenseServerUri,distinctiveIdentifierRequired:C.distinctiveIdentifierRequired||l.distinctiveIdentifierRequired,persistentStateRequired:C.persistentStateRequired||l.persistentStateRequired,videoRobustness:C.videoRobustness||l.videoRobustness,audioRobustness:C.audioRobustness||l.audioRobustness,serverCertificate:C.serverCertificate||l.serverCertificate,initData:R,keyIds:j});break}return o}function Uc(i){return u((function d(){var a;return x(d,(function(o){if(1===o.j)return a=Array.from(i.b.keys()),i.b.clear(),v(o,Promise.all(a.map((function(i){return u((function k(){return x(k,(function(a){switch(a.j){case 1:return G.F("Closing session",i.sessionId),Ba(a,2),v(a,function zd(i){return u((function d(){var a;return x(d,(function(o){switch(o.j){case 1:return a=new Promise((function(i,a){new I(a).R(Xe)})),Ba(o,2),v(o,Promise.race([Promise.all([i.close(),i.closed]),a]),4);case 4:Fa(o,0);break;case 2:Ga(o),G.m("Timeout waiting for session close"),w(o)}}))}))}(i),4);case 4:Fa(a,0);break;case 2:Ga(a),w(a)}}))}))}))),0)}))}))}function pd(i){return Ac(i=i.b.values(),(function(i){return i.loaded}))}function bd(a,o,s){!a.keySystem||"org.w3.clearkey"==a.keySystem&&a.licenseServerUri||(o.size&&(o=o.get(a.keySystem)||"",a.licenseServerUri=o),a.keyIds||(a.keyIds=[]),(s=s.get(a.keySystem))&&(a.distinctiveIdentifierRequired||(a.distinctiveIdentifierRequired=s.distinctiveIdentifierRequired),a.persistentStateRequired||(a.persistentStateRequired=s.persistentStateRequired),a.videoRobustness||(a.videoRobustness=s.videoRobustness),a.audioRobustness||(a.audioRobustness=s.audioRobustness),a.serverCertificate||(a.serverCertificate=s.serverCertificate)),i.cast&&i.cast.__platform__&&"com.microsoft.playready"==a.keySystem&&(a.keySystem="com.chromecast.playready"))}(s=Qc.prototype).destroy=function(){var i=this;return u((function d(){return x(d,(function(a){switch(a.j){case 1:return i.c?v(a,i.qa,0):(i.c=!0,v(a,function Tc(i){return u((function d(){return x(d,(function(a){switch(a.j){case 1:return i.i.release(),i.i=null,i.o.reject(),i.ea.stop(),i.ea=null,i.T.stop(),i.T=null,v(a,Uc(i),2);case 2:if(!i.h){a.C(3);break}return Ba(a,4),v(a,i.h.setMediaKeys(null),6);case 6:Fa(a,5);break;case 4:Ga(a);case 5:i.h=null;case 3:i.a=null,i.u.clear(),i.l=null,i.w=[],i.f=null,i.g=null,i.D=null,w(a)}}))}))}(i),4));case 4:i.qa.resolve(),a.C(0)}}))}))},s.configure=function(i){this.f=i},s.Qb=function(i){var a=this;if(!this.l)return this.i.ua(i,"encrypted",(function(){a.g(new D(2,6,6010))})),Promise.resolve();this.h=i,this.i.ua(this.h,"play",(function(){for(var i=0;i<a.H.length;i++)dd(a,a.H[i]);a.ra=!0,a.H=[]})),"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Uc(a)})),i=(i=this.h.setMediaKeys(this.l)).catch((function(i){return Promise.reject(new D(2,6,6003,i.message))}));var o=ed(this);return Promise.all([i,o]).then((function(){if(a.c)return Promise.reject();fd(a),a.a.initData.length||a.w.length||a.i.B(a.h,"encrypted",(function(i){return gd(a,i.initDataType,new Uint8Array(i.initData))}))})).catch((function(i){if(!a.c)return Promise.reject(i)}))},s.Tb=function(){for(var i=1/0,a=this.b.keys(),o=(a=t(a)).next();!o.done;o=a.next())o=o.value,isNaN(o.expiration)||(i=Math.min(i,o.expiration));return i},s.se=function(i){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(i):dd(this,i)},s.qe=function(i){i=i.target,G.J("Key status changed for session",i.sessionId);var a=this.b.get(i),o=!1;i.keyStatuses.forEach(function(i,s){if("string"==typeof s){var l=s;s=i,i=l}if("com.microsoft.playready"==this.a.keySystem&&16==s.byteLength&&(Lc("Trident/")||navigator.userAgent.match(/Edge?\//))){var C=(l=new DataView(s)).getUint32(0,!0),R=l.getUint16(4,!0),j=l.getUint16(6,!0);l.setUint32(0,C,!1),l.setUint16(4,R,!1),l.setUint16(6,j,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==i&&(i="usable"),"status-pending"!=i&&(a.loaded=!0),"expired"==i&&(o=!0),l=Le.Ic(new Uint8Array(s)),this.sa.set(l,i)}.bind(this));var s=i.expiration-Date.now();(0>s||o&&1e3>s)&&a&&!a.Ca&&(G.debug("Session has expired",i.sessionId),this.b.delete(i),i.close().catch((function(){}))),pd(this)&&(this.o.resolve(),this.T.R(Qe))};var Xe=1,We=5,Qe=.5;function Bd(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function Cd(){}function Dd(i){return!i||1==i.length&&1e-6>i.end(0)-i.start(0)?null:i.length?i.end(i.length-1):null}function Ed(i,a,o){return o=void 0===o?0:o,!(!i||!i.length||1==i.length&&1e-6>i.end(0)-i.start(0)||a>i.end(i.length-1))&&a+o>=i.start(0)}function Fd(i,a){if(!i||!i.length||1==i.length&&1e-6>i.end(0)-i.start(0))return 0;for(var o=0,s=i.length-1;0<=s&&i.end(s)>a;--s)o+=i.end(s)-Math.max(i.start(s),a);return o}function Gd(i){if(!i)return[];for(var a=[],o=0;o<i.length;o++)a.push({start:i.start(o),end:i.end(o)});return a}function Hd(i,a,o){this.startTime=i,this.direction=rt,this.endTime=a,this.payload=o,this.region=new Jd,this.position=null,this.positionAlign=Je,this.size=0,this.textAlign=et,this.writingMode=at,this.lineInterpretation=ot,this.line=null,this.lineHeight="",this.lineAlign=st,this.displayAlign=nt,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=ct,this.fontStyle=lt,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}Bd.prototype.init=function(i){var a=muxjs.mp4.probe;i=new Uint8Array(i),this.g=a.videoTrackIds(i),this.f=a.timescale(i),this.a.init()},Bd.prototype.b=function(i,a){var o=new Uint8Array(i);(o=this.a.parse(o,this.g,this.f))&&o.captions&&a(o.captions),this.a.clearParsedCaptions()},Bd.prototype.c=function(){this.a.resetCaptionStream()},Cd.prototype.init=function(){},Cd.prototype.b=function(){},Cd.prototype.c=function(){},A("shaka.text.Cue",Hd),Hd.prototype.clone=function(){var i,a=new Hd(0,0,"");for(i in this)a[i]=this[i],a[i]&&a[i].constructor==Array&&(a[i]=a[i].slice());return a};var Je="auto";Hd.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Je};var et="center",tt={LEFT:"left",RIGHT:"right",CENTER:et,START:"start",END:"end"};Hd.textAlign=tt;var nt="after",it={BEFORE:"before",CENTER:"center",AFTER:nt};Hd.displayAlign=it;var rt="ltr";Hd.direction={HORIZONTAL_LEFT_TO_RIGHT:rt,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var at="horizontal-tb";Hd.writingMode={HORIZONTAL_TOP_TO_BOTTOM:at,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var ot=0;Hd.lineInterpretation={LINE_NUMBER:ot,PERCENTAGE:1};var st="start",ut={CENTER:"center",START:st,END:"end"};Hd.lineAlign=ut;var ct=400;Hd.fontWeight={NORMAL:ct,BOLD:700};var lt="normal",ft={NORMAL:lt,ITALIC:"italic",OBLIQUE:"oblique"};function Jd(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=dt,this.scroll=ht}Hd.fontStyle=ft,Hd.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},A("shaka.text.CueRegion",Jd);var dt=1;Jd.units={PX:0,PERCENTAGE:dt,LINES:2};var ht="";function Zd(i){this.g=null,this.c=i,this.f=this.o=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}Jd.scrollMode={NONE:ht,UP:"up"};var pt={};function ae(a){return!!(pt[a]||i.muxjs&&"application/cea-608"==a)}function be(i,a){"application/cea-608"!=a&&(i.g=new pt[a])}function ee(i,a,o,s,l){for(var C=o+" "+s,R=new Map,j=(a=t(a)).next();!j.done;j=a.next()){var U=j.value;j=U.stream,R.has(j)||R.set(j,new Map),R.get(j).has(C)||R.get(j).set(C,[]),U.startTime+=l,U.endTime+=l,U.startTime>=i.f&&U.startTime<i.h&&(U=new Hd(U.startTime,U.endTime,U.text),R.get(j).get(C).push(U),j==i.l&&i.c.append([U]))}for(C=(l=t(R.keys())).next();!C.done;C=l.next())for(C=C.value,i.i.has(C)||i.i.set(C,new Map),j=(a=t(R.get(C).keys())).next();!j.done;j=a.next())j=j.value,U=R.get(C).get(j),i.i.get(C).set(j,U);i.a=null==i.a?Math.max(o,i.f):Math.min(i.a,Math.max(o,i.f)),i.b=Math.max(i.b,Math.min(s,i.h))}function fe(i,a,o){this.f=i,this.g=o,this.b={},this.a=null,this.c={},this.i=new M,this.w=!1,this.l={},this.o=a,this.u=new E,this.h=function ge(i,a){var o=new MediaSource;return i.i.ua(o,"sourceopen",(function(){URL.revokeObjectURL(i.D),a.resolve()})),i.D=mt(o),i.f.src=i.D,o}(this,this.u),this.D=""}A("shaka.text.TextEngine.registerParser",(function(i,a){pt[i]=a})),A("shaka.text.TextEngine.unregisterParser",(function(i){delete pt[i]})),Zd.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},Zd.prototype.sc=function(i){try{return this.g.parseMedia(new Uint8Array(i),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(i){throw new D(2,2,2009,i)}},Zd.prototype.remove=function(i,a){return Promise.resolve().then(function(){!this.c||!this.c.remove(i,a)||null==this.a||a<=this.a||i>=this.b||(i<=this.a&&a>=this.b?this.a=this.b=null:i<=this.a&&a<this.b?this.a=a:i>this.a&&a>=this.b&&(this.b=i))}.bind(this))};var mt=i.URL.createObjectURL;function ie(i){var a=Dc(i.mimeType,i.codecs),o=function Ec(i){var a=[i.mimeType];return Ke.forEach((function(o,s){var l=i[s];l&&a.push(o+'="'+l+'"')})),a.join(";")}(i);return ae(a)||MediaSource.isTypeSupported(o)||Ob(a,i.type)}function je(i,a){i.a||(i.a=new Zd(i.g)),be(i.a,a)}function ke(i){return!i.h||"ended"==i.h.readyState}function le(i,a){if("text"==a)var o=i.a.a;else o=!(o=me(i,a))||1==o.length&&1e-6>o.end(0)-o.start(0)?null:1==o.length&&0>o.start(0)?0:o.length?o.start(0):null;return o}function ne(i,a){return"text"==a?i.a.b:Dd(me(i,a))}function me(i,a){try{return i.b[a].buffered}catch(o){return a in i.b&&G.error("failed to get buffered range for "+a,o),null}}function pe(a,o,s,l,C,R){return"text"==o?function ce(i,a,o,s){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==o||null==s)this.g.parseInit(new Uint8Array(a));else{var i={periodStart:this.o,segmentStart:o,segmentEnd:s};i=this.g.parseMedia(new Uint8Array(a),i).filter(function(i){return i.startTime>=this.f&&i.startTime<this.h}.bind(this)),this.c.append(i),null==this.a&&(this.a=Math.max(o,this.f)),this.b=Math.min(s,this.h)}}.bind(i))}(a.a,s,l,C):a.l[o]?function Qb(i,a){i.f=!0,i.b=new E,i.g=[],i.c=[];var o=new Uint8Array(a);return i.a.push(o),i.a.flush(),i.f&&i.b.reject(new D(2,3,3018)),i.b}(a.l[o],s).then(function(i){return this.a||je(this,"text/vtt"),i.captions&&i.captions.length&&ee(this.a,i.captions,l,C,this.b.video.timestampOffset),qe(this,o,this.Fe.bind(this,o,i.data.buffer))}.bind(a)):(R&&i.muxjs&&(a.a||je(a,"text/vtt"),null==l&&null==C?a.o.init(s):a.o.b(s,(function(i){i.length&&ee(a.a,i,l,C,a.b.video.timestampOffset)}))),qe(a,o,a.Fe.bind(a,o,s)))}function re(i,a){var o=ne(i,"video")||0;!function de(i,a,o){if(i.l=a,a=i.i.get(a))for(var s=t(a.keys()),l=s.next();!l.done;l=s.next())(l=a.get(l.value).filter((function(i){return i.endTime<=o})))&&i.c.append(l)}(i.a,a,o)}function se(i,a){return"text"==a?i.a?(i.o.c(),i.a.remove(0,1/0)):Promise.resolve():qe(i,a,i.Ge.bind(i,a,0,i.h.duration))}function qe(i,a,o){if(i.w)return Promise.reject();if(o={start:o,p:new E},i.c[a].push(o),1==i.c[a].length)try{o.start()}catch(s){"QuotaExceededError"==s.name?o.p.reject(new D(2,3,3017,a)):o.p.reject(new D(2,3,3015,s)),ve(i,a)}return o.p}function ue(i,a){if(i.w)return Promise.reject();var o,s=[];for(o in i.b){var l=new E,C={start:function(i){i.resolve()}.bind(null,l),p:l};i.c[o].push(C),s.push(l),1==i.c[o].length&&C.start()}return Promise.all(s).then(function(){try{a()}catch(a){var i=Promise.reject(new D(2,3,3015,a))}for(var o in this.b)ve(this,o);return i}.bind(i),function(i){throw i}.bind(i))}function ve(i,a){i.c[a].shift();var o=i.c[a][0];if(o)try{o.start()}catch(s){o.p.reject(new D(2,3,3015,s)),ve(i,a)}}function we(i,a){return i=N(i),a=N(a),i.split("-")[0]==a.split("-")[0]}function xe(i,a){i=N(i),a=N(a);var o=i.split("-"),s=a.split("-");return o[0]==s[0]&&1==o.length&&2==s.length}function N(i){var a=i.split("-");return i=a[0]||"",a=a[1]||"",i=i.toLowerCase(),i=gt.get(i)||i,(a=a.toUpperCase())?i+"-"+a:i}function ze(i){return i.language?N(i.language):i.audio&&i.audio.language?N(i.audio.language):i.video&&i.video.language?N(i.video.language):"und"}function Ae(i,a){for(var o=N(i),s=new Set,l=t(a),C=l.next();!C.done;C=l.next())s.add(N(C.value));for(C=(l=t(s)).next();!C.done;C=l.next())if((C=C.value)==o)return C;for(C=(l=t(s)).next();!C.done;C=l.next())if(xe(C=C.value,o))return C;for(C=(l=t(s)).next();!C.done;C=l.next()){var R=C=C.value,j=o;if(R=N(R),j=N(j),R=R.split("-"),j=j.split("-"),2==R.length&&2==j.length&&R[0]==j[0])return C}for(C=(s=t(s)).next();!C.done;C=s.next())if(xe(o,l=C.value))return l;return null}(s=fe.prototype).destroy=function(){var i=this;this.w=!0;var a,o=[];for(a in this.c){var s=this.c[a],l=s[0];for(this.c[a]=s.slice(0,1),l&&o.push(l.p.catch(Ie.wc)),l=1;l<s.length;++l)s[l].p.reject()}for(var C in this.a&&o.push(this.a.destroy()),this.g&&o.push(this.g.destroy()),this.l)o.push(this.l[C].destroy());return Promise.all(o).then((function(){i.i&&(i.i.release(),i.i=null),i.f&&(i.f.removeAttribute("src"),i.f.load(),i.f=null),i.h=null,i.a=null,i.g=null,i.b={},i.l={},i.o=null,i.c={}}))},s.init=function(i,a){var o=this;return u((function f(){var s;return x(f,(function(l){switch(l.j){case 1:return s=Pe,v(l,o.u,2);case 2:i.forEach((function(i,l){var C=Dc(i.mimeType,i.codecs);l==s.va?je(o,C):(!a&&MediaSource.isTypeSupported(C)||!Ob(C,l)||(o.l[l]=new Nb,C=Pb(l,C)),C=o.h.addSourceBuffer(C),o.i.B(C,"error",o.vg.bind(o,l)),o.i.B(C,"updateend",o.Gb.bind(o,l)),o.b[l]=C,o.c[l]=[])})),w(l)}}))}))},s.$c=function(i){if(i.total=Gd(this.f.buffered),i.audio=Gd(me(this,"audio")),i.video=Gd(me(this,"video")),i.text=[],this.a){var a=this.a.a,o=this.a.b;null!=a&&null!=o&&i.text.push({start:a,end:o})}},s.remove=function(i,a,o){return"text"==i?this.a.remove(a,o):qe(this,i,this.Ge.bind(this,i,a,o))},s.flush=function(i){return"text"==i?Promise.resolve():qe(this,i,this.cf.bind(this,i))},s.endOfStream=function(i){return ue(this,function(){ke(this)||(i?this.h.endOfStream(i):this.h.endOfStream())}.bind(this))},s.Ba=function(i){return ue(this,function(){this.h.duration=i}.bind(this))},s.ca=function(){return this.h.duration},s.Fe=function(i,a){this.b[i].appendBuffer(a)},s.Ge=function(i,a,o){o<=a?this.Gb(i):this.b[i].remove(a,o)},s.Pe=function(i){var a=this.b[i].appendWindowStart,o=this.b[i].appendWindowEnd;this.b[i].abort(),this.b[i].appendWindowStart=a,this.b[i].appendWindowEnd=o,this.Gb(i)},s.cf=function(i){this.f.currentTime-=.001,this.Gb(i)},s.ug=function(i,a){0>a&&(a+=.001),this.b[i].timestampOffset=a,this.Gb(i)},s.rg=function(i,a,o){this.b[i].appendWindowStart=0,this.b[i].appendWindowEnd=o,this.b[i].appendWindowStart=a,this.Gb(i)},s.vg=function(i){this.c[i][0].p.reject(new D(2,3,3014,this.f.error?this.f.error.code:0))},s.Gb=function(i){var a=this.c[i][0];a&&(a.p.resolve(),ve(this,i))};var gt=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),vt={Vd:function(i,a){function d(i){var a="";i.video&&(a=Gc(i.video.codecs)[0]);var o="";return i.audio&&(o=Gc(i.audio.codecs)[0]),a+"-"+o}var o=i.periods.reduce((function(i,a){return i.concat(a.variants)}),[]);o=vt.$d(o,a);for(var s=new ac,l=(o=t(o)).next();!l.done;l=o.next()){var C=d(l=l.value);s.push(C,l)}var R=null,j=1/0;for(s.forEach((function(i,a){for(var o=0,s=0,l=t(a),C=l.next();!C.done;C=l.next())o+=C.value.bandwidth||0,++s;o/=s,G.debug("codecs",i,"avg bandwidth",o),o<j&&(R=i,j=o)})),o=(s=t(i.periods)).next();!o.done;o=s.next())(o=o.value).variants=o.variants.filter((function(i){return d(i)==R||(G.debug("Dropping Variant (better codec available)",i),!1)}))},ld:function(i,a,o){function e(i,a,o){return i>=a&&i<=o}var s=i.video;return!(s&&s.width&&s.height&&(!e(s.width,a.minWidth,Math.min(a.maxWidth,o.width))||!e(s.height,a.minHeight,Math.min(a.maxHeight,o.height))||!e(s.width*s.height,a.minPixels,a.maxPixels))||i&&i.video&&i.video.frameRate&&!e(i.video.frameRate,a.minFrameRate,a.maxFrameRate)||!e(i.bandwidth,a.minBandwidth,a.maxBandwidth))},Sd:function(i,a,o){var s=!1;return i.forEach((function(i){var l=i.allowedByApplication;i.allowedByApplication=vt.ld(i,a,o),l!=i.allowedByApplication&&(s=!0)})),s},filterNewPeriod:function(i,a,o,s){s.variants=s.variants.filter((function(s){if(i&&i.V&&!xd(i,s))return G.debug("Dropping variant - not compatible with key system",s),!1;var l=s.audio;return s=s.video,l&&!ie(l)?(G.debug("Dropping variant - audio not compatible with platform",vt.yb(l)),!1):s&&!ie(s)?(G.debug("Dropping variant - video not compatible with platform",vt.yb(s)),!1):l&&a&&!vt.Td(l,a)?(G.debug("Droping variant - not compatible with active audio","active audio",vt.yb(a),"variant.audio",vt.yb(l)),!1):!(s&&o&&!vt.Td(s,o))||(G.debug("Droping variant - not compatible with active video","active video",vt.yb(o),"variant.video",vt.yb(s)),!1)})),s.textStreams=s.textStreams.filter((function(i){var a=ae(Dc(i.mimeType,i.codecs));return a||G.debug("Dropping text stream. Is not supported by the platform.",i),a}))},Td:function(i,a){return i.mimeType==a.mimeType&&i.codecs.split(".")[0]==a.codecs.split(".")[0]},Qd:function(i){var a=i.audio,o=i.video,s=a?a.codecs:null,l=o?o.codecs:null,C=[];l&&C.push(l),s&&C.push(s);var R=[];o&&R.push(o.mimeType),a&&R.push(a.mimeType),R=R[0]||null;var j=[];a&&j.push(a.kind),o&&j.push(o.kind),j=j[0]||null;var U=new Set;return a&&a.roles.forEach((function(i){return U.add(i)})),o&&o.roles.forEach((function(i){return U.add(i)})),i={id:i.id,active:!1,type:"variant",bandwidth:i.bandwidth,language:i.language,label:null,kind:j,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:R,codecs:C.join(", "),audioCodec:s,videoCodec:l,primary:i.primary,roles:Array.from(U),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},o&&(i.videoId=o.id,i.originalVideoId=o.originalId,i.width=o.width||null,i.height=o.height||null,i.frameRate=o.frameRate||null,i.pixelAspectRatio=o.pixelAspectRatio||null,i.videoBandwidth=o.bandwidth||null),a&&(i.audioId=a.id,i.originalAudioId=a.originalId,i.channelsCount=a.channelsCount,i.audioSamplingRate=a.audioSamplingRate,i.audioBandwidth=a.bandwidth||null,i.label=a.label,i.audioRoles=a.roles),i},Fc:function(i){return{id:i.id,active:!1,type:"text",bandwidth:0,language:i.language,label:i.label,kind:i.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:i.mimeType,codecs:i.codecs||null,audioCodec:null,videoCodec:null,primary:i.primary,roles:i.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:i.originalId}},ed:function(i){return i.__shaka_id||(i.__shaka_id=vt.Lf++),i.__shaka_id},Lf:0,Ff:function(i){var a=vt.ee(i);return a.active="disabled"!=i.mode,a.type="text",a.originalTextId=i.id,"captions"==i.kind&&(a.mimeType="application/cea-608"),i.kind&&(a.roles=[i.kind]),a},de:function(i){var a=vt.ee(i);return a.active=i.enabled,a.type="variant",a.originalAudioId=i.id,"main"==i.kind&&(a.primary=!0),i.kind&&(a.roles=[i.kind],a.audioRoles=[i.kind]),a},ee:function(i){return{id:vt.ed(i),active:!1,type:"",bandwidth:0,language:N(i.language),label:i.label,kind:i.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(i){return i.allowedByApplication&&i.allowedByKeySystem},tf:function(i){return i.filter((function(i){return vt.Bb(i)}))},$d:function(i,a){for(var o=i.filter((function(i){return i.audio&&i.audio.channelsCount})),s=new Map,l=(o=t(o)).next();!l.done;l=o.next()){var C=(l=l.value).audio.channelsCount;s.has(C)||s.set(C,[]),s.get(C).push(l)}return 0==(o=Array.from(s.keys())).length?i:(l=o.filter((function(i){return i<=a})),l.length?s.get(Math.max.apply(null,l)):s.get(Math.min.apply(null,o)))},Sb:function(i,a,o){var s=i,l=i.filter((function(i){return i.primary}));l.length&&(s=l);var C=s.length?s[0].language:"";if(s=s.filter((function(i){return i.language==C})),a){var R=Ae(N(a),i.map((function(i){return i.language})));R&&(s=i.filter((function(i){return N(i.language)==R})))}if(o){if((i=vt.Zd(s,o)).length)return i;G.m("No exact match for the text role could be found.")}else if((i=s.filter((function(i){return 0==i.roles.length}))).length)return i;return(i=s.map((function(i){return i.roles})).reduce(Ie.Oc,[])).length?vt.Zd(s,i[0]):s},Zd:function(i,a){return i.filter((function(i){return i.roles.includes(a)}))},ce:function(i,a,o){for(var s=0;s<o.length;s++)if(o[s].audio==i&&o[s].video==a)return o[s];return null},Gf:function(i){return"audio"==i.type},Jf:function(i){return"video"==i.type},Cf:function(i){var a=[];return i.audio&&a.push(i.audio),i.video&&a.push(i.video),a},yb:function(i){return vt.Gf(i)?"type=audio codecs="+i.codecs+" bandwidth="+i.bandwidth+" channelsCount="+i.channelsCount+" audioSamplingRate="+i.audioSamplingRate:vt.Jf(i)?"type=video codecs="+i.codecs+" bandwidth="+i.bandwidth+" frameRate="+i.frameRate+" width="+i.width+" height="+i.height:"unexpected stream type"}};function P(){this.h=null,this.c=!1,this.b=new fb,this.g=[],this.i=!1,this.a=this.f=null}function Be(i,a){return i&&(a=a.filter((function(a){return vt.ld(a,i,{width:1/0,height:1/0})}))),a.sort((function(i,a){return i.bandwidth-a.bandwidth}))}function Ce(i,a){this.a=i,this.b=a}function De(i,a){var o=new Ce(2,6),s=bt,l=s.a,C=o.b-l.b;(0<(o.a-l.a||C)?s.c:s.b)(s.a,o,i,a)}function Fe(i,a,o,s){G.Z([o,"has been deprecated and will be removed in",a,". We are currently at version",i,". Additional information:",s].join(" "))}function Ge(i,a,o,s){G.jc([o,"has been deprecated and has been removed in",a,". We are now at version",i,". Additional information:",s].join(""))}A("shaka.abr.SimpleAbrManager",P),P.prototype.stop=function(){this.h=null,this.c=!1,this.g=[],this.f=null},P.prototype.stop=P.prototype.stop,P.prototype.init=function(i){this.h=i},P.prototype.init=P.prototype.init,P.prototype.chooseVariant=function(){var i=Be(this.a.restrictions,this.g),a=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!i.length&&(G.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),i=[(i=Be(null,this.g))[0]]);for(var o=i[0]||null,s=0;s<i.length;++s){var l=i[s],C=l.bandwidth/this.a.bandwidthDowngradeTarget,R=(i[s+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;G.J("Bandwidth ranges:",(l.bandwidth/1e6).toFixed(3),(C/1e6).toFixed(3),(R/1e6).toFixed(3)),a>=C&&a<=R&&(o=l)}return this.f=Date.now(),o},P.prototype.chooseVariant=P.prototype.chooseVariant,P.prototype.enable=function(){this.c=!0},P.prototype.enable=P.prototype.enable,P.prototype.disable=function(){this.c=!1},P.prototype.disable=P.prototype.disable,P.prototype.segmentDownloaded=function(i,a){G.J("Segment downloaded:","deltaTimeMs="+i,"numBytes="+a,"lastTimeChosenMs="+this.f,"enabled="+this.c);var o=this.b;if(!(16e3>a)){var s=8e3*a/i,l=i/1e3;o.a+=a,db(o.b,l,s),db(o.c,l,s)}if(null!=this.f&&this.c)e:{if(G.J("Suggesting Streams..."),this.i){if(Date.now()-this.f<1e3*this.a.switchInterval){G.J("Still within switch interval...");break e}}else{if(!(128e3<=this.b.a)){G.J("Still waiting for a good estimate...");break e}this.i=!0}o=this.chooseVariant(),s=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),G.debug("Calling switch_(), bandwidth="+Math.round(s/1e3)+" kbps"),this.h(o)}},P.prototype.segmentDownloaded=P.prototype.segmentDownloaded,P.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},P.prototype.getBandwidthEstimate=P.prototype.getBandwidthEstimate,P.prototype.setVariants=function(i){this.g=i},P.prototype.setVariants=P.prototype.setVariants,P.prototype.configure=function(i){this.a=i},P.prototype.configure=P.prototype.configure,Ce.prototype.toString=function(){return"v"+this.a+"."+this.b};var bt=null,yt="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),wt="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Tt=["loop","playbackRate"],St=["pause","play"],Et="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),xt={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},kt={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},At=[["getConfiguration","configure"]],Mt=[["isTextTrackVisible","setTextTrackVisibility"]],It="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),Pt=["attach","detach","load","unload"];function Se(i){return JSON.stringify(i,(function(i,a){if("function"!=typeof a){if(a instanceof Event||a instanceof K){var o={};for(l in a){var s=a[l];s&&"object"==typeof s?"detail"==l&&(o[l]=s):l in Event||(o[l]=s)}return o}if(a instanceof Error){var l=new Set(["name","message","stack"]);for(o in a)l.add(o);for(o=(s=t(Object.getOwnPropertyNames(a))).next();!o.done;o=s.next())l.add(o.value);for(s={},o=(l=t(l)).next();!o.done;o=l.next())s[o=o.value]=a[o];l={__type__:"Error",contents:s}}else if(a instanceof TimeRanges)for(l={__type__:"TimeRanges",length:a.length,start:[],end:[]},o=0;o<a.length;++o)l.start.push(a.start(o)),l.end.push(a.end(o));else l=a instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(a)}:"number"==typeof a?isNaN(a)?"NaN":isFinite(a)?a:0>a?"-Infinity":"Infinity":a;return l}}))}function Te(i){return JSON.parse(i,(function(i,a){if("NaN"==a)var o=NaN;else if("-Infinity"==a)o=-1/0;else if("Infinity"==a)o=1/0;else if(a&&"object"==typeof a&&"TimeRanges"==a.__type__)o=function Ue(i){return{length:i.length,start:function(a){return i.start[a]},end:function(a){return i.end[a]}}}(a);else if(a&&"object"==typeof a&&"Uint8Array"==a.__type__)o=new Uint8Array(a.entries);else if(a&&"object"==typeof a&&"Error"==a.__type__){o=a.contents;var s,l=Error(o.message);for(s in o)l[s]=o[s];o=l}else o=a;return o}))}function Ve(i,a,o,s,l,C){this.T=i,this.f=new I(a),this.V=o,this.l=!1,this.w=s,this.K=l,this.G=C,this.b=this.h=!1,this.H="",this.i=null,this.o=this.sd.bind(this),this.u=this.Sf.bind(this),this.a={video:{},player:{}},this.D=0,this.c={},this.g=null,Nt.add(this)}var Dt=!1,Ct=null;function af(i){for(var a=t(Nt),o=a.next();!o.done;o=a.next())cf(o.value,i)}function cf(i,a){G.debug("CastSender: onExistingSessionJoined");var o=i.G();i.g=new E,i.l=!0,i.ud(o,a)}function bf(i){for(var a=t(Nt),o=a.next();!o.done;o=a.next()){o=o.value;var s=i;G.debug("CastSender: receiver status",s),Dt="available"==s,o.f.Gc()}}function $e(i){var a=Ct;a.removeUpdateListener(i.o),a.removeMessageListener("urn:x-cast:com.google.shaka.v2",i.u)}function Ze(i){for(var a in i.c){var o=i.c[a];delete i.c[a],o.reject(new D(1,7,7e3))}}function df(i,a){var o=Se(a),s=Ct;try{s.sendMessage("urn:x-cast:com.google.shaka.v2",o,(function(){}),G.error)}catch(a){throw G.error("Cast session sendMessage threw",a),o=new D(2,8,8005,a),i.w("player",new K("error",{detail:o})),i.vb(),o}}(s=Ve.prototype).destroy=function(){return Nt.delete(this),Ze(this),Ct&&$e(this),this.f&&(this.f.stop(),this.f=null),this.K=this.w=null,this.b=this.h=!1,this.u=this.o=this.g=this.c=this.a=this.i=null,Promise.resolve()},s.ha=function(){return this.b},s.xd=function(){return this.H},s.init=function(){if(i.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.T.length){this.h=!0,this.f.Gc();var a=new chrome.cast.SessionRequest(this.T);a=new chrome.cast.ApiConfig(a,af.bind(this),bf.bind(this),"origin_scoped"),chrome.cast.initialize(a,(function(){G.debug("CastSender: init")}),(function(i){G.error("CastSender: init error",i)})),Dt&&this.f.R(.02),(a=Ct)&&a.status!=chrome.cast.SessionStatus.STOPPED?(G.debug("CastSender: re-using existing connection"),cf(this,a)):Ct=null}},s.Gd=function(i){this.i=i,this.b&&df(this,{type:"appData",appData:this.i})},s.cast=function(i){return this.h?Dt?this.b?Promise.reject(new D(1,8,8002)):(this.g=new E,chrome.cast.requestSession(this.ud.bind(this,i),this.pe.bind(this)),this.g):Promise.reject(new D(1,8,8001)):Promise.reject(new D(1,8,8e3))},s.vb=function(){if(this.b){if(Ze(this),Ct){$e(this);try{Ct.stop((function(){}),(function(){}))}catch(i){}Ct=null}this.sd()}},s.get=function(i,a){if("video"==i){if(St.includes(a))return this.ye.bind(this,i,a)}else if("player"==i){if(kt[a]&&!this.get("player","isLive")())return function(){};if(It.includes(a))return this.ye.bind(this,i,a);if(Pt.includes(a))return this.ig.bind(this,i,a);if(xt[a])return this.ve.bind(this,i,a)}return this.ve(i,a)},s.set=function(i,a,o){this.a[i][a]=o,df(this,{type:"set",targetName:i,property:a,value:o})},s.ud=function(i,a){G.debug("CastSender: onSessionInitiated"),Ct=a,a.addUpdateListener(this.o),a.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u),this.sd(),df(this,{type:"init",initState:i,appData:this.i}),this.g.resolve()},s.pe=function(i){var a=8003;switch(i.code){case"cancel":a=8004;break;case"timeout":a=8005;break;case"receiver_unavailable":a=8006}this.g.reject(new D(2,8,a,i))},s.ve=function(i,a){return this.a[i][a]},s.ye=function(i,a,o){for(var s=[],l=2;l<arguments.length;++l)s[l-2]=arguments[l];df(this,{type:"call",targetName:i,methodName:a,args:s})},s.ig=function(i,a,o){for(var s=[],l=2;l<arguments.length;++l)s[l-2]=arguments[l];l=new E;var C=this.D.toString();this.D++,this.c[C]=l;try{df(this,{type:"asyncCall",targetName:i,methodName:a,args:s,id:C})}catch(i){l.reject(i)}return l},s.sd=function(){var i=!!Ct&&"connected"==Ct.status;if(G.debug("CastSender: connection status",i),this.b&&!i){for(var a in this.K(),this.a)this.a[a]={};Ze(this)}this.H=(this.b=i)?Ct.receiver.friendlyName:"",this.f.Gc()},s.Sf=function(i,a){var o=Te(a);switch(G.J("CastSender: message",o),o.type){case"event":var s=o.event;this.w(o.targetName,new K(s.type,s));break;case"update":for(var l in s=o.update)for(var C in o=this.a[l]||{},s[l])o[C]=s[l][C];this.l&&(this.V(),this.l=!1);break;case"asyncComplete":if(l=o.id,o=o.error,C=this.c[l],delete this.c[l],C)if(o){for(s in l=new D(o.severity,o.category,o.code),o)l[s]=o[s];C.reject(l)}else C.resolve()}};var Nt=new Set;function Q(i,a,o){var s=this;bc.call(this),this.c=i,this.b=a,this.i=this.g=this.f=this.l=this.h=null,this.u=o,this.o=new Map,this.a=new Ve(o,(function(){return ef(s)}),(function(){return ff(s)}),(function(i,a){return gf(s,i,a)}),(function(){return hf(s)}),(function(){return jf(s)})),function kf(i){for(var a in i.a.init(),i.i=new M,yt.forEach(function(i){this.i.B(this.c,i,this.G.bind(this))}.bind(i)),Et.forEach(function(i){this.i.B(this.b,i,this.w.bind(this))}.bind(i)),i.h={},i.c)Object.defineProperty(i.h,a,{configurable:!1,enumerable:!0,get:i.D.bind(i,a),set:i.H.bind(i,a)});i.l={},lf(i,(function(a){Object.defineProperty(i.l,a,{configurable:!1,enumerable:!0,get:function(){return mf(i,a)}})})),function nf(i){var a=new Map;lf(i,(function(o,s){if(a.has(s)){var l=a.get(s);o.length<l.length?i.o.set(o,l):i.o.set(l,o)}else a.set(s,o)}))}(i),i.f=new bc,i.f.gc=i.h,i.g=new bc,i.g.gc=i.l}(this)}function lf(i,a){function d(i){return"constructor"!=i&&"function"==typeof o[i]&&!s.has(i)}var o=i.b,s=new Set;for(l in o)d(l)&&(s.add(l),a(l,o[l]));for(var l=Object.getPrototypeOf(o),C=Object.getPrototypeOf({});l&&l!=C;){for(var R=t(Object.getOwnPropertyNames(l)),j=R.next();!j.done;j=R.next())d(j=j.value)&&(s.add(j),a(j,o[j]));l=Object.getPrototypeOf(l)}}function jf(i){var a={video:{},player:{},playerAfterLoad:{},manifest:i.b.pc(),startTime:null};return i.c.pause(),Tt.forEach(function(i){a.video[i]=this.c[i]}.bind(i)),i.c.ended||(a.startTime=i.c.currentTime),At.forEach(function(i){var o=i[1];i=this.b[i[0]](),a.player[o]=i}.bind(i)),Mt.forEach(function(i){var o=i[1];i=this.b[i[0]](),a.playerAfterLoad[o]=i}.bind(i)),a}function ef(i){i.dispatchEvent(new K("caststatuschanged"))}function ff(i){i.f.dispatchEvent(new K(i.h.paused?"pause":"play"))}function hf(i){At.forEach(function(i){var a=i[1];i=this.a.get("player",i[0])(),this.b[a](i)}.bind(i));var a=i.a.get("player","getAssetUri")(),o=i.a.get("video","ended"),s=Promise.resolve(),l=i.c.autoplay,C=null;o||(C=i.a.get("video","currentTime")),a&&(i.c.autoplay=!1,s=i.b.load(a,C));var R={};Tt.forEach(function(i){R[i]=this.a.get("video",i)}.bind(i)),s.then((function(){i.c&&(Tt.forEach(function(i){this.c[i]=R[i]}.bind(i)),Mt.forEach(function(i){var a=i[1];i=this.a.get("player",i[0])(),this.b[a](i)}.bind(i)),i.c.autoplay=l,a&&i.c.play())}),(function(a){i.b.dispatchEvent(new K("error",{detail:a}))}))}function mf(i,a){if(i.o.has(a)&&(a=i.o.get(a)),"addEventListener"==a)return i.g.addEventListener.bind(i.g);if("removeEventListener"==a)return i.g.removeEventListener.bind(i.g);if("getMediaElement"==a)return function(){return this.h}.bind(i);if("getSharedConfiguration"==a)return G.m("Can't share configuration across a network. Returning copy."),i.a.get("player","getConfiguration");if("getNetworkingEngine"==a)return i.a.ha()&&G.m("NOTE: getNetworkingEngine() is always local!"),i.b.Ub.bind(i.b);if(i.a.ha()){if("getManifest"==a||"drmInfo"==a)return function(){return G.Z(a+"() does not work while casting!"),null};if("getManifestUri"==a)return De("getManifestUri",'Please use "getAssetUri" instead.'),mf(i,"getAssetUri");if("attach"==a||"detach"==a)return function(){return G.Z(a+"() does not work while casting!"),Promise.resolve()}}return i.a.ha()&&0==Object.keys(i.a.a.video).length&&xt[a]||!i.a.ha()?i.b[a].bind(i.b):i.a.get("player",a)}function gf(i,a,o){i.a.ha()&&("video"==a?i.f.dispatchEvent(o):"player"==a&&i.g.dispatchEvent(o))}function of(i,a,o,s){var l=this;bc.call(this),this.a=i,this.b=a,this.c=new M,this.G={video:i,player:a},this.u=o||function(){},this.H=s||function(i){return i},this.w=!1,this.h=!0,this.g=0,this.o=!1,this.l=!0,this.i=this.f=null,this.D=new I((function(){pf(l)})),function qf(i){var a=cast.receiver.CastReceiverManager.getInstance();a.onSenderConnected=i.re.bind(i),a.onSenderDisconnected=i.re.bind(i),a.onSystemVolumeChanged=i.bf.bind(i),i.i=a.getCastMessageBus("urn:x-cast:com.google.cast.media"),i.i.onMessage=i.Nf.bind(i),i.f=a.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),i.f.onMessage=i.Xf.bind(i),a.start(),yt.forEach(function(i){this.c.B(this.a,i,this.we.bind(this,"video"))}.bind(i)),Et.forEach(function(i){this.c.B(this.b,i,this.we.bind(this,"player"))}.bind(i)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?i.b.Hd(3840,2160):i.b.Hd(1920,1080),i.c.B(i.a,"loadeddata",function(){this.o=!0}.bind(i)),i.c.B(i.b,"loading",function(){this.h=!1,rf(this)}.bind(i)),i.c.B(i.a,"playing",function(){this.h=!1,rf(this)}.bind(i)),i.c.B(i.a,"pause",function(){rf(this)}.bind(i)),i.c.B(i.b,"unloading",function(){this.h=!0,rf(this)}.bind(i)),i.c.B(i.a,"ended",function(){var i=this;new I((function(){i.a&&i.a.ended&&(i.h=!0,rf(i))})).R(5)}.bind(i))}(this)}function rf(i){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new K("caststatuschanged")),sf(this)||tf(this))}.bind(i))}function pf(i){i.D.R(.5);var a={video:{},player:{}};if(wt.forEach(function(i){a.video[i]=this.a[i]}.bind(i)),i.b.X())for(var o in kt)0==i.g%kt[o]&&(a.player[o]=i.b[o]());for(var s in xt)0==i.g%xt[s]&&(a.player[s]=i.b[s]());(o=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(a.video.volume=o.level,a.video.muted=o.muted),i.o&&(i.g+=1),vf(i,{type:"update",update:a},i.f),sf(i)}function sf(i){return!(!i.l||!i.a.duration&&!i.b.X())&&(wf(i),i.l=!1,!0)}function wf(i,a){a=void 0===a?0:a;var o={contentId:i.b.pc(),streamType:i.b.X()?"LIVE":"BUFFERED",contentType:""};i.b.X()||(o.duration=i.a.duration),tf(i,a,o)}function vf(i,a,o,s){i.w&&(i=Se(a),s?o.getCastChannel(s).send(i):o.broadcast(i))}function tf(i,a,o){a=void 0===a?0:a,o=void 0===o?null:o;var s=i.a.playbackRate,l=Rt;s={mediaSessionId:0,playbackRate:s,playerState:l=i.h?l.IDLE:i.b.fd()?l.Ke:i.a.paused?l.Me:l.Ne,currentTime:i.a.currentTime,supportedMediaCommands:63,volume:{level:i.a.volume,muted:i.a.muted}},o&&(s.media=o),vf(i,{requestId:a,type:"MEDIA_STATUS",status:[s]},i.i)}i.__onGCastApiAvailable=function(i){if(i)for(var a=(i=t(Nt)).next();!a.done;a=i.next())a.value.init()},bb(Q,bc),A("shaka.cast.CastProxy",Q),Q.prototype.destroy=function(i){return i&&this.a.vb(),this.i&&(this.i.release(),this.i=null),i=[],this.b&&(i.push(this.b.destroy()),this.b=null),this.a&&(i.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(i)},Q.prototype.destroy=Q.prototype.destroy,Q.prototype.Df=function(){return this.h},Q.prototype.getVideo=Q.prototype.Df,Q.prototype.vf=function(){return this.l},Q.prototype.getPlayer=Q.prototype.vf,Q.prototype.Se=function(){return this.a.h&&Dt},Q.prototype.canCast=Q.prototype.Se,Q.prototype.ha=function(){return this.a.ha()},Q.prototype.isCasting=Q.prototype.ha,Q.prototype.xd=function(){return this.a.xd()},Q.prototype.receiverName=Q.prototype.xd,Q.prototype.cast=function(){var i=jf(this);return this.a.cast(i).then(function(){if(this.b)return this.b.Od()}.bind(this))},Q.prototype.cast=Q.prototype.cast,Q.prototype.Gd=function(i){this.a.Gd(i)},Q.prototype.setAppData=Q.prototype.Gd,Q.prototype.Cg=function(){var i=this.a;if(i.b){var a=i.G();chrome.cast.requestSession(i.ud.bind(i,a),i.pe.bind(i))}},Q.prototype.suggestDisconnect=Q.prototype.Cg,Q.prototype.Ve=function(i){var a=this;return u((function e(){return x(e,(function(o){switch(o.j){case 1:return i==a.u?o.return():(a.u=i,a.a.vb(),v(o,a.a.destroy(),2));case 2:a.a=null,a.a=new Ve(i,(function(){return ef(a)}),(function(){return ff(a)}),(function(i,o){return gf(a,i,o)}),(function(){return hf(a)}),(function(){return jf(a)})),a.a.init(),w(o)}}))}))},Q.prototype.changeReceiverId=Q.prototype.Ve,Q.prototype.vb=function(){this.a.vb()},Q.prototype.forceDisconnect=Q.prototype.vb,Q.prototype.D=function(i){if("addEventListener"==i)return this.f.addEventListener.bind(this.f);if("removeEventListener"==i)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var a=this.c[i];if("function"!=typeof a)return a}return this.a.ha()?this.a.get("video",i):("function"==typeof(i=this.c[i])&&(i=i.bind(this.c)),i)},Q.prototype.H=function(i,a){this.a.ha()?this.a.set("video",i,a):this.c[i]=a},Q.prototype.G=function(i){this.a.ha()||this.f.dispatchEvent(new K(i.type,i))},Q.prototype.w=function(i){this.a.ha()||this.g.dispatchEvent(i)},bb(of,bc),A("shaka.cast.CastReceiver",of),of.prototype.isConnected=function(){return this.w},of.prototype.isConnected=of.prototype.isConnected,of.prototype.If=function(){return this.h},of.prototype.isIdle=of.prototype.If,of.prototype.destroy=function(){var i=this;return u((function d(){var a;return x(d,(function(o){switch(o.j){case 1:return i.c&&(i.c.release(),i.c=null),a=[],i.b&&(a.push(i.b.destroy()),i.b=null),i.D&&(i.D.stop(),i.D=null),i.a=null,i.G=null,i.u=null,i.w=!1,i.h=!0,i.f=null,i.i=null,v(o,Promise.all(a),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),w(o)}}))}))},of.prototype.destroy=of.prototype.destroy,(s=of.prototype).re=function(){this.g=0,this.l=!0,this.w=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,rf(this)},s.we=function(i,a){this.b&&(pf(this),vf(this,{type:"event",targetName:i,event:a},this.f))},s.bf=function(){var i=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();i&&vf(this,{type:"update",update:{video:{volume:i.level,muted:i.muted}}},this.f),vf(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},s.Xf=function(i){var a=Te(i.data);switch(G.debug("CastReceiver: message",a),a.type){case"init":this.g=0,this.o=!1,this.l=!0,function uf(i,a,o){for(var s in a.player)i.b[s](a.player[s]);i.u(o),o=Promise.resolve();var l=i.a.autoplay;a.manifest&&(i.a.autoplay=!1,o=i.b.load(a.manifest,a.startTime)),o.then((function(){if(i.b){for(var o in a.video)i.a[o]=a.video[o];for(var s in a.playerAfterLoad)i.b[s](a.playerAfterLoad[s]);i.a.autoplay=l,a.manifest&&(i.a.play(),tf(i))}}),(function(a){i.b.dispatchEvent(new K("error",{detail:a}))}))}(this,a.initState,a.appData),pf(this);break;case"appData":this.u(a.appData);break;case"set":var o=a.targetName,s=a.property;if(a=a.value,"video"==o){var l=cast.receiver.CastReceiverManager.getInstance();if("volume"==s){l.setSystemVolumeLevel(a);break}if("muted"==s){l.setSystemVolumeMuted(a);break}}this.G[o][s]=a;break;case"call":(o=this.G[a.targetName])[a.methodName].apply(o,a.args);break;case"asyncCall":o=a.targetName,s=a.methodName,"player"==o&&"load"==s&&(this.g=0,this.o=!1),l=a.id,i=i.senderId;var C=this.G[o];a=C[s].apply(C,a.args),"player"==o&&"load"==s&&(a=a.then(function(){this.l=!0}.bind(this))),a.then(this.Ce.bind(this,i,l,null),this.Ce.bind(this,i,l))}},s.Nf=function(i){var a=Te(i.data);switch(G.debug("CastReceiver: message",a),a.type){case"PLAY":this.a.play(),tf(this);break;case"PAUSE":this.a.pause(),tf(this);break;case"SEEK":i=a.currentTime;var o=a.resumeState;null!=i&&(this.a.currentTime=Number(i)),o&&"PLAYBACK_START"==o?(this.a.play(),tf(this)):o&&"PLAYBACK_PAUSE"==o&&(this.a.pause(),tf(this));break;case"STOP":this.b.Od().then(function(){this.b&&tf(this)}.bind(this));break;case"GET_STATUS":wf(this,Number(a.requestId));break;case"VOLUME":i=(o=a.volume).level,o=o.muted;var s=this.a.volume,l=this.a.muted;null!=i&&(this.a.volume=Number(i)),null!=o&&(this.a.muted=o),s==this.a.volume&&l==this.a.muted||tf(this);break;case"LOAD":this.g=0,this.l=this.o=!1,i=a.media,o=a.currentTime,s=this.H(i.contentId),l=a.autoplay||!0,this.u(i.customData),l&&(this.a.autoplay=!0),this.b.load(s,o).then(function(){this.b&&wf(this)}.bind(this)).catch(function(i){var o="LOAD_FAILED";7==i.category&&7e3==i.code&&(o="LOAD_CANCELLED"),vf(this,{requestId:Number(a.requestId),type:o},this.i)}.bind(this));break;default:G.m("Unrecognized message type from the generic Chromecast controller!",a.type),vf(this,{requestId:Number(a.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},s.Ce=function(i,a,o){this.b&&vf(this,{type:"asyncComplete",id:a,error:o},this.f,i)};var Rt={IDLE:"IDLE",Ne:"PLAYING",Ke:"BUFFERING",Me:"PAUSED"};function S(i,a){this.N=i,this.b=a==jt,this.a=0}A("shaka.util.DataViewReader",S);var jt=1;function zf(){throw new D(2,3,3e3)}function T(){this.c=[],this.b=[],this.a=!1}function Cf(i){for(var a=Df(i);i.reader.ya()&&!i.parser.a;)i.parser.Ac(i.start+a,i.reader,i.partialOkay)}function Ef(i){for(var a=Df(i),o=i.reader.I();0<o&&!i.parser.a;--o)i.parser.Ac(i.start+a,i.reader,i.partialOkay)}function Ff(i){return function(a){i(a.reader.gb(a.reader.N.byteLength-a.reader.ga()))}}function Af(i){for(var a=0,o=0;o<i.length;o++)a=a<<8|i.charCodeAt(o);return a}function Bf(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i)}function Df(i){return 8+(i.has64BitSize?8:0)+(null!=i.flags?4:0)}function Gf(i){var a=this;this.a=[],this.b=[],this.data=[],(new T).L("moov",Cf).ia("pssh",(function(i){if(1<i.version)G.m("Unrecognized PSSH version found!");else{var o=i.reader.N;if(o=new Uint8Array(o.buffer,o.byteOffset-12,i.size),a.data.push(o),a.a.push(Le.Ic(i.reader.gb(16))),0<i.version){o=i.reader.I();for(var s=0;s<o;++s){var l=Le.Ic(i.reader.gb(16));a.b.push(l)}}}})).parse(i),0==this.data.length&&G.m("No pssh box found!")}S.Endianness={Lg:0,Ng:jt},S.prototype.ya=function(){return this.a<this.N.byteLength},S.prototype.hasMoreData=S.prototype.ya,S.prototype.ga=function(){return this.a},S.prototype.getPosition=S.prototype.ga,S.prototype.jf=function(){return this.N.byteLength},S.prototype.getLength=S.prototype.jf,S.prototype.na=function(){try{var i=this.N.getUint8(this.a);return this.a+=1,i}catch(i){zf()}},S.prototype.readUint8=S.prototype.na,S.prototype.$b=function(){try{var i=this.N.getUint16(this.a,this.b);return this.a+=2,i}catch(i){zf()}},S.prototype.readUint16=S.prototype.$b,S.prototype.I=function(){try{var i=this.N.getUint32(this.a,this.b);return this.a+=4,i}catch(i){zf()}},S.prototype.readUint32=S.prototype.I,S.prototype.xe=function(){try{var i=this.N.getInt32(this.a,this.b);return this.a+=4,i}catch(i){zf()}},S.prototype.readInt32=S.prototype.xe,S.prototype.Kb=function(){try{if(this.b)var i=this.N.getUint32(this.a,!0),a=this.N.getUint32(this.a+4,!0);else a=this.N.getUint32(this.a,!1),i=this.N.getUint32(this.a+4,!1)}catch(i){zf()}if(2097151<a)throw new D(2,3,3001);return this.a+=8,a*Math.pow(2,32)+i},S.prototype.readUint64=S.prototype.Kb,S.prototype.gb=function(i){this.a+i>this.N.byteLength&&zf();var a=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,i);return this.a+=i,a},S.prototype.readBytes=S.prototype.gb,S.prototype.P=function(i){this.a+i>this.N.byteLength&&zf(),this.a+=i},S.prototype.skip=S.prototype.P,S.prototype.ze=function(i){this.a<i&&zf(),this.a-=i},S.prototype.rewind=S.prototype.ze,S.prototype.seek=function(i){(0>i||i>this.N.byteLength)&&zf(),this.a=i},S.prototype.seek=S.prototype.seek,S.prototype.wd=function(){for(var i=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;return i=new Uint8Array(this.N.buffer,this.N.byteOffset+i,this.a-i),this.a+=1,Gb(i)},S.prototype.readTerminatedString=S.prototype.wd,A("shaka.util.Mp4Parser",T),T.prototype.L=function(i,a){var o=Af(i);return this.c[o]=0,this.b[o]=a,this},T.prototype.box=T.prototype.L,T.prototype.ia=function(i,a){var o=Af(i);return this.c[o]=1,this.b[o]=a,this},T.prototype.fullBox=T.prototype.ia,T.prototype.stop=function(){this.a=!0},T.prototype.stop=T.prototype.stop,T.prototype.parse=function(i,a){var o=new Uint8Array(i);for(o=new S(new DataView(o.buffer,o.byteOffset,o.byteLength),0),this.a=!1;o.ya()&&!this.a;)this.Ac(0,o,a)},T.prototype.parse=T.prototype.parse,T.prototype.Ac=function(i,a,o){var s=a.ga(),l=a.I(),C=a.I(),R=!1;switch(G.J("Parsing MP4 box",Bf(C)),l){case 0:l=a.N.byteLength-s;break;case 1:l=a.Kb(),R=!0}var j=this.b[C];if(j){var U=null,_=null;1==this.c[C]&&(U=(_=a.I())>>>24,_&=16777215),C=s+l,o&&C>a.N.byteLength&&(C=a.N.byteLength),C-=a.ga(),a=0<C?a.gb(C):new Uint8Array(0),j({parser:this,partialOkay:o||!1,version:U,flags:_,reader:a=new S(new DataView(a.buffer,a.byteOffset,a.byteLength),0),size:l,start:s+i,has64BitSize:R})}else a.P(Math.min(s+l-a.ga(),a.N.byteLength-a.ga()))},T.prototype.parseNext=T.prototype.Ac,T.children=Cf,T.sampleDescription=Ef,T.allData=Ff,T.typeToString=Bf,T.headerSize=Df;var Lt={oc:function(i,a){var o=Lt.U(i,a);return 1!=o.length?null:o[0]},Wc:function(i,a,o){return 1!=(i=Lt.ae(i,a,o)).length?null:i[0]},U:function(i,a){return Array.prototype.filter.call(i.childNodes,(function(i){return i instanceof Element&&i.tagName==a}))},ae:function(i,a,o){return Array.prototype.filter.call(i.childNodes,(function(i){return i instanceof Element&&i.localName==o&&i.namespaceURI==a}))},getAttributeNS:function(i,a,o){return i.hasAttributeNS(a,o)?i.getAttributeNS(a,o):null},qc:function(i){return Array.prototype.every.call(i.childNodes,(function(i){return i.nodeType==Node.TEXT_NODE||i.nodeType==Node.CDATA_SECTION_NODE}))?i.textContent.trim():null},M:function(i,a,o,s){s=void 0===s?null:s;var l=null;return null!=(i=i.getAttribute(a))&&(l=o(i)),null==l?s:l},ag:function(i){return i?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(i)&&(i+="Z"),i=Date.parse(i),isNaN(i)?null:Math.floor(i/1e3)):null},Ia:function(i){if(!i)return null;var a=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(i);return a?(i=31536e3*Number(a[1]||null)+2592e3*Number(a[2]||null)+86400*Number(a[3]||null)+3600*Number(a[4]||null)+60*Number(a[5]||null)+Number(a[6]||null),isFinite(i)?i:null):(G.m("Invalid duration string:",i),null)},Cc:function(i){var a=/([0-9]+)-([0-9]+)/.exec(i);return a?(i=Number(a[1]),isFinite(i)?(a=Number(a[2]),isFinite(a)?{start:i,end:a}:null):null):null},parseInt:function(i){return 0==(i=Number(i))%1?i:null},Bc:function(i){return 0==(i=Number(i))%1&&0<i?i:null},Hb:function(i){return 0==(i=Number(i))%1&&0<=i?i:null},parseFloat:function(i){return i=Number(i),isNaN(i)?null:i},$e:function(i){var a;return i=(a=i.match(/^(\d+)\/(\d+)$/))?Number(a[1])/Number(a[2]):Number(i),isNaN(i)?null:i},ue:function(i,a){var o=new DOMParser;try{var s=o.parseFromString(i,"text/xml")}catch(i){}if(s&&s.documentElement.tagName==a)var l=s.documentElement;return l&&0<l.getElementsByTagName("parsererror").length?null:l},te:function(i,a){try{var o=Gb(i);return Lt.ue(o,a)}catch(i){}}},Ut=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Jf(i,a,o){var s=function Kf(i){for(var a=[],o=(i=t(i)).next();!o.done;o=i.next())(o=Qf(o.value))&&a.push(o);return a}(i),l=null;i=[];var C=[],R=new Set(s.map((function(i){return i.keyId})));if(R.delete(null),1<R.size)throw new D(2,4,4010);if(o||(C=s.filter((function(i){return"urn:mpeg:dash:mp4protection:2011"!=i.Ae||(l=i.init||l,!1)})),C.length&&(i=function Lf(i,a,o){for(var s=[],l=(o=t(o)).next();!l.done;l=o.next()){l=l.value;var C=Ut.get(l.Ae);if(C){var R;if(R=Lt.Wc(l.node,"urn:microsoft:playready","pro")){R=Le.Fa(R.textContent);var j=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),U=R.length,_=j.length+16+U,O=new ArrayBuffer(_),B=new Uint8Array(O),F=0;(O=new DataView(O)).setUint32(F,_),F+=4,O.setUint32(F,1886614376),F+=4,O.setUint32(F,0),F+=4,B.set(j,F),F+=j.length,O.setUint32(F,U),F+=4,B.set(R,F),R=[{initData:B,initDataType:"cenc",keyId:l.keyId}]}else R=null;R=zb(C,l.init||i||R),(C=Ot.get(C))&&(R.licenseServerUri=C(l)),s.push(R)}else for(C=(l=t(l=a(l.node)||[])).next();!C.done;C=l.next())s.push(C.value)}return s}(l,a,C),0==i.length&&(i=[zb("",l)]))),s.length&&(o||!C.length))for(i=[],o=(a=t(Ut.values())).next();!o.done;o=a.next())"org.w3.clearkey"!=(o=o.value)&&i.push(zb(o,l));if(R=Array.from(R)[0]||null)for(o=(a=t(i)).next();!o.done;o=a.next())for(s=(o=t(o.value.initData)).next();!s.done;s=o.next())s.value.keyId=R;return{Xd:R,Pg:l,drmInfos:i,be:!0}}var _t,Ot=(new Map).set("com.widevine.alpha",(function(i){return(i=Lt.Wc(i.node,"urn:microsoft","laurl"))&&i.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",(function(i){return(i=Lt.Wc(i.node,"urn:microsoft:playready","pro"))&&(i=function Nf(i){var a=0,o=new DataView(i).getUint32(a,!0);if(a+=4,o!==i.byteLength)return G.m("PlayReady Object with invalid length encountered."),[];a+=2,o=[];for(var s=new DataView(i);a<i.byteLength-1;){var l=s.getUint16(a,!0);a+=2;var C=s.getUint16(a,!0);a+=2;var R=new Uint8Array(i,a,C);o.push({type:l,value:R}),a+=C}return o}((i=Le.Fa(i.textContent)).buffer).filter((function(i){return 1===i.type}))[0])?(i=Ib(i.value,!0),(i=Lt.ue(i,"WRMHEADER"))?function Of(i){for(var a=(i=t(i.getElementsByTagName("DATA"))).next();!a.done;a=i.next())for(var o=(a=t(a.value.childNodes)).next();!o.done;o=a.next())if((o=o.value)instanceof Element&&"LA_URL"==o.tagName)return o.textContent;return""}(i):""):""}));function Qf(i){var a=i.getAttribute("schemeIdUri"),o=Lt.getAttributeNS(i,"urn:mpeg:cenc:2013","default_KID"),s=Lt.ae(i,"urn:mpeg:cenc:2013","pssh").map(Lt.qc);if(!a)return G.error("Missing required schemeIdUri attribute on","ContentProtection element",i),null;if(a=a.toLowerCase(),o&&(o=o.replace(/-/g,"").toLowerCase()).includes(" "))throw new D(2,4,4009);var l=[];try{l=s.map((function(i){return{initDataType:"cenc",initData:Le.Fa(i),keyId:null}}))}catch(i){throw new D(2,4,4007)}return{node:i,Ae:a,keyId:o,init:0<l.length?l:null}}function Rf(a,o,s,l,C){var R={RepresentationID:o,Number:s,Bandwidth:l,Time:C};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(o,s,l,C){if("$$"==o)return"$";var j=R[s];if(null==j)return G.m("URL template does not have an available substitution for identifier",'"'+s+'":',a),o;switch("RepresentationID"==s&&l&&(G.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',a),l=void 0),"Time"==s&&(j=Math.round(j)),C){case void 0:case"d":case"i":case"u":o=j.toString();break;case"o":o=j.toString(8);break;case"x":o=j.toString(16);break;case"X":o=j.toString(16).toUpperCase();break;default:o=j.toString()}return l=i.parseInt(l,10)||1,Array(Math.max(0,l-o.length)+1).join("0")+o}))}function Sf(i,a){var o=Tf(i,a,"timescale"),s=1;o&&(s=Lt.Bc(o)||1),o=Tf(i,a,"duration"),(o=Lt.Bc(o||""))&&(o/=s);var l=Tf(i,a,"startNumber"),C=Number(Tf(i,a,"presentationTimeOffset"))||0,R=Lt.Hb(l||"");null!=l&&null!=R||(R=1);var j=Uf(i,a,"SegmentTimeline");if(l=null,j){l=s;var U=i.W.duration||1/0;j=Lt.U(j,"S");for(var _=[],O=-C,B=0;B<j.length;++B){var F=j[B],H=Lt.M(F,"t",Lt.Hb),W=Lt.M(F,"d",Lt.Hb),$=Lt.M(F,"r",Lt.parseInt);if(null!=H&&(H-=C),!W){G.m('"S" element must have a duration:','ignoring the remaining "S" elements.',F);break}if(H=null!=H?H:O,0>($=$||0))if(B+1<j.length){if(null==($=Lt.M(j[B+1],"t",Lt.Hb))){G.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',F);break}if(H>=$){G.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',F);break}$=Math.ceil(($-H)/W)-1}else{if(1/0==U){G.m('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',F);break}if(H/l>=U){G.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',F);break}$=Math.ceil((U*l-H)/W)-1}for(0<_.length&&H!=O&&(Math.abs((H-O)/l)>=Ne&&G.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",F),_[_.length-1].end=H/l),F=0;F<=$;++F)O=H+W,_.push({start:H/l,end:O/l,Hg:H}),H=O}l=_}return{timescale:s,da:o,ib:R,oa:C/s||0,Pd:C,S:l}}function Tf(i,a,o){return[a(i.A),a(i.aa),a(i.ma)].filter(Ie.Na).map((function(i){return i.getAttribute(o)})).reduce((function(i,a){return i||a}))}function Uf(i,a,o){return[a(i.A),a(i.aa),a(i.ma)].filter(Ie.Na).map((function(i){return Lt.oc(i,o)})).reduce((function(i,a){return i||a}))}function Wf(i,a,o,s,l,C){if(C=void 0===C?0:C,Lt.getAttributeNS(i,"http://www.w3.org/1999/xlink","href")){var R=function Vf(i,a,o,s,l,C){for(var R=Lt.getAttributeNS(i,"http://www.w3.org/1999/xlink","href"),j=Lt.getAttributeNS(i,"http://www.w3.org/1999/xlink","actuate")||"onRequest",U=0;U<i.attributes.length;U++){var _=i.attributes[U];"http://www.w3.org/1999/xlink"==_.namespaceURI&&(i.removeAttributeNS(_.namespaceURI,_.localName),--U)}if(5<=C)return Vb(new D(2,4,4028));if("onLoad"!=j)return Vb(new D(2,4,4027));var O=yb([s],[R]);return l.request(0,mc(O,a)).Y((function(s){if(!(s=Lt.te(s.data,i.tagName)))return Vb(new D(2,4,4001,R));for(;i.childNodes.length;)i.removeChild(i.childNodes[0]);for(;s.childNodes.length;){var j=s.childNodes[0];s.removeChild(j),i.appendChild(j)}for(j=0;j<s.attributes.length;j++){var U=s.attributes[j].nodeName,_=s.getAttribute(U);i.setAttribute(U,_)}return Wf(i,a,o,O[0],l,C+1)}))}(i,a,o,s,l,C);return o&&(R=R.Y(void 0,(function(){return Wf(i,a,o,s,l,C)}))),R}R=[];for(var j=0;j<i.childNodes.length;j++){var U=i.childNodes[j];U instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Lt.getAttributeNS(U,"http://www.w3.org/1999/xlink","href")?(i.removeChild(U),--j):"SegmentTimeline"!=U.tagName&&R.push(Wf(U,a,o,s,l,C)))}return Zb(R).Y((function(){return i}))}function Xf(i,a,o){this.c=i,this.b=a,this.a=o}function V(i,a,o,s,l,C){this.position=i,this.startTime=a,this.endTime=o,this.c=s,this.b=l,this.a=C}function Yf(i,a,o,s){var l,C=(new T).ia("sidx",(function(i){l=function Zf(i,a,o,s){var l=[];s.reader.P(4);var C=s.reader.I();if(0==C)throw G.error("Invalid timescale."),new D(2,3,3005);if(0==s.version)var R=s.reader.I(),j=s.reader.I();else R=s.reader.Kb(),j=s.reader.Kb();s.reader.P(2);var U=s.reader.$b();for(i=i+s.size+j,j=0;j<U;j++){var _=s.reader.I(),O=(2147483648&_)>>>31;_&=2147483647;var B=s.reader.I();if(s.reader.P(4),1==O)throw G.error("Heirarchical SIDXs are not supported."),new D(2,3,3006);l.push(new V(l.length,R/C-a,(R+B)/C-a,(function(){return o}),i,i+_-1)),R+=B,i+=_}return s.parser.stop(),l}(a,s,o,i)}));if(i&&C.parse(i),l)return l;throw G.error('Invalid box type, expected "sidx".'),new D(2,3,3004)}function $f(i){this.a=i}function ag(i,a){for(;i.a.length&&i.a[i.a.length-1].startTime>=a;)i.a.pop();for(;i.a.length&&0>=i.a[0].endTime;)i.a.shift();if(0!=i.a.length){var o=i.a[i.a.length-1];i.a[i.a.length-1]=new V(o.position,o.startTime,a,o.c,o.b,o.a)}}function bg(i){this.b=i,this.a=new S(i,0),_t||(_t=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function dg(i){var a=eg(i);if(7<a.length)throw new D(2,3,3002);for(var o=0,s=0;s<a.length;s++)o=256*o+a[s];a=o,o=eg(i);e:{s=Le.Da;for(var l=0;l<_t.length;l++)if(s(o,_t[l])){s=!0;break e}s=!1}if(s)o=i.b.byteLength-i.a.ga();else{if(8==o.length&&224&o[1])throw new D(2,3,3001);for(s=o[0]&(1<<8-o.length)-1,l=1;l<o.length;l++)s=256*s+o[l];o=s}return o=i.a.ga()+o<=i.b.byteLength?o:i.b.byteLength-i.a.ga(),s=new DataView(i.b.buffer,i.b.byteOffset+i.a.ga(),o),i.a.P(o),new fg(a,s)}function eg(i){var a,o=i.a.na();for(a=1;8>=a&&!(o&1<<8-a);a++);if(8<a)throw new D(2,3,3002);var s=new Uint8Array(a);for(s[0]=o,o=1;o<a;o++)s[o]=i.a.na();return s}function fg(i,a){this.id=i,this.a=a}function gg(i){if(8<i.a.byteLength)throw new D(2,3,3002);if(8==i.a.byteLength&&224&i.a.getUint8(0))throw new D(2,3,3001);for(var a=0,o=0;o<i.a.byteLength;o++){a=256*a+i.a.getUint8(o)}return a}function hg(){}function jg(i){var a=new bg(i.a);if(179!=(i=dg(a)).id)throw G.m("Not a CueTime element."),new D(2,3,3013);if(i=gg(i),183!=(a=dg(a)).id)throw G.m("Not a CueTrackPositions element."),new D(2,3,3012);a=new bg(a.a);for(var o=0;a.ya();){var s=dg(a);if(241==s.id){o=gg(s);break}}return{Ig:i,hg:o}}function kg(i,a){var o=Uf(i,a,"Initialization");if(!o)return null;var s=i.A.ta,l=o.getAttribute("sourceURL");l&&(s=yb(i.A.ta,[l])),l=0;var C=null;return(o=Lt.M(o,"range",Lt.Cc))&&(l=o.start,C=o.end),new Xf((function(){return s}),l,C)}function ng(i,a,o,s,l,C,R,j){var U=i.presentationTimeline,_=!i.tb||!i.W.hd,O=i.W.start,B=i.W.duration,F=a,H=null;return{createSegmentIndex:function(){var i=[F(s,l,C),"webm"==R?F(o.c(),o.b,o.a):null];return F=null,Promise.all(i).then((function(i){var a=i[0];i=i[1]||null,a="mp4"==R?Yf(a,l,s,j):(new hg).parse(a,i,s,j),U.Eb(a,O),H=new $f(a),_&&ag(H,B)}))},findSegmentPosition:function(i){return H.find(i)},getSegmentReference:function(i){return H.get(i)}}}function mg(i){return i.ac}function og(i,a){var o=kg(i,pg),s=function qg(i){return[i.A.Qa,i.aa.Qa,i.ma.Qa].filter(Ie.Na).map((function(i){return Lt.U(i,"SegmentURL")})).reduce((function(i,a){return 0<i.length?i:a})).map((function(a){return a.getAttribute("indexRange")&&!i.he&&(i.he=!0,G.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Kf:a.getAttribute("media"),start:(a=Lt.M(a,"mediaRange",Lt.Cc,{start:0,end:null})).start,end:a.end}}))}(i),l=Sf(i,pg),C=l.ib;0==C&&(G.m("SegmentList@startNumber must be > 0"),C=1);var R=0;if(l.da?R=l.da*(C-1):l.S&&0<l.S.length&&(R=l.S[0].start),!(s={da:l.da,startTime:R,ib:C,oa:l.oa,S:l.S,cb:s}).da&&!s.S&&1<s.cb.length)throw G.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",i.A),new D(2,4,4002);if(!s.da&&!i.W.duration&&!s.S&&1==s.cb.length)throw G.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",i.A),new D(2,4,4002);if(s.S&&0==s.S.length)throw G.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",i.A),new D(2,4,4002);return C=l=null,i.ma.id&&i.A.id&&(l=a[C=i.ma.id+","+i.A.id]),R=function rg(i,a,o,s){var l=s.cb.length;s.S&&s.S.length!=s.cb.length&&(l=Math.min(s.S.length,s.cb.length),G.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",s.cb.length,"to",l));for(var C=[],R=s.startTime,j=0;j<l;j++){var U=s.cb[j],_=yb(o,[U.Kf]),O=void 0;O=null!=s.da?R+s.da:s.S?s.S[j].end:R+i,C.push(new V(j+a,R,O,function(i){return i}.bind(null,_),U.start,U.end)),R=O}return C}(i.W.duration,s.ib,i.A.ta,s),l?(l.md(R),C=i.presentationTimeline.Wb(),l.Tc(C-i.W.start)):(i.presentationTimeline.Eb(R,i.W.start),l=new $f(R),C&&i.tb&&(a[C]=l)),i.tb&&i.W.hd||ag(l,i.W.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:l.find.bind(l),getSegmentReference:l.get.bind(l),initSegmentReference:o,oa:s.oa}}function pg(i){return i.Qa}function sg(i,a,o,s){var l=function tg(i){var a=Tf(i,ug,"initialization");if(!a)return null;var o=i.A.id,s=i.bandwidth||null,l=i.A.ta;return new Xf((function(){var i=Rf(a,o,null,s,null);return yb(l,[i])}),0,null)}(i),C=Sf(i,ug),R=Tf(i,ug,"media"),j=Tf(i,ug,"index");if(R=(C={da:C.da,timescale:C.timescale,ib:C.ib,oa:C.oa,Pd:C.Pd,S:C.S,kd:R,Yb:j}).Yb?1:0,R+=C.S?1:0,0==(R+=C.da?1:0))throw G.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",i.A),new D(2,4,4002);if(1!=R&&(G.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",i.A),C.Yb?(G.info("Using the index URL template by default."),C.S=null):G.info("Using the SegmentTimeline by default."),C.da=null),!C.Yb&&!C.kd)throw G.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",i.A),new D(2,4,4002);if(C.Yb){if("mp4"!=(o=i.A.mimeType.split("/")[1])&&"webm"!=o)throw G.error("SegmentTemplate specifies an unsupported container type.",i.A),new D(2,4,4006);if("webm"==o&&!l)throw G.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",i.A),new D(2,4,4005);s=Rf(C.Yb,i.A.id,null,i.bandwidth||null,null),i=ng(i,a,l,s=yb(i.A.ta,[s]),0,null,o,C.oa)}else C.da?(s||(i.presentationTimeline.od(C.da),i.presentationTimeline.pd(i.W.start)),i=function vg(i,a){var o=i.W.duration,s=a.da,l=a.ib,C=a.timescale,R=a.kd,j=i.bandwidth||null,U=i.A.id,_=i.A.ta;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(i){return 0>i||o&&i>=o?null:Math.floor(i/s)},getSegmentReference:function(i){var a=i*s,O=a+s;return o&&(O=Math.min(O,o)),0>O||o&&a>=o?null:new V(i,a,O,(function(){var o=Rf(R,U,i+l,j,a*C);return yb(_,[o])}),0,null)}}}(i,C)):(R=a=null,i.ma.id&&i.A.id&&(a=o[R=i.ma.id+","+i.A.id]),j=function wg(i,a){for(var o=[],s=0;s<a.S.length;s++){var l=s+a.ib;o.push(new V(l,a.S[s].start,a.S[s].end,function(i,a,o,s,l,C){return yb(s,[i=Rf(i,a,l,o,C)]).map((function(i){return i.toString()}))}.bind(null,a.kd,i.A.id,i.bandwidth||null,i.A.ta,l,a.S[s].Hg+a.Pd),0,null))}return o}(i,C),s=!i.tb||!i.W.hd,a?(s&&ag(new $f(j),i.W.duration),a.md(j),o=i.presentationTimeline.Wb(),a.Tc(o-i.W.start)):(i.presentationTimeline.Eb(j,i.W.start),a=new $f(j),R&&i.tb&&(o[R]=a)),s&&ag(a,i.W.duration),i={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:a.find.bind(a),getSegmentReference:a.get.bind(a)});return{createSegmentIndex:i.createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:l,oa:C.oa}}function ug(i){return i.cc}A("shaka.media.InitSegmentReference",Xf),Xf.prototype.Qc=function(){return this.c()},Xf.prototype.createUris=Xf.prototype.Qc,Xf.prototype.bd=function(){return this.b},Xf.prototype.getStartByte=Xf.prototype.bd,Xf.prototype.ad=function(){return this.a},Xf.prototype.getEndByte=Xf.prototype.ad,A("shaka.media.SegmentReference",V),V.prototype.ga=function(){return this.position},V.prototype.getPosition=V.prototype.ga,V.prototype.sc=function(){return this.startTime},V.prototype.getStartTime=V.prototype.sc,V.prototype.gf=function(){return this.endTime},V.prototype.getEndTime=V.prototype.gf,V.prototype.Qc=function(){return this.c()},V.prototype.createUris=V.prototype.Qc,V.prototype.bd=function(){return this.b},V.prototype.getStartByte=V.prototype.bd,V.prototype.ad=function(){return this.a},V.prototype.getEndByte=V.prototype.ad,A("shaka.media.SegmentIndex",$f),$f.prototype.destroy=function(){return this.a=null,Promise.resolve()},$f.prototype.destroy=$f.prototype.destroy,$f.prototype.find=function(i){for(var a=this.a.length-1;0<=a;--a){var o=this.a[a];if(i>=o.startTime&&i<o.endTime)return o.position}return this.a.length&&i<this.a[0].startTime?this.a[0].position:null},$f.prototype.find=$f.prototype.find,$f.prototype.get=function(i){return 0==this.a.length||0>(i-=this.a[0].position)||i>=this.a.length?null:this.a[i]},$f.prototype.get=$f.prototype.get,$f.prototype.offset=function(i){for(var a=0;a<this.a.length;++a)this.a[a].startTime+=i,this.a[a].endTime+=i},$f.prototype.offset=$f.prototype.offset,$f.prototype.md=function(i){for(var a=[],o=0,s=0;o<this.a.length&&s<i.length;){var l=this.a[o],C=i[s];l.startTime<C.startTime?(a.push(l),o++):(l.startTime>C.startTime?0==o?a.push(C):G.m("Refusing to rewrite original references on update!"):(.1<Math.abs(l.endTime-C.endTime)?a.push(new V(l.position,C.startTime,C.endTime,C.c,C.b,C.a)):a.push(l),o++),s++)}for(;o<this.a.length;)a.push(this.a[o++]);if(a.length)for(o=a[a.length-1].position+1;s<i.length;)l=new V(o++,(l=i[s++]).startTime,l.endTime,l.c,l.b,l.a),a.push(l);else a=i;this.a=a},$f.prototype.merge=$f.prototype.md,$f.prototype.Tc=function(i){for(var a=0;a<this.a.length;++a)if(this.a[a].endTime>i)return void this.a.splice(0,a);this.a=[]},$f.prototype.evict=$f.prototype.Tc,bg.prototype.ya=function(){return this.a.ya()},hg.prototype.parse=function(i,a,o,s){var l;if(440786851!=dg(a=new bg(new DataView(a))).id)throw G.error("Not an EBML element."),new D(2,3,3008);var C=dg(a);if(408125543!=C.id)throw G.error("Not a Segment element."),new D(2,3,3009);for(a=C.a.byteOffset,C=new bg(C.a),l=null;C.ya();){var R=dg(C);if(357149030==R.id){l=R;break}}if(!l)throw G.error("Not an Info element."),new D(2,3,3010);for(C=new bg(l.a),l=1e6,R=null;C.ya();){var j=dg(C);if(2807729==j.id)l=gg(j);else if(17545==j.id)if(4==(R=j).a.byteLength)R=R.a.getFloat32(0);else{if(8!=R.a.byteLength)throw new D(2,3,3003);R=R.a.getFloat64(0)}}if(null==R)throw new D(2,3,3011);if(l=R*(C=l/1e9),475249515!=(i=dg(new bg(new DataView(i)))).id)throw G.error("Not a Cues element."),new D(2,3,3007);return function ig(i,a,o,s,l,C){function h(){return l}var R=[];i=new bg(i.a);for(var j=null,U=null;i.ya();){var _=dg(i);if(187==_.id){var O=jg(_);O&&(_=o*O.Ig,O=a+O.hg,null!=j&&R.push(new V(R.length,j-C,_-C,h,U,O-1)),j=_,U=O)}}return null!=j&&R.push(new V(R.length,j-C,s-C,h,U,null)),R}(i,a,C,l,o,s)};var Kt={Ib:{},Zb:{},zd:function(i,a){Kt.Zb[i]=a}};function X(i,a,o){this.f=i,this.Dc=a,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.o=!0,this.i=0,this.u=void 0===o||o}function xg(i,a,o,s){return i=mc(i,s),0==a&&null==o||(i.headers.Range=o?"bytes="+a+"-"+o:"bytes="+a+"-"),i}function yg(){var i=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.o={},this.u=0,this.w=new cb(5),this.i=new I((function(){!function zg(i){u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return G.info("Updating manifest..."),a=0,Ba(s,2),v(s,Ag(i),4);case 4:a=s.s,Fa(s,3);break;case 2:o=Ga(s),i.b&&(o.severity=1,i.b.onError(o));case 3:if(!i.b)return s.return();Bg(i,a),w(s)}}))}))}(i)})),this.g=new ic}function Ag(i){var a=Date.now(),o=i.b.networkingEngine.request(0,mc(i.f,i.a.retryParameters));return jc(i.g,o),o.promise.then((function(a){if(i.b)return a.uri&&!i.f.includes(a.uri)&&i.f.unshift(a.uri),function Cg(i,a,o){if(!(a=Lt.te(a,"MPD")))throw new D(2,4,4001,o);return a=Wf(a,i.a.retryParameters,i.a.dash.xlinkFailGracefully,o,i.b.networkingEngine),jc(i.g,a),a.promise.then((function(a){return function Dg(i,a,o){return u((function f(){var s,l,C,R,j,U,_,O,B,F,H,W,$,he,ye,Ee,Me,Pe,Re,Le,_e,Oe,Ke,Ye;return x(f,(function(He){switch(He.j){case 1:R=Ie,U=[o],0<(_=(j=Lt).U(a,"Location").map(j.qc).filter(R.Na)).length&&(O=yb(U,_),U=i.f=O),B=j.U(a,"BaseURL").map(j.qc),F=yb(U,B),H=i.a.dash.ignoreMinBufferTime,W=0,H||(W=j.M(a,"minBufferTime",j.Ia)),i.u=j.M(a,"minimumUpdatePeriod",j.Ia,-1),$=j.M(a,"availabilityStartTime",j.ag),he=j.M(a,"timeShiftBufferDepth",j.Ia),ye=j.M(a,"maxSegmentDuration",j.Ia),Ee=a.getAttribute("type")||"static",Me=i.a.dash.ignoreSuggestedPresentationDelay,Pe=null,Me||(Pe=j.M(a,"suggestedPresentationDelay",j.Ia)),i.c?Re=i.c.presentationTimeline:(Le=Math.max(i.a.dash.defaultPresentationDelay,1.5*W),Re=new X($,null!=Pe?Pe:Le,i.a.dash.autoCorrectDrift));for(var Xe={tb:"static"!=Ee,presentationTimeline:Re,ma:null,W:null,aa:null,A:null,bandwidth:0,he:!1},We=F,Qe=Lt.M(a,"mediaPresentationDuration",Lt.Ia),Je=[],et=0,tt=Lt.U(a,"Period"),nt=0;nt<tt.length;nt++){var it=tt[nt];et=Lt.M(it,"start",Lt.Ia,et);var rt=Lt.M(it,"duration",Lt.Ia),at=null;if(nt!=tt.length-1){var ot=Lt.M(tt[nt+1],"start",Lt.Ia);null!=ot&&(at=ot-et)}else null!=Qe&&(at=Qe-et);if(ot=Ne,at&&rt&&Math.abs(at-rt)>ot&&G.m("There is a gap/overlap between Periods",it),null==at&&(at=rt),it=Eg(i,Xe,We,{start:et,duration:at,node:it,hd:null==at||nt==tt.length-1}),Je.push(it),rt=Xe.ma.id,i.l.includes(rt)||(i.l.push(rt),i.c&&(i.b.filterNewPeriod(it),i.c.periods.push(it))),null==at){nt!=tt.length-1&&G.m("Skipping Period",nt+1,"and any subsequent Periods:","Period",nt+1,"does not have a valid start time.",Je[nt+1]),et=null;break}et+=at}if(null==i.c&&i.b.filterAllPeriods(Je),null!=Qe?(et!=Qe&&G.m("@mediaPresentationDuration does not match the total duration of all","Periods."),s=Je,l=Qe,C=!1):(s=Je,l=et,C=!0),_e=l,Oe=s,Re.dc("static"==Ee),"static"!=Ee&&C||Re.Ba(_e||1/0),Re.X()&&!isNaN(i.a.availabilityWindowOverride)&&(he=i.a.availabilityWindowOverride),null==he&&(he=1/0),Re.Jd(he),Re.od(ye||1),i.c){He.C(0);break}if(i.c={presentationTimeline:Re,periods:Oe,offlineSessionIds:[],minBufferTime:W||0},!Re.Ie()){He.C(0);break}return Ke=j.U(a,"UTCTiming"),v(He,function Fg(i,a,o){o=o.map((function(i){return{scheme:i.getAttribute("schemeIdUri"),value:i.getAttribute("value")}}));var s=i.a.dash.clockSyncUri;return!o.length&&s&&o.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:s}),Ie.Ye(o,function(i){var o=i.scheme;switch(i=i.value,o){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Mg(this,a,i,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Mg(this,a,i,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return o=Date.parse(i),isNaN(o)?0:o-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return G.Z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return G.Z("Unrecognized scheme in UTCTiming element",o),Promise.reject()}}.bind(i)).catch((function(){return G.Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0}))}(i,F,Ke),4);case 4:if(Ye=He.s,!i.b)return He.return();Re.De(Ye),w(He)}}))}))}(i,a,o)}))}(i,a.data,a.uri)})).then((function(){var o=(Date.now()-a)/1e3;return db(i.w,1,o),o}))}function Eg(i,a,o,s){if(a.ma=Gg(s.node,null,o),a.W=s,a.ma.id||(G.info("No Period ID given for Period with start time "+s.start+",  Assigning a default"),a.ma.id="__shaka_period_"+s.start),Lt.U(s.node,"EventStream").forEach(i.bg.bind(i,s.start,s.duration)),o=Lt.U(s.node,"AdaptationSet").map(i.$f.bind(i,a)).filter(Ie.Na),a.tb){a=[];for(var l=t(o),C=l.next();!C.done;C=l.next())for(var R=(C=t(C.value.kg)).next();!R.done;R=C.next())a.push(R.value);if(a.length!=new Set(a).size)throw new D(2,4,4018)}var j=o.filter((function(i){return!i.Nd}));if(o.filter((function(i){return i.Nd})).forEach((function(i){var a=i.Nd.split(" ");j.forEach((function(o){a.includes(o.id)&&o.streams.forEach((function(a){a.trickModeVideo=i.streams.find((function(i){return Gc(a.codecs)[0]==Gc(i.codecs)[0]}))}))}))})),a=Hg(j,"video"),l=Hg(j,"audio"),!a.length&&!l.length)throw new D(2,4,4004);for(o=i.a.disableAudio,l.length&&!o||(l=[null]),o=i.a.disableVideo,a.length&&!o||(a=[null]),o=[],C=0;C<l.length;C++)for(R=0;R<a.length;R++)Ig(i,l[C],a[R],o);if(a=[],!i.a.disableText)for(i=Hg(j,"text"),l=0;l<i.length;l++)a.push.apply(a,i[l].streams);return{startTime:s.start,textStreams:a,variants:o}}function Hg(i,a){return i.filter((function(i){return i.contentType==a}))}function Ig(i,a,o,s){if(a||o)if(a&&o){var l=a.drmInfos,C=o.drmInfos;if(!l.length||!C.length||0<yd(l,C).length){C=yd(a.drmInfos,o.drmInfos);for(var R=0;R<a.streams.length;R++)for(var j=0;j<o.streams.length;j++)l=(o.streams[j].bandwidth||0)+(a.streams[R].bandwidth||0),l={id:i.h++,language:a.language,primary:a.jd||o.jd,audio:a.streams[R],video:o.streams[j],bandwidth:l,drmInfos:C,allowedByApplication:!0,allowedByKeySystem:!0},s.push(l)}}else for(C=a||o,R=0;R<C.streams.length;R++)l=C.streams[R].bandwidth||0,l={id:i.h++,language:C.language||"und",primary:C.jd,audio:a?C.streams[R]:null,video:o?C.streams[R]:null,bandwidth:l,drmInfos:C.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},s.push(l)}function Bg(i,a){0>i.u||i.i.R(Math.max(3,i.u-a,eb(i.w)))}function Gg(i,a,o){a=a||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null},o=o||a.ta;var s=Lt.Hb,l=Lt.$e,C=Lt.U(i,"BaseURL").map(Lt.qc),R=i.getAttribute("contentType")||a.contentType,j=i.getAttribute("mimeType")||a.mimeType,U=i.getAttribute("codecs")||a.codecs;l=Lt.M(i,"frameRate",l)||a.frameRate;for(var _=i.getAttribute("sar")||a.pixelAspectRatio,O=Lt.U(i,"InbandEventStream"),B=a.emsgSchemeIdUris.slice(),F=(O=t(O)).next();!F.done;F=O.next())F=F.value.getAttribute("schemeIdUri"),B.includes(F)||B.push(F);return O=function Lg(i){for(var a=0;a<i.length;++a){var o=i[a],s=o.getAttribute("schemeIdUri");if(s&&(o=o.getAttribute("value")))switch(s){case"urn:mpeg:dash:outputChannelPositionList:2012":return o.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var l=parseInt(o,10);if(!l){G.m("Channel parsing failure! Ignoring scheme and value",s,o);continue}return l;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(l=parseInt(o,16))){G.m("Channel parsing failure! Ignoring scheme and value",s,o);continue}for(i=0;l;)1&l&&++i,l>>=1;return i;default:G.m("Unrecognized audio channel scheme:",s,o)}}return null}(O=Lt.U(i,"AudioChannelConfiguration"))||a.qd,F=Lt.M(i,"audioSamplingRate",s)||a.audioSamplingRate,R||(R=Jg(j,U)),{ta:yb(o,C),ac:Lt.oc(i,"SegmentBase")||a.ac,Qa:Lt.oc(i,"SegmentList")||a.Qa,cc:Lt.oc(i,"SegmentTemplate")||a.cc,width:Lt.M(i,"width",s)||a.width,height:Lt.M(i,"height",s)||a.height,contentType:R,mimeType:j,codecs:U,frameRate:l,pixelAspectRatio:_,emsgSchemeIdUris:B,id:i.getAttribute("id"),qd:O,audioSamplingRate:F}}function Mg(i,a,o,s){return(a=mc(a=yb(a,[o]),i.a.retryParameters)).method=s,a=i.b.networkingEngine.request(4,a),jc(i.g,a),a.promise.then((function(i){if("HEAD"==s){if(!i.headers||!i.headers.date)return G.m("UTC timing response is missing","expected date header"),0;i=i.headers.date}else i=Gb(i.data);return i=Date.parse(i),isNaN(i)?(G.m("Unable to parse date from UTC timing response"),0):i-Date.now()}))}function Jg(i,a){return ae(Dc(i,a))?"text":i.split("/")[0]}function Ng(i,a,o,s){this.b=i,this.type=a,this.a=o,this.segments=s||null}function Og(i,a,o,s){this.id=i,this.name=a,this.a=o,this.value=void 0===s?null:s}function Pg(i,a){this.name=i,this.value=a}function Qg(i,a,o){return(i=i.getAttribute(a))?i.value:o||null}function Rg(i,a){this.b=a,this.a=i}A("shaka.media.ManifestParser.registerParserByExtension",Kt.zd),Kt.Lb=function(i,a){Kt.Ib[i]=a},A("shaka.media.ManifestParser.registerParserByMime",Kt.Lb),Kt.eg=function(){var i={};if(Hc()){for(var a in Kt.Ib)i[a]=!0;for(var o in Kt.Zb)i[o]=!0}a={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var s=(o=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!s.done;s=o.next())i[s=s.value]=Hc()?!!Kt.Ib[s]:Ic(s);for(var l in a)i[l]=Hc()?!!Kt.Zb[l]:Ic(a[l]);return i},Kt.create=function(i,a,o,s){return u((function g(){var l,C;return x(g,(function(R){switch(R.j){case 1:return Ba(R,2),v(R,Kt.hf(i,a,o,s),4);case 4:return l=R.s,R.return(new l);case 2:throw(C=Ga(R)).severity=2,C}}))}))},Kt.hf=function(i,a,o,s){return u((function g(){var l,C,R,j,U;return x(g,(function(_){switch(_.j){case 1:if(l=Kt,s){if(C=l.Ib[s.toLowerCase()])return _.return(C);G.m("Could not determine manifest type using MIME type ",s)}if(R=l.getExtension(i)){if(j=l.Zb[R])return _.return(j);G.m("Could not determine manifest type for extension ",R)}else G.m("Could not find extension for ",i);if(s){_.C(2);break}return v(_,l.rf(i,a,o),3);case 3:if(s=_.s){if(U=Kt.Ib[s])return _.return(U);G.m("Could not determine manifest type using MIME type",s)}case 2:throw new D(2,4,4e3,i)}}))}))},Kt.rf=function(i,a,o){return u((function f(){var s,l,C;return x(f,(function(R){switch(R.j){case 1:return(s=mc([i],o)).method="HEAD",v(R,a.request(0,s).promise,2);case 2:return l=R.s,C=l.headers["content-type"],R.return(C?C.toLowerCase().split(";").shift():"")}}))}))},Kt.getExtension=function(i){return 1==(i=new hb(i).la.split("/").pop().split(".")).length?"":i.pop().toLowerCase()},Kt.isSupported=function(i,a){return!!Hc()&&(a in Kt.Ib||Kt.getExtension(i)in Kt.Zb)},A("shaka.media.PresentationTimeline",X),X.prototype.ca=function(){return this.g},X.prototype.getDuration=X.prototype.ca,X.prototype.pf=function(){return this.a},X.prototype.getMaxSegmentDuration=X.prototype.pf,X.prototype.Ba=function(i){this.g=i},X.prototype.setDuration=X.prototype.Ba,X.prototype.xf=function(){return this.f},X.prototype.getPresentationStartTime=X.prototype.xf,X.prototype.De=function(i){this.l=i},X.prototype.setClockOffset=X.prototype.De,X.prototype.dc=function(i){this.o=i},X.prototype.setStatic=X.prototype.dc,X.prototype.Jd=function(i){this.h=i},X.prototype.setSegmentAvailabilityDuration=X.prototype.Jd,X.prototype.sg=function(i){this.Dc=i},X.prototype.setDelay=X.prototype.sg,X.prototype.ff=function(){return this.Dc},X.prototype.getDelay=X.prototype.ff,X.prototype.Eb=function(i,a){if(0!=i.length){var o=i[i.length-1].endTime+a;this.pd(i[0].startTime+a),this.a=i.reduce((function(i,a){return Math.max(i,a.endTime-a.startTime)}),this.a),this.b=Math.max(this.b,o),null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a),G.F("notifySegments:","maxSegmentDuration="+this.a)}},X.prototype.notifySegments=X.prototype.Eb,X.prototype.pd=function(i){this.c=null==this.c?i:Math.min(this.c,i)},X.prototype.notifyMinSegmentStartTime=X.prototype.pd,X.prototype.od=function(i){this.a=Math.max(this.a,i),G.F("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)},X.prototype.notifyMaxSegmentDuration=X.prototype.od,X.prototype.offset=function(i){null!=this.c&&(this.c+=i),null!=this.b&&(this.b+=i)},X.prototype.offset=X.prototype.offset,X.prototype.X=function(){return 1/0==this.g&&!this.o},X.prototype.isLive=X.prototype.X,X.prototype.bb=function(){return 1/0!=this.g&&!this.o},X.prototype.isInProgress=X.prototype.bb,X.prototype.Wb=function(){if(1/0==this.h)return this.i;var i=this.xb()-this.h;return Math.max(this.i,i)},X.prototype.getSegmentAvailabilityStart=X.prototype.Wb,X.prototype.Ee=function(i){this.i=i},X.prototype.setUserSeekStart=X.prototype.Ee,X.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},X.prototype.getSegmentAvailabilityEnd=X.prototype.xb,X.prototype.Vb=function(i){var a=Math.max(this.c,this.i);if(1/0==this.h)return a;var o=this.xb()-this.h;return i=Math.min(o+i,this.Ga()),Math.max(a,i)},X.prototype.getSafeSeekRangeStart=X.prototype.Vb,X.prototype.wb=function(){return this.Vb(0)},X.prototype.getSeekRangeStart=X.prototype.wb,X.prototype.Ga=function(){var i=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-i)},X.prototype.getSeekRangeEnd=X.prototype.Ga,X.prototype.Ie=function(){return!(null==this.f||null!=this.b&&this.u)},X.prototype.usingPresentationStartTime=X.prototype.Ie,A("shaka.dash.DashParser",yg),(s=yg.prototype).configure=function(i){this.a=i},s.start=function(i,a){var o=this;return u((function f(){var s;return x(f,(function(l){switch(l.j){case 1:return o.f=[i],o.b=a,v(l,Ag(o),2);case 2:if(s=l.s,o.b&&Bg(o,s),!o.b)throw new D(2,7,7001);return l.return(o.c)}}))}))},s.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.o={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},s.update=function(){Ag(this).catch(function(i){this.b&&this.b.onError(i)}.bind(this))},s.onExpirationUpdated=function(){},s.$f=function(i,a){if(i.aa=Gg(a,i.ma,null),"image"==i.aa.contentType)return G.m("Skipping Image AdaptationSet",i.aa),null;var o=!1,s=Lt.U(a,"Role"),l=s.map((function(i){return i.getAttribute("value")})).filter(Ie.Na),C=void 0,R="text"==i.aa.contentType;R&&(C="subtitle");for(var j=0;j<s.length;j++){var U=s[j].getAttribute("schemeIdUri");if(null==U||"urn:mpeg:dash:role:2011"==U)switch(U=s[j].getAttribute("value"),U){case"main":o=!0;break;case"caption":case"subtitle":C=U}}var _=null,O=!1;Lt.U(a,"EssentialProperty").forEach((function(i){"http://dashif.org/guidelines/trickmode"==i.getAttribute("schemeIdUri")?_=i.getAttribute("value"):O=!0})),j=Lt.U(a,"Accessibility");var B=new Map;for(s={},U=(j=t(j)).next();!U.done;s={Rb:s.Rb},U=j.next()){var F=U.value;U=F.getAttribute("schemeIdUri"),F=F.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==U||"urn:scte:dash:cc:cea-708:2015"==U?(s.Rb=1,null!=F?F.split(";").forEach(function(i){return function(a){if(a.includes("=")){var o=(a=a.split("="))[0].startsWith("CC")?a[0]:"CC"+a[0];a=a[1].split(",")[0].split(":").pop()}else o="CC"+i.Rb,i.Rb+=2;B.set(o,N(a))}}(s)):B.set("CC1","und")):"urn:mpeg:dash:role:2011"==U&&null!=F&&(l.push(F),"captions"==F&&(C="caption"))}if(O)return null;var H=Jf(s=Lt.U(a,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(s=N(a.getAttribute("lang")||"und"),j=a.getAttribute("label"),(U=Lt.U(a,"Label"))&&U.length&&((U=U[0]).textContent&&(j=U.textContent)),0==(l=(U=Lt.U(a,"Representation")).map(this.cg.bind(this,i,H,C,s,j,o,l,B)).filter((function(i){return!!i}))).length){if(this.a.dash.ignoreEmptyAdaptationSet||R)return null;throw new D(2,4,4003)}return i.aa.contentType&&"application"!=i.aa.contentType||(i.aa.contentType=Jg(l[0].mimeType,l[0].codecs),l.forEach((function(a){a.type=i.aa.contentType}))),l.forEach((function(i){H.drmInfos.forEach((function(a){i.keyId&&a.keyIds.push(i.keyId)}))})),R=U.map((function(i){return i.getAttribute("id")})).filter(Ie.Na),{id:i.aa.id||"__fake__"+this.h++,contentType:i.aa.contentType,language:s,jd:o,streams:l,drmInfos:H.drmInfos,Nd:_,kg:R}},s.cg=function(i,a,o,s,l,C,R,j,U){if(i.A=Gg(U,i.aa,null),!function Kg(i){var a=i.ac?1:0;if(a+=i.Qa?1:0,0==(a+=i.cc?1:0))return"text"==i.contentType||"application"==i.contentType||(G.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',i),!1);return 1!=a&&(G.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",i),i.ac?(G.info("Using SegmentBase by default."),i.Qa=null):G.info("Using SegmentList by default."),i.cc=null),!0}(i.A))return G.m("Skipping Representation",i.A),null;i.bandwidth=Lt.M(U,"bandwidth",Lt.Bc)||0;var _=i.A.contentType;_="text"==_||"application"==_;try{var O=this.lg.bind(this);if(i.A.ac)var B=function lg(i,a){var o=Number(Tf(i,mg,"presentationTimeOffset"))||0,s=Tf(i,mg,"timescale"),l=1;s&&(l=Lt.Bc(s)||1),o=o/l||0,s=kg(i,mg);var C=i.A.contentType;if(l=i.A.mimeType.split("/")[1],"text"!=C&&"mp4"!=l&&"webm"!=l)throw G.error("SegmentBase specifies an unsupported container type.",i.A),new D(2,4,4006);if("webm"==l&&!s)throw G.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",i.A),new D(2,4,4005);C=Uf(i,mg,"RepresentationIndex");var R=Tf(i,mg,"indexRange"),j=i.A.ta;if(R=Lt.Cc(R||""),C){var U=C.getAttribute("sourceURL");U&&(j=yb(i.A.ta,[U])),R=Lt.M(C,"range",Lt.Cc,R)}if(!R)throw G.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",i.A),new D(2,4,4002);return{createSegmentIndex:(l=ng(i,a,s,j,R.start,R.end,l,o)).createSegmentIndex,findSegmentPosition:l.findSegmentPosition,getSegmentReference:l.getSegmentReference,initSegmentReference:s,oa:o}}(i,O);else if(i.A.Qa)B=og(i,this.o);else if(i.A.cc)B=sg(i,O,this.o,!!this.c);else{var F=i.A.ta,H=i.W.duration||0;B={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(i){return 0<=i&&i<H?1:null},getSegmentReference:function(i){return 1!=i?null:new V(1,0,H,(function(){return F}),0,null)},initSegmentReference:null,oa:0}}}catch(i){if(_&&4002==i.code)return null;throw i}return U=function Mf(i,a,o,s){var l=Jf(i,a,s);if(o.be)i=1==o.drmInfos.length&&!o.drmInfos[0].keySystem,a=0==l.drmInfos.length,(0==o.drmInfos.length||i&&!a)&&(o.drmInfos=l.drmInfos),o.be=!1;else if(0<l.drmInfos.length&&(o.drmInfos=o.drmInfos.filter((function(i){return l.drmInfos.some((function(a){return a.keySystem==i.keySystem}))})),0==o.drmInfos.length))throw new D(2,4,4008);return l.Xd||o.Xd}(U=Lt.U(U,"ContentProtection"),this.a.dash.customScheme,a,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:i.A.id,createSegmentIndex:B.createSegmentIndex,findSegmentPosition:B.findSegmentPosition,getSegmentReference:B.getSegmentReference,initSegmentReference:B.initSegmentReference,presentationTimeOffset:B.oa,mimeType:i.A.mimeType,codecs:i.A.codecs,frameRate:i.A.frameRate,pixelAspectRatio:i.A.pixelAspectRatio,bandwidth:i.bandwidth,width:i.A.width,height:i.A.height,kind:o,encrypted:0<a.drmInfos.length,keyId:U,language:s,label:l,type:i.aa.contentType,primary:C,trickModeVideo:null,emsgSchemeIdUris:i.A.emsgSchemeIdUris,roles:R,channelsCount:i.A.qd,audioSamplingRate:i.A.audioSamplingRate,closedCaptions:j}},s.bg=function(i,a,o){var s=Lt.Hb,l=o.getAttribute("schemeIdUri")||"",C=o.getAttribute("value")||"",R=Lt.M(o,"timescale",s)||1;Lt.U(o,"Event").forEach(function(o){var j=Lt.M(o,"presentationTime",s)||0,U=Lt.M(o,"duration",s)||0;U=(j=j/R+i)+U/R,null!=a&&(j=Math.min(j,i+a),U=Math.min(U,i+a)),o={schemeIdUri:l,value:C,startTime:j,endTime:U,id:o.getAttribute("id")||"",eventElement:o},this.b.onTimelineRegionAdded(o)}.bind(this))},s.lg=function(i,a,o){return i=xg(i,a,o,this.a.retryParameters),i=this.b.networkingEngine.request(1,i),jc(this.g,i),i.promise.then((function(i){return i.data}))},Kt.zd("mpd",yg),Kt.Lb("application/dash+xml",yg),Kt.Lb("video/vnd.mpeg.dash.mpd",yg),Og.prototype.toString=function(){var i="#"+this.name,a=this.a?this.a.map((function b(i){return i.name+"="+(isNaN(Number(i.value))?'"'+i.value+'"':i.value)})):[];return this.value&&a.unshift(this.value),0<a.length&&(i+=":"+a.join(",")),i},Og.prototype.getAttribute=function(i){var a=this.a.filter((function(a){return a.name==i}));return a.length?a[0]:null};var Bt={ub:function(i,a){return i.filter((function(i){return i.name==a}))},Ya:function(i,a){var o=Bt.ub(i,a);return o.length?o[0]:null},Xc:function(i,a,o){return i.filter((function(i){var s=i.getAttribute("TYPE");return i=i.getAttribute("GROUP-ID"),s.value==a&&i.value==o}))},Pc:function(i,a){return yb([i],[a])[0]},gd:function(i){return/^#(?!EXT)/m.test(i)}};function Tg(i){this.b=i,this.a=0}function Ug(i){Vg(i,/[ \t]+/gm)}function Vg(i,a){a.lastIndex=i.a;var o=a.exec(i.b);return o=null==o?null:{position:o.index,length:o[0].length,ng:o},i.a==i.b.length||null==o||o.position!=i.a?null:(i.a+=o.length,o.ng)}function Wg(i){return i.a==i.b.length?null:(i=Vg(i,/[^ \t\n]*/gm))?i[0]:null}function Xg(){this.a=0}function Yg(i,a,o){var s=(a=(a=Gb(a)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(s[0]))throw new D(2,4,4015);a=0;for(var l=1;l<s.length;l++)if(!Bt.gd(s[l])){var C=Zg(i,s[l]);if(--i.a,Ft.includes(C.name)){a=1;break}"EXT-X-STREAM-INF"==C.name&&(l+=1)}for(l=[],C=1;C<s.length;)if(Bt.gd(s[C]))C+=1;else{var R=Zg(i,s[C]);if(Yt.includes(R.name)){if(1!=a)throw new D(2,4,4017);return new Ng(o,a,l,i=bh(i,o,s=s.splice(C,s.length-C),l))}l.push(R),C+=1,"EXT-X-STREAM-INF"==R.name&&(R.a.push(new Pg("URI",s[C])),C+=1)}return new Ng(o,a,l)}function bh(i,a,o,s){var l=[],C=[];return o.forEach((function(o){if(/^(#EXT)/.test(o))o=Zg(i,o),Ft.includes(o.name)?s.push(o):C.push(o);else{if(Bt.gd(o))return[];o=Bt.Pc(a,o.trim()),l.push(new Rg(o,C)),C=[]}})),l}function Zg(i,a){var o=i.a++,s=a.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!s)throw new D(2,4,4016,a);var l,C=s[1],R=s[2];if(s=[],R){var j;(j=Vg(R=new Tg(R),/^([^,=]+)(?:,|$)/g))&&(l=j[1]);for(var U=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;j=Vg(R,U);)s.push(new Pg(j[1],j[2]||j[3]))}return new Og(o,C,s,l)}var Ft="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Yt="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function ch(i){try{var a=ch.parse(i);return Xb({uri:i,vd:i,data:a.data,headers:{"content-type":a.contentType}})}catch(i){return Vb(i)}}function dh(){var i=this;this.a=this.f=null,this.ea=1,this.G=new Map,this.V=new Set,this.b=new Map,this.c=null,this.w="",this.u=new Xg,this.T=0,this.h=new I((function(){!function eh(i){u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return G.info("Updating manifest..."),i.f?(Ba(s,2),v(s,i.update(),4)):s.return();case 4:a=i.T,i.h.R(a),Fa(s,0);break;case 2:if(o=Ga(s),!i.f)return s.return();o.severity=1,i.f.onError(o),i.h.R(.1),w(s)}}))}))}(i)})),this.g=zt,this.o=null,this.D=0,this.H=1/0,this.i=new ic,this.K=[],this.l=new Map,this.$=!1}function jh(i,a){return u((function e(){var o,s,l,C,R,j,U,_,O,B;return x(e,(function(F){switch(F.j){case 1:return o=Bt,s=qt,l=a.Qe,v(F,gh(i,mc([l],i.a.retryParameters),0),2);case 2:if(C=F.s,1!=(R=Yg(i.u,C.data,C.uri)).type)throw new D(2,4,4017);return U=(j=o.Ya(R.a,"EXT-X-MEDIA-SEQUENCE"))?Number(j.value):0,_=a.stream,v(F,kh(i,a.Jc,R,U,_.mimeType,_.codecs),3);case 3:O=F.s,a.bc.a=O,B=O[O.length-1],o.Ya(R.a,"EXT-X-ENDLIST")&&(lh(i,s.Va),i.c.Ba(B.endTime)),w(F)}}))}))}function wh(i){i.forEach((function(i){if(i){var a=i.stream.codecs.split(",");a=a.filter((function(i){return"mp4a.40.34"!=i})),i.stream.codecs=a.join(",")}}))}function yh(i,a,o,s,l){return{id:i.ea++,language:a?a.language:"und",primary:!!a&&a.primary||!!o&&o.primary,audio:a,video:o,bandwidth:s,drmInfos:l,allowedByApplication:!0,allowedByKeySystem:!0}}function uh(i,a,o){return u((function f(){var s,l,C,R,j,U,_,O,B,F,H;return x(f,(function(G){switch(G.j){case 1:if(s=oh(a,"URI"),i.b.has(s))return G.return(i.b.get(s));if(l=oh(a,"TYPE").toLowerCase(),C=Pe,"subtitles"==l&&(l=C.va),R=N(Qg(a,"LANGUAGE","und")),j=Qg(a,"NAME"),U=a.getAttribute("DEFAULT"),_="YES"==U,O=Qg(a,"CHANNELS"),"audio"==l)if(O){var W=O.split("/")[0];W=parseInt(W,10)}else W=null;else W=null;return B=W,F=Qg(a,"CHARACTERISTICS"),v(G,zh(i,s,o,l,R,_,j,B,null,F),2);case 2:return H=G.s,i.b.has(s)?G.return(i.b.get(s)):null==H?G.return(null):(i.G.set(a.id,H),i.b.set(s,H),G.return(H))}}))}))}function zh(i,a,o,s,l,C,R,j,U,_){return u((function q(){var O,B,F,H,W,$,he,ye,Ee,Me,Ie,Ne,Re,Le,_e,Oe,Ke,Ye,He,Xe,We,Qe,Je,et,tt,nt,it,rt;return x(q,(function(at){switch(at.j){case 1:return B=(O=Bt).Pc(i.w,a),v(at,gh(i,mc([B],i.a.retryParameters),0),2);case 2:if(F=at.s,B=F.uri,1!=(H=Yg(i.u,F.data,B)).type)throw new D(2,4,4017);W=[],H.segments.forEach((function(i){i=O.ub(i.b,"EXT-X-KEY"),W.push.apply(W,i)})),$=!1,he=[],ye=null;for(var ot=t(W),st=ot.next();!st.done;st=ot.next())if(Ee=st.value,"NONE"!=(Me=oh(Ee,"METHOD"))){if($=!0,"AES-128"==Me)return G.m("Unsupported HLS Encryption",Me),i.$=!0,at.return(null);Ie=oh(Ee,"KEYFORMAT"),(Re=(Ne=Xt[Ie])?Ne(Ee):null)?(Re.keyIds.length&&(ye=Re.keyIds[0]),he.push(Re)):G.m("Unsupported HLS KEYFORMAT",Ie)}if($&&!he.length)throw new D(2,4,4026);return function Bh(i,a){var o=qt,s=Bt.Ya(a.a,"EXT-X-PLAYLIST-TYPE"),l=Bt.Ya(a.a,"EXT-X-ENDLIST");l=s&&"VOD"==s.value||l,s=s&&"EVENT"==s.value&&!l,s=!l&&!s,l?lh(i,o.Va):(lh(i,s?o.Rd:o.Le),o=Gh(a.a,"EXT-X-TARGETDURATION"),o=Number(o.value),i.D=Math.max(o,i.D),i.H=Math.min(o,i.H))}(i,H),Le=function Ch(i,a){if(1==a.length)return a[0];var o=th(i,a);if(null!=o)return o;throw new D(2,4,4025,a)}(s,o),v(at,function Dh(i,a,o,s){return u((function g(){var l,C,R,j,U,_,O,B,F;return x(g,(function(H){switch(H.j){case 1:return l=Pe,C=s.segments[0].a,R=new hb(C),j=R.la.split(".").pop(),U=Gt[a],(_=U[j])?H.return(_):a==l.va?o&&"vtt"!=o&&"wvtt"!=o?H.return("application/mp4"):H.return("text/vtt"):((O=mc([C],i.a.retryParameters)).method="HEAD",v(H,gh(i,O,1),2));case 2:if(B=H.s,!(F=B.headers["content-type"]))throw new D(2,4,4021,j);return H.return(F.split(";")[0])}}))}))}(i,s,Le,H),3);case 3:return _e=at.s,Ht.includes(_e)&&(Le=""),Ke=(Oe=O.Ya(H.a,"EXT-X-MEDIA-SEQUENCE"))?Number(Oe.value):0,Ba(at,4),v(at,kh(i,a,H,Ke,_e,Le),6);case 6:Ye=at.s,Fa(at,5);break;case 4:if(4035==(He=Ga(at)).code)return G.Z("Skipping unsupported HLS stream",_e,a),at.return(null);throw He;case 5:if(Xe=Ye[0].startTime,We=Ye[Ye.length-1].endTime,Qe=We-Xe,Je=new $f(Ye),et=Fh(H),tt=void 0,"text"==s&&(tt="subtitle"),nt=[],_)for(st=(ot=t(_.split(","))).next();!st.done;st=ot.next())it=st.value,nt.push(it);return rt={id:i.ea++,originalId:R,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Je.find.bind(Je),getSegmentReference:Je.get.bind(Je),initSegmentReference:et,presentationTimeOffset:0,mimeType:_e,codecs:Le,kind:tt,encrypted:$,keyId:ye,language:l,label:R,type:s,primary:C,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:nt,channelsCount:j,audioSamplingRate:null,closedCaptions:U},at.return({stream:rt,bc:Je,drmInfos:he,Jc:a,Qe:B,nd:Xe,Qg:We,duration:Qe})}}))}))}function Fh(i){var a=Bt.ub(i.a,"EXT-X-MAP");if(!a.length)return null;if(1<a.length)throw new D(2,4,4020);var o=oh(a=a[0],"URI"),s=Bt.Pc(i.b,o);return i=0,o=null,(a=Qg(a,"BYTERANGE"))&&(i=a.split("@"),a=Number(i[0]),o=(i=Number(i[1]))+a-1),new Xf((function(){return[s]}),i,o)}function Hh(i,a,o,s){var l=a.b,C=a.a;a=Gh(l,"EXTINF").value.split(","),a=s+Number(a[0]);var R=0,j=null;return(l=Bt.Ya(l,"EXT-X-BYTERANGE"))&&(R=l.value.split("@"),l=Number(R[0]),j=(R=R[1]?Number(R[1]):i.a+1)+l-1),new V(o,s,a,(function(){return[C]}),R,j)}function nh(i){i.c&&(i.K.forEach((function(a){i.c.Eb(a,0)})),i.K=[])}function kh(i,a,o,s,l,C){return u((function k(){var R,j,U,_,O,B,F,H,W,$;return x(k,(function(he){switch(he.j){case 1:return R=o.segments,j=[],U=R[0].a,_=Hh(null,R[0],s,0),O=Fh(o),v(he,function Ih(i,a,o,s,l,C){return u((function k(){var R,j,U,_,O,B,F,H,W;return x(k,(function($){switch($.j){case 1:if(i.o){if(R=i.b.get(a),j=R.bc,U=j.get(s.position))return G.F("Found segment start time in previous manifest"),$.return(U.startTime);G.debug("Unable to find segment start time in previous manifest!")}if(G.F("Fetching segment to find start time"),l=l.toLowerCase(),Ht.includes(l))throw G.Z("Raw formats are not yet supported.  Skipping "+l),new D(1,4,4035);if("video/webm"==l)throw G.Z("WebM in HLS is not yet supported.  Skipping."),new D(1,4,4035);if("video/mp4"!=l&&"audio/mp4"!=l){$.C(2);break}return _=[Jh(i,s)],o&&_.push(Jh(i,o)),v($,Promise.all(_),3);case 3:return O=$.s,B=O[0],F=O[1]||O[0],$.return(function Kh(i,a,o,s){var l=0;if((new T).L("moov",Cf).L("trak",Cf).L("mdia",Cf).ia("mdhd",(function(i){i.reader.P(0==i.version?8:16),l=i.reader.I(),i.parser.stop()})).parse(s,!0),!l)throw G.error("Unable to find timescale in init segment!"),new D(2,4,4030,i,a);var C=0,R=!1;if((new T).L("moof",Cf).L("traf",Cf).ia("tfdt",(function(i){C=(0==i.version?i.reader.I():i.reader.Kb())/l,R=!0,i.parser.stop()})).parse(o,!0),!R)throw new D(2,4,4030,i,a);return C}(a,B.uri,B.data,F.data));case 2:if("video/mp2t"!=l){$.C(4);break}return v($,Jh(i,s),5);case 5:return H=$.s,$.return(function Lh(i,a,o){function e(){s.seek(l+188),71!=(C=s.na())&&(s.seek(l+192),C=s.na()),71!=C&&(s.seek(l+204),C=s.na()),71!=C&&f(),s.ze(1)}function f(){throw new D(2,4,4030,i,a)}for(var s=new S(new DataView(o),0),l=0,C=0;;)if(l=s.ga(),71!=(C=s.na())&&f(),8191==(8191&(o=s.$b())))e();else if(16384&o){if(0!=(o=(48&s.na())>>4)&&2!=o||f(),3==o&&(o=s.na(),s.P(o)),1==s.I()>>8)return s.P(3),0!=(o=s.na()>>6)&&1!=o||f(),0==s.na()&&f(),(1073741824*((14&(o=s.na()))>>1)+((65534&s.$b())<<14|(65534&s.$b())>>1))/9e4;e()}else e()}(a,H.uri,H.data));case 4:if("application/mp4"!=l&&!l.startsWith("text/")){$.C(6);break}return v($,Jh(i,s),7);case 7:return W=$.s,$.return(function Mh(i,a,o){return ae(i=Dc(i,a))?(be(a=new Zd(null),i),a.sc(o)):0}(l,C,W.data));case 6:throw new D(2,4,4030,a)}}))}))}(i,a,O,_,l,C),2);case 2:B=he.s,G.debug("First segment",U.split("/").pop(),"starts at",B);for(var ye=0;ye<R.length;++ye)F=R[ye],H=j[j.length-1],W=0==ye?B:H.endTime,$=Hh(H,F,s+ye,W),j.push($);return i.K.push(j),nh(i),he.return(j)}}))}))}function Jh(i,a){return u((function e(){var o,s,l,C,R,j;return x(e,(function(U){switch(U.j){case 1:return o=1,s=xg(a.c(),a.b,a.b+2048-1,i.a.retryParameters),l=xg(a.c(),a.b,a.a,i.a.retryParameters),i.a.hls.useFullSegmentsForStartTime?U.return(gh(i,l,o)):(Ba(U,2),v(U,gh(i,s,o),4));case 4:return C=U.s,U.return(C);case 2:if(7001==(R=Ga(U)).code)throw R;return G.Z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",s.uris[0]),v(U,gh(i,l,o),5);case 5:return j=U.s,U.return(j)}}))}))}function th(i,a){for(var o=Vt[i],s=0;s<o.length;s++)for(var l=0;l<a.length;l++)if(o[s].test(a[l].trim()))return a[l].trim();return"text"==i?"":null}function oh(i,a){var o=i.getAttribute(a);if(!o)throw new D(2,4,4023,a);return o.value}function Gh(i,a){var o=Bt.Ya(i,a);if(!o)throw new D(2,4,4024,a);return o}A("shaka.net.DataUriPlugin",ch),ch.parse=function(a){var o=a.split(":");if(2>o.length||"data"!=o[0])throw G.error("Bad data URI, failed to parse scheme"),new D(2,1,1004,a);if(2>(o=o.slice(1).join(":").split(",")).length)throw G.error("Bad data URI, failed to extract encoding and MIME type"),new D(2,1,1004,a);var s=o[0];a=i.decodeURIComponent(o.slice(1).join(",")),o=s.split(";"),s=o[0];var l=!1;return 1<o.length&&"base64"==o[o.length-1]&&(l=!0,o.pop()),{data:l?Le.Fa(a).buffer:Kb(a),contentType:s}},lc("data",ch),A("shaka.hls.HlsParser",dh),(s=dh.prototype).configure=function(i){this.a=i},s.start=function(i,a){var o=this;return u((function f(){var s,l;return x(f,(function(C){switch(C.j){case 1:return o.f=a,v(C,gh(o,mc([i],o.a.retryParameters),0),2);case 2:return s=C.s,o.w=s.uri,v(C,function hh(i,a){return u((function e(){var o,s,l,C,R,j,U,_,O,B,F;return x(e,(function(H){switch(H.j){case 1:if(0!=(o=Yg(i.u,a,i.w)).type)throw new D(2,4,4022);return v(H,function mh(i,a){return u((function e(){var o,s,l,C,R,j,U,_,O,B,F,H;return x(e,(function(W){switch(W.j){case 1:return o=Bt,s=Ie,l=a.a,C=o.ub(a.a,"EXT-X-MEDIA"),R=C.filter(function(i){return"SUBTITLES"==oh(i,"TYPE")}.bind(i)),j=R.map(function(i){var a=this;return u((function ba(){var o;return x(ba,(function(s){switch(s.j){case 1:return a.a.disableText?s.return(null):(Ba(s,2),v(s,function ph(i,a){return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return oh(a,"TYPE"),v(s,uh(i,a,[]),2);case 2:return o=s.s,s.return(o.stream)}}))}))}(a,i),4));case 4:return s.return(s.s);case 2:if(o=Ga(s),a.a.hls.ignoreTextStreamFailures)return s.return(null);throw o}}))}))}.bind(i)),U=C.filter((function(i){return"CLOSED-CAPTIONS"==oh(i,"TYPE")})),function qh(i,a){for(var o=t(a),s=o.next();!s.done;s=o.next()){oh(s=s.value,"TYPE");var l=Qg(s,"LANGUAGE")||"und";l=N(l);var C=oh(s,"GROUP-ID");s=oh(s,"INSTREAM-ID"),i.l.get(C)||i.l.set(C,new Map),i.l.get(C).set(s,l)}}(i,U),v(W,Promise.all(j),2);case 2:return _=W.s,O=o.ub(l,"EXT-X-STREAM-INF"),B=O.map(function(i){return function rh(i,a,o){return u((function f(){var s,l,C,R,j,U,_,O,B,F,H,W,$,he,ye,Ee,Me,Ie,Ne,Re,Le,_e,Oe,Ke,Ye,He,Xe,We,Qe;return x(f,(function(Je){switch(Je.j){case 1:return s=Pe,l=Bt,C=[],i.a.disableVideo||C.push("avc1.42E01E"),i.a.disableAudio||C.push("mp4a.40.2"),R=C.join(","),j=Qg(a,"CODECS",R),U=function sh(i){for(var a=new Set,o=[],s=(i=t(i)).next();!s.done;s=i.next()){var l=Gc(s=s.value)[0];a.has(l)?G.debug("Ignoring duplicate codec"):(o.push(s),a.add(l))}return o}(j.split(/\s*,\s*/)),_=a.getAttribute("RESOLUTION"),B=O=null,F=Qg(a,"FRAME-RATE"),H=Number(oh(a,"BANDWIDTH")),_&&(W=_.value.split("x"),O=W[0],B=W[1]),$=($=l.ub(o.a,"EXT-X-MEDIA")).filter((function(i){return"CLOSED-CAPTIONS"!=oh(i,"TYPE")})),$=$.filter((function(i){var a=Qg(i,"URI")||"";return"SUBTITLES"==(Qg(i,"TYPE")||"")||""!=a})),he=Qg(a,"AUDIO"),ye=Qg(a,"VIDEO"),he?$=l.Xc($,"AUDIO",he):ye&&($=l.Xc($,"VIDEO",ye)),(Ee=th(s.va,U))&&((Me=Qg(a,"SUBTITLES"))&&((Ie=l.Xc($,"SUBTITLES",Me)).length&&(Ne=i.G.get(Ie[0].id))&&(Ne.stream.codecs=Ee)),fc(U,Ee)),Re=$.map(function(i){return uh(this,i,U)}.bind(i)),Le=[],_e=[],v(Je,Promise.all(Re),2);case 2:if(Ke=(Ke=Je.s).filter((function(i){return null!=i})),he?Le=Ke:ye&&(_e=Ke),G.debug("Guessing stream type for",a.toString()),He=!1,Le.length||_e.length?Le.length?(We=oh(a,"URI"),Qe=Le[0].Jc,We==Qe?(G.debug("Guessing audio-only."),Ye=s.Nb,He=!0):(G.debug("Guessing video."),Ye=s.Ua)):(G.debug("Guessing audio."),Ye=s.Nb):1==U.length?(Xe=th(s.Ua,U),_||F||Xe?(G.debug("Guessing video-only."),Ye=s.Ua):(G.debug("Guessing audio-only."),Ye=s.Nb)):(G.debug("Guessing multiplexed audio+video."),Ye=s.Ua,U=[U.join(",")]),He){Je.C(3);break}return v(Je,function vh(i,a,o,s){return u((function g(){var l,C,R,j,U;return x(g,(function(_){switch(_.j){case 1:return l=Pe,C=oh(a,"URI"),i.b.has(C)?_.return(i.b.get(C)):(R=Qg(a,"CLOSED-CAPTIONS"),j=null,s==l.Ua&&R&&"NONE"!=R&&(j=i.l.get(R)),v(_,zh(i,C,o,s,"und",!1,null,null,j,null),2));case 2:return null==(U=_.s)?_.return(null):i.b.has(C)?_.return(i.b.get(C)):(i.b.set(C,U),_.return(U))}}))}))}(i,a,U,Ye),4);case 4:Oe=Je.s;case 3:if(Oe)Oe.stream.type==s.Nb?Le=[Oe]:_e=[Oe];else if(null===Oe)return G.debug("streamInfo is null"),Je.return([]);return _e&&wh(_e),Le&&wh(Le),Je.return(function xh(i,a,o,s,l,C,R){o.forEach(function(i){(i=i.stream)&&(i.width=Number(l)||void 0,i.height=Number(C)||void 0,i.frameRate=Number(R)||void 0)}.bind(i));var j=!!i.a&&i.a.disableAudio;a.length&&!j||(a=[null]);j=!!i.a&&i.a.disableVideo,(!o.length||j)&&(o=[null]);j=[];for(var U=(a=t(a)).next();!U.done;U=a.next()){U=U.value;for(var _=t(o),O=_.next();!O.done;O=_.next()){var B=O.value;O=U?U.stream:null;var F=B?B.stream:null,H=U?U.drmInfos:null,W=B?B.drmInfos:null;B=(B?B.Jc:"")+" - "+(U?U.Jc:"");var $=void 0;if(O&&F){if(H.length&&W.length&&!(0<yd(H,W).length)){G.m("Incompatible DRM info in HLS variant.  Skipping.");continue}$=yd(H,W)}else O?$=H:F&&($=W);i.V.has(B)?G.debug("Skipping variant which only differs in text streams."):(O=yh(i,O,F,s,$),j.push(O),i.V.add(B))}}return j}(i,Le,_e,H,O,B,F))}}))}))}(this,i,a)}.bind(i)),v(W,Promise.all(B),3);case 3:return F=W.s,H=(H=F.reduce(s.Oc,[])).filter((function(i){return null!=i})),W.return({startTime:0,variants:H,textStreams:_.filter((function(i){return null!=i}))})}}))}))}(i,o),2);case 2:if(s=H.s,!i.f)throw new D(2,7,7001);if(i.$&&0==s.variants.length)throw G.info("No stream is created, because we don't support AES-128","encryption yet"),new D(2,4,4034);i.f.filterAllPeriods([s]),l=1/0,C=0,R=1/0;for(var W=t(i.b.values()),$=W.next();!$.done;$=W.next())j=$.value,l=Math.min(l,j.nd),C=Math.max(C,j.nd),"text"!=j.stream.type&&(R=Math.min(R,j.duration));if(i.g!=qt.Va?(i.c=new X(0,3*i.D),i.c.dc(!1)):(i.c=new X(null,0),i.c.dc(!0)),nh(i),i.g!=qt.Va){for(i.T=i.H,U=qt,i.g==U.Rd&&(_=i.c.Dc,isNaN(i.a.availabilityWindowOverride)||(_=i.a.availabilityWindowOverride),i.c.Jd(_)),O=0;95443.7176888889<=C;)O+=95443.7176888889,C-=95443.7176888889;if(O)for(G.debug("Offsetting live streams by",O,"to compensate for rollover"),$=(W=t(i.b.values())).next();!$.done;$=W.next())95443.7176888889>(B=$.value).nd?(G.F("Offset applied to",B.stream.type),B.stream.presentationTimeOffset=-O,B.bc.offset(O)):G.F("Offset NOT applied to",B.stream.type)}else for(i.c.Ba(R),i.c.offset(-l),$=(W=t(i.b.values())).next();!$.done;$=W.next())(F=$.value).stream.presentationTimeOffset=l,F.bc.offset(-l),ag(F.bc,R);i.o={presentationTimeline:i.c,periods:[s],offlineSessionIds:[],minBufferTime:0},w(H)}}))}))}(o,s.data),3);case 3:return 0<(l=o.T)&&o.h.R(l),C.return(o.o)}}))}))},s.stop=function(){this.h&&(this.h.stop(),this.h=null);var i=[];return this.i&&(i.push(this.i.destroy()),this.i=null),this.a=this.f=null,this.G.clear(),this.V.clear(),this.b.clear(),this.o=null,Promise.all(i)},s.update=function(){if(this.g!=qt.Va){for(var i=[],a=t(this.b.values()),o=a.next();!o.done;o=a.next())i.push(jh(this,o.value));return Promise.all(i)}},s.onExpirationUpdated=function(){};var Vt={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},Ht=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],Gt={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function lh(i,a){i.g=a,i.c&&i.c.dc(i.g==qt.Va),i.g!=qt.Va||i.h.stop()}function gh(i,a,o){if(!i.i)throw new D(2,7,7001);return a=i.f.networkingEngine.request(o,a),jc(i.i,a),a.promise}var Xt={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(i){var a=oh(i,"METHOD");De("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var o=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return o.includes(a)?(a=oh(i,"URI"),a=ch.parse(a),a=zb("com.widevine.alpha",[{initDataType:"cenc",initData:a=new Uint8Array(a.data)}]),(i=Qg(i,"KEYID"))&&(a.keyIds=[i.toLowerCase().substr(2)]),a):(G.error("Widevine in HLS is only supported with [",o.join(", "),"], not",a),null)}},zt="VOD",qt={Va:zt,Le:"EVENT",Rd:"LIVE"};function Ph(){this.a=new Map}function Qh(i,a,o){Rh(i,a).text=o}function Rh(i,a){return i.a.has(a)||i.a.set(a,new Sh),i.a.get(a)}function Sh(){this.text=this.variant=null}function Th(i,a){this.a=i,this.b=new Set([i]);for(var o=t(a=a||[]),s=o.next();!s.done;s=o.next())this.add(s.value)}function Uh(i,a){var o;if(!(o=!!i.audio!=!!a.audio||!!i.video!=!!a.video||i.language!=a.language)&&(o=i.audio&&a.audio)){o=i.audio;var s=a.audio;o=!(o.channelsCount==s.channelsCount&&Vh(o,s)&&Wh(o.roles,s.roles))}return!o&&(o=i.video&&a.video)&&(o=!(Vh(o=i.video,s=a.video)&&Wh(o.roles,s.roles))),!o}function Vh(i,a){if(i.mimeType!=a.mimeType)return!1;var o=i.codecs.split(",").map((function(i){return Gc(i)[0]})),s=a.codecs.split(",").map((function(i){return Gc(i)[0]}));if(o.length!=s.length)return!1;o.sort(),s.sort();for(var l=0;l<o.length;l++)if(o[l]!=s[l])return!1;return!0}function Wh(i,a){var o=new Set(i),s=new Set(a);if(o.delete("main"),s.delete("main"),o.size!=s.size)return!1;for(var l=(o=t(o)).next();!l.done;l=o.next())if(!s.has(l.value))return!1;return!0}function Xh(i){this.a=i,this.b=new Yh(i.language,"",i.audio&&i.audio.channelsCount?i.audio.channelsCount:0,"")}function Yh(i,a,o,s){this.c=i,this.f=a,this.a=o,this.b=void 0===s?"":s}function bi(){this.a=Qt,this.b=(new Map).set(Qt,2).set(Wt,1)}function ei(i,a,o){i.b.set(Qt,o).set(Wt,a)}Kt.zd("m3u8",dh),Kt.Lb("application/x-mpegurl",dh),Kt.Lb("application/vnd.apple.mpegurl",dh),Th.prototype.add=function(i){return Uh(this.a,i)?(this.b.add(i),!0):(G.m("Rejecting variant - not compatible with root."),!1)},Th.prototype.values=function(){return this.b.values()},Xh.prototype.create=function(i){var a=this,o=i.filter((function(i){return Uh(a.a,i)}));return o.length?new Th(o[0],o):this.b.create(i)},Yh.prototype.create=function(i){var a=[];a=function Zh(i,a){var o=Ae(N(a),i.map((function(i){return ze(i)})));return o?i.filter((function(i){return o==ze(i)})):[]}(i,this.c);var o=i.filter((function(i){return i.primary}));for((i=function $h(i,a){return i.filter((function(i){return!!i.audio&&(a?i.audio.roles.includes(a):0==i.audio.roles.length)}))}(a=a.length?a:o.length?o:i,this.f)).length?a=i:G.m("No exact match for variant role could be found."),this.a&&((i=vt.$d(a,this.a)).length?a=i:G.m("No exact match for the channel count could be found.")),this.b&&(i=function ai(i,a){return i.filter((function(i){return!!i.audio&&i.audio.label.toLowerCase()==a.toLowerCase()}))}(a,this.b),i.length?a=i:G.m("No exact match for variant label could be found.")),i=new Th(a[0]),o=(a=t(a)).next();!o.done;o=a.next())o=o.value,Uh(i.a,o)&&i.add(o);return i};var Wt=0,Qt=1;function fi(i,a){this.g=i,this.h=gi(i),this.a=i.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=a,this.c=function(){}}function ii(i){this.a=i}function gi(i){if(i.a.paused||0==i.a.playbackRate||0==i.a.buffered.length)var a=!1;else e:{a=i.a.buffered,i=i.a.currentTime;for(var o=0;o<a.length;o++){var s=a.start(o),l=a.end(o);if(!(i<s-.1||i>l-.5)){a=!0;break e}}a=!1}return a}function ji(i,a,o,s,l){var C=this;this.a=i,this.w=a,this.u=o,this.l=l,this.f=new M,this.i=!1,this.o=i.readyState,this.c=!1,this.b=s,this.h=!1,this.f.B(i,"waiting",(function(){return ki(C)})),this.g=new I((function(){ki(C)})).Ka(.25)}function ki(i){if(0!=i.a.readyState){if(i.a.seeking){if(!i.i)return}else i.i=!1;if(!i.a.paused){var a;if(i.a.readyState!=i.o&&(i.c=!1,i.o=i.a.readyState),!(a=!i.b)){var o=(a=i.b).g,s=gi(o),l=o.a.currentTime,C=Date.now()/1e3;a.a==l&&a.h==s||(a.f=C,a.a=l,a.h=s,a.b=!1),(s=(l=C-a.f)>=a.i&&s&&!a.b)&&(a.c(a.a,l),a.b=!0,a.a=o.a.currentTime),a=!s}if(a){C=i.u.smallGapLimit,a=i.a.currentTime;e:{if((o=i.a.buffered)&&o.length&&!(1==o.length&&1e-6>o.end(0)-o.start(0)))for(s=navigator.userAgent.match(/Edge\//)||Lc("Trident/")||Kc()||Lc("CrKey")?.5:.1,l=0;l<o.length;l++)if(o.start(l)>a&&(0==l||o.end(l-1)-a<=s)){s=l;break e}s=null}if(null!=s&&(0!=s||i.h)){l=o.start(s);var R=i.w.Ga();if(!(l>=R)){C=(R=l-a)<=C;var j=!1;if(!(.001>R)){if(!C&&!i.c){i.c=!0;var U=new K("largegap",{currentTime:a,gapSize:R});U.cancelable=!0,i.l(U),i.u.jumpLargeGaps&&!U.defaultPrevented?j=!0:G.info("Ignoring large gap at",a,"size",R)}(C||j)&&(0==s?G.info("Jumping forward",R,"seconds because of gap before start time of",l):G.info("Jumping forward",R,"seconds because of gap starting at",o.end(s-1),"and ending at",l),i.a.currentTime=l)}}}}}}}function li(i){var a=this;this.c=i,this.a=new Set,this.b=new I((function(){mi(a,!1)})).Ka(.25)}function mi(i,a){for(var o=t(i.a),s=o.next();!s.done;s=o.next())s.value.g(i.c.currentTime,a)}function ni(i){for(var a=[],o=(i=t(i)).next();!o.done;o=i.next())for(var s=(o=t(o.value.variants)).next();!s.done;s=o.next())a.push(s.value);return a}function oi(i,a){for(var o=null,s=t(i),l=s.next();!l.done;l=s.next())a>=(l=l.value).startTime&&(o=l);return o}function pi(i){this.c=i,this.a=null,this.b=function(){}}function ri(i){var a=this;this.a=i,this.f=!1,this.c=this.a.rc(),this.b=new I((function(){a.a.le(.25*a.c)}))}function si(i){i.b.stop();var a=i.f?0:i.c;if(0<=a)try{return void(i.a.rc()!=a&&i.a.Id(a))}catch(i){}i.b.Ka(.25),0!=i.a.rc()&&i.a.Id(0)}function ti(i,a,o,s){a==HTMLMediaElement.HAVE_NOTHING||i.readyState>=a?s():(a=Jt.get(a),o.ua(i,a,s))}fi.prototype.release=function(){this.g=null,this.c=function(){}},ji.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.w=this.l=null},ji.prototype.td=function(){this.h=!0,ki(this)},li.prototype.release=function(){this.b.stop();for(var i=t(this.a),a=i.next();!a.done;a=i.next())a.value.release();this.a.clear()},pi.prototype.release=function(){this.a=this.c=null,this.b=function(){}},pi.prototype.g=function(i){var a=this.a,o=this.c.periods;a!=(i=oi(o,i)||o[0])&&this.b(i),this.a=i},ri.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},ri.prototype.set=function(i){this.c=i,si(this)};var Jt=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function vi(i,a,o){var s=this;this.a=i,this.g=a,this.f=o,this.h=!1,this.b=new M,this.c=new wi(i),ti(this.a,HTMLMediaElement.HAVE_METADATA,this.b,(function(){xi(s,s.f)}))}function yi(i){return i.h?i.a.currentTime:i.f}function zi(i,a){0<i.a.readyState?Ai(i.c,a):ti(i.a,HTMLMediaElement.HAVE_METADATA,i.b,(function(){xi(i,i.f)}))}function xi(i,a){.001>Math.abs(i.a.currentTime-a)?Bi(i):(i.b.ua(i.a,"seeking",(function(){Bi(i)})),Ai(i.c,0==i.a.currentTime?a:i.a.currentTime))}function Bi(i){i.h=!0,i.b.B(i.a,"seeking",(function(){return i.g()}))}function wi(i){var a=this;this.b=i,this.h=10,this.g=this.c=this.f=0,this.a=new I((function(){0>=a.f?(G.m(["Failed to move playhead from",a.c,"to",a.g].join(" ")),a.a.stop()):a.b.currentTime!=a.c?a.a.stop():(a.b.currentTime=a.g,a.f--)}))}function Ai(i,a){i.c=i.b.currentTime,i.g=a,i.f=i.h,i.b.currentTime=a,i.a.Ka(.1)}function Ci(i){var a=this;this.a=i,this.f=!1,this.c=null,this.b=new M,ti(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,(function(){!function c(){null==a.c?a.f=!0:(a.b.ua(a.a,"seeking",(function(){a.f=!0})),a.a.currentTime=Math.max(0,a.a.currentTime+a.c))}()}))}function Di(i,a,o,s,l,C){var R=this;this.c=i,this.a=a.presentationTimeline,this.D=a.minBufferTime||0,this.h=o,this.w=l,this.l=null,this.f=new ji(i,a.presentationTimeline,o,function Ei(i,a){if(!a.stallEnabled)return null;var o=a.stallSkip,s=new fi(new ii(i),a.stallThreshold);return function hi(i,a){i.c=a}(s,(function(a,s){G.debug("Stall detected at "+a+" for "+s+" seconds."),o?(G.debug("Seeking forward "+o+" seconds to break stall."),i.currentTime+=o):(G.debug("Pausing and unpausing to break stall."),i.pause(),i.play())})),s}(i,o),C),this.b=new vi(i,(function(){e:{var i=R.f;i.i=!0,i.h=!1,i.c=!1,i=yi(R.b);var a=Fi(R,i);if(.001<Math.abs(a-i)){var o=Date.now()/1e3;if(!R.l||R.l<o-1){R.l=o,zi(R.b,a),i=void 0;break e}}G.F("Seek to "+i),R.w(),i=void 0}return i}),function Gi(i,a){return null==a?a=1/0>i.a.ca()?i.a.wb():i.a.Ga():0>a&&(a=i.a.Ga()+a),Ii(i,Hi(i,a))}(this,s)),this.i=new I((function(){if(0!=R.c.readyState&&!R.c.paused){var i=yi(R.b),a=R.a.wb(),o=R.a.Ga();3>o-a&&(a=o-3),i<a&&(a=Fi(R,i),G.info("Jumping forward "+(a-i)+" seconds to catch up with the seek range."),R.c.currentTime=a)}})).Ka(.25)}function Ii(i,a){var o=i.a.ca();return a>=o?o-i.h.durationBackoff:a}function Fi(i,a){var o=Ed.bind(null,i.c.buffered),s=Math.max(i.D,i.h.rebufferingGoal),l=i.h.safeSeekOffset,C=i.a.wb(),R=i.a.Ga(),j=i.a.ca();3>R-C&&(C=R-3);var U=i.a.Vb(s),_=i.a.Vb(l);return s=i.a.Vb(s+l),a>=j?(G.F("Playhead past duration."),Ii(i,a)):a>R?(G.F("Playhead past end."),R):a<C?o(_)?(G.F("Playhead before start & start is buffered"),_):(G.F("Playhead before start & start is unbuffered"),s):a>=U||o(a)?(G.F("Playhead in safe region or in buffered region."),a):(G.F("Playhead outside safe region & in unbuffered region."),s)}function Hi(i,a){var o=i.a.wb();return a<o||a>(o=i.a.Ga())?o:a}function Ji(i){var a=this;this.b=function(){},this.a=new Set,this.f=i,this.c=new I((function(){for(var i=a.f(),o=t(a.a),s=o.next();!s.done;s=o.next())(s=s.value).endTime<i.start&&a.a.delete(s)})).Ka(2)}function Li(i){var a=this;this.h=i,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{lb:null,kb:Zt,ab:function(i,o){return a.a(i,o)}},{lb:$t,kb:Zt,ab:function(i,o){return a.a(i,o)}},{lb:an,kb:Zt,ab:function(i,o){return a.a(i,o)}},{lb:Zt,kb:$t,ab:function(i,o){return a.b(i,o)}},{lb:Zt,kb:an,ab:function(i,o){return a.b(i,o)}},{lb:$t,kb:an,ab:function(i,o){return a.c(i,o)}},{lb:an,kb:$t,ab:function(i,o){return a.c(i,o)}}]}vi.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},wi.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},Ci.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},Ci.prototype.o=function(i){this.c=this.f?this.c:i},Ci.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},Ci.prototype.u=function(){},Di.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.c=this.b=this.a=this.h=null,this.w=function(){}},Di.prototype.o=function(i){zi(this.b,i)},Di.prototype.g=function(){var i=yi(this.b);return 0<this.c.readyState&&!this.c.paused?Hi(this,i):i},Di.prototype.u=function(){this.f.td()},Ji.prototype.release=function(){this.b=function(){},this.a.clear(),this.c.stop()},Li.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},Li.prototype.g=function(i,a){for(var o=t(this.h.a),s=o.next();!s.done;s=o.next()){s=s.value;var l=this.f.get(s),C=i<s.startTime?$t:i>s.endTime?an:Zt;this.f.set(s,C);for(var R=t(this.i),j=R.next();!j.done;j=R.next())(j=j.value).lb==l&&j.kb==C&&j.ab(s,a)}};var $t=1,Zt=2,an=3;function Qi(i,a){this.a=a,this.c=i,this.g=null,this.l=1,this.w=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.u=!1,this.H=null,this.G=this.f=this.o=!1,this.D=0}function Vi(i){return Wi(i,"audio")}function Xi(i){return Wi(i,"video")}function Wi(i,a){var o=i.b.get(a);return o?o.Pa||o.stream:null}function Yi(i,a){return u((function e(){var o,s,l,C,R,j,U,_,O;return x(e,(function(B){switch(B.j){case 1:return o=Pe,v(B,se(i.a.O,o.va),2);case 2:return i.D++,i.G=!1,s=i.D,l=i.a.O,C=new Map,R=new Set,C.set(o.va,a),R.add(a),v(B,l.init(C,!1),3);case 3:return i.f?B.return():v(B,Zi(i,R),4);case 4:if(i.f)return B.return();j=i.a.O.g.isTextVisible()||i.g.alwaysStreamText,i.D!=s||i.b.has(o.va)||i.G||!j||(U=i.a.Za(),_=Ti(i,U),O=$i(a,_,0),i.b.set(o.va,O),aj(i,O,0)),w(B)}}))}))}function cj(i,a){var o=i.b.get("video");if(o){var s=o.stream;if(s)if(G.debug("setTrickPlay",a),a){var l=s.trickModeVideo;l&&!o.Pa&&(G.debug("Engaging trick mode stream",l),dj(i,l,!1,0,!1),o.Pa=s)}else(s=o.Pa)&&(G.debug("Restoring non-trick-mode stream",s),o.Pa=null,dj(i,s,!0,0,!1))}}function ej(i,a,o,s){var l=!1;if(a.video){var C=dj(i,a.video,o,s,!1);l=l||C}return a.audio&&(i=dj(i,a.audio,o,s,!1),l=l||i),l}function dj(i,a,o,s,l){var C=i.b.get(a.type);if(!C&&"text"==a.type&&i.g.ignoreTextStreamFailures)return Yi(i,a),!0;if(!C)return!1;var R=fj(i,a),j=Array.from(i.b.values()).every((function(i){return i.ka==C.ka}));return o&&R!=C.ka&&j?(G.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),i.b.forEach((function(a){gj(i,a)})),!0):(C.Pa&&(G.debug("switch during trick play mode",a),a.trickModeVideo?(C.Pa=a,a=a.trickModeVideo,G.debug("switch found trick play stream",a)):(C.Pa=null,G.debug("switch found no special trick play stream"))),!(!(j=i.h[R])||!j.Mb)&&(!(!(j=i.i.get(a.id))||!j.Mb)&&(C.stream!=a||l?("text"==a.type&&je(i.a.O,Dc(a.mimeType,a.codecs)),C.stream=a,C.vc=!0,G.debug("switch: switching to Stream "+hj(C)),function ij(i,a,o){if(!a.fb)return!1;var s=i.a.Za(),l=ne(i.a.O,a.type),C=kj(i,a,s,l,o);return o=C&&C.a?C.a-C.b:null,C&&!o&&(o=(C.endTime-C.sc())*a.stream.bandwidth/8),!isNaN(o)&&((C=a.stream.initSegmentReference)&&(o+=(C.a?C.a-C.b:null)||0),C=i.a.getBandwidthEstimate(),8*o/C<l-s-Math.max(i.c.minBufferTime||0,i.g.rebufferingGoal)||a.fb.b.a>o)}(i,C,R)&&(G.info("Aborting current segment request to switch."),C.fb.abort()),o&&(C.Wa?C.Kc=!0:C.Oa?(C.Sa=!0,C.lc=s,C.Kc=!0):(Ri(C),jj(i,C,!0,s).catch((function(a){i.a&&i.a.onError(a)})))),!0):(G.debug("switch: Stream "+hj(C)+" already active"),!1))))}function gj(i,a){var o=hj(a);a.Wa?G.debug(o,"clear: already clearing the buffer"):a.Sa?G.debug(o,"clear: already waiting"):a.Oa?(G.debug(o,"clear: currently updating"),a.Sa=!0,a.lc=0):null==le(i.a.O,a.type)?(G.debug(o,"clear: nothing buffered"),null==a.La&&aj(i,a,0)):(G.debug(o,"clear: handling right now"),Ri(a),jj(i,a,!1,0).catch((function(a){i.a&&i.a.onError(a)})))}function Ui(i,a,o,s,l){return u((function h(){var C,R,j,U,_,O,B;return x(h,(function(F){switch(F.j){case 1:return C=i.a.Za(),R=Ti(i,C),j=Pe,U=new Map,_=new Set,a&&(U.set(j.Nb,a),_.add(a)),o&&(U.set(j.Ua,o),_.add(o)),s&&(U.set(j.va,s),_.add(s)),O=i.a.O,B=i.g.forceTransmuxTS,v(F,O.init(U,B),2);case 2:return i.f?F.return():(function mj(i){var a=i.c.presentationTimeline.ca();1/0>a?i.a.O.Ba(a):i.a.O.Ba(Math.pow(2,32))}(i),v(F,Zi(i,_),3));case 3:if(i.f)return F.return();U.forEach((function(a,o){if(!i.b.has(o)){var s=$i(a,R,l);i.b.set(o,s),aj(i,s,0)}})),w(F)}}))}))}function $i(i,a,o){return{stream:i,type:i.type,Cb:null,Ha:null,Pa:null,vc:!0,ka:a,endOfStream:!1,Oa:!1,La:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:o||0,fb:null}}function nj(i,a){var o=i.h[a];if(o)return G.debug("(all) Period "+a+" is being or has been set up"),o.promise;G.debug("(all) setting up Period "+a),o={promise:new E,Mb:!1},i.h[a]=o;for(var s=new Set,l=t(i.c.periods[a].variants),C=l.next();!C.done;C=l.next())(C=C.value).video&&s.add(C.video),C.video&&C.video.trickModeVideo&&s.add(C.video.trickModeVideo),C.audio&&s.add(C.audio);for(C=(l=t(i.c.periods[a].textStreams)).next();!C.done;C=l.next())s.add(C.value);return i.w=i.w.then(function(){if(!this.f)return Zi(this,s)}.bind(i)).then(function(){this.f||(this.h[a].promise.resolve(),this.h[a].Mb=!0,G.F("(all) setup Period "+a))}.bind(i)).catch(function(i){this.f||(this.h[a].promise.catch((function(){})),this.h[a].promise.reject(),delete this.h[a],G.m("(all) failed to setup Period "+a),this.a.onError(i))}.bind(i)),o.promise}function Zi(i,a){return u((function e(){var o,s,l,C,R,j,U;return x(e,(function(_){switch(_.j){case 1:o=[];for(var O=t(a),B=O.next();!B.done;B=O.next())s=B.value,(l=i.i.get(s.id))?(G.debug("(all) Stream "+s.id+" is being or has been set up"),o.push(l.promise)):(G.F("(all) setting up Stream "+s.id),i.i.set(s.id,{promise:new E,Mb:!1}),o.push(s.createSegmentIndex()));return Ba(_,2),v(_,Promise.all(o),4);case 4:if(i.f)return _.return();Fa(_,3);break;case 2:if(C=Ga(_),i.f)return _.return();for(B=(_=t(a)).next();!B.done;B=_.next())R=B.value,i.i.get(R.id).promise.catch((function(){})),i.i.get(R.id).promise.reject(),i.i.delete(R.id);throw C;case 3:for(B=(O=t(a)).next();!B.done;B=O.next())j=B.value,(U=i.i.get(j.id)).Mb||(U.promise.resolve(),U.Mb=!0,G.F("(all) setup Stream "+j.id));w(_)}}))}))}function oj(i,a){if(!i.f){var o=hj(a);if(!a.Oa&&null!=a.La&&!a.Wa)if(a.La=null,a.Sa)G.debug(o,"skipping update and clearing the buffer"),jj(i,a,a.Kc,a.lc);else{try{var s=function pj(i,a){if(sj(a))return re(i.a.O,a.stream.originalId||""),null;var o=hj(a),s=i.a.Za(),l=tj(i,a,s);G.J(o,"timeNeeded="+l);var C=fj(i,a.stream),R=Ti(i,l),j=function oe(i,a,o){return"text"==a?null==(i=i.a).b||i.b<o?0:i.b-Math.max(o,i.a):Fd(i=me(i,a),o)}(i.a.O,a.type,s);G.J(o,"update_:","presentationTime="+s,"bufferedAhead="+j);var U=Math.max(i.c.minBufferTime||0,i.g.rebufferingGoal,i.g.bufferingGoal)*i.l;if(l>=i.c.presentationTimeline.ca())return G.debug(o,"buffered to end of presentation"),a.endOfStream=!0,"video"==a.type&&(l=i.b.get("text"))&&"application/cea-608"==l.stream.mimeType&&(l.endOfStream=!0),null;if(a.endOfStream=!1,a.ka=R,R!=C)return G.debug(o,"need Period "+R,"presentationTime="+s,"timeNeeded="+l,"currentPeriodIndex="+C),null;if(j>=U)return G.J(o,"buffering goal met"),.5;if(o=ne(i.a.O,a.type),!(o=kj(i,a,s,o,C)))return 1;var _=1/0;return Array.from(i.b.values()).forEach((function(a){sj(a)||(a=tj(i,a,s),_=Math.min(_,a))})),l>=_+i.c.presentationTimeline.a?1:(a.Bd=0,function uj(i,a,o,s,l){var C=hj(a),R=i.c.periods[s];G.F(C,"fetchAndAppend_:","presentationTime="+o,"currentPeriod.startTime="+R.startTime,"reference.position="+l.position,"reference.startTime="+l.startTime,"reference.endTime="+l.endTime);var j=a.stream,U=i.c.presentationTimeline.ca(),_=i.c.periods[s+1];s=function xj(i,a,o,s,l){if(!a.vc)return Promise.resolve();var C=hj(a);return o=i.c.periods[o].startTime-a.stream.presentationTimeOffset,G.F(C,"setting timestamp offset to "+o),G.F(C,"setting append window start to "+s),G.F(C,"setting append window end to "+l),s=function te(i,a,o,s,l){return"text"==a?(i.a.o=o,(i=i.a).f=s,i.h=l,Promise.resolve()):Promise.all([qe(i,a,i.Pe.bind(i,a)),qe(i,a,i.ug.bind(i,a,o)),qe(i,a,i.rg.bind(i,a,s,l))])}(i.a.O,a.type,o,s,l),a.stream.initSegmentReference?(G.F(C,"fetching init segment"),i=yj(i,a,a.stream.initSegmentReference).then(function(i){if(!this.f)return G.F(C,"appending init segment"),pe(this.a.O,a.type,i,null,null,a.stream.closedCaptions&&0<a.stream.closedCaptions.size)}.bind(i)).catch((function(i){return a.vc=!0,Promise.reject(i)})),Promise.all([s,i])):s}(i,a,s,Math.max(0,R.startTime-.1),_?_.startTime+.01:U),a.Oa=!0,a.vc=!1,G.J(C,"fetching segment"),U=yj(i,a,l),Promise.all([s,U]).then(function(i){if(!this.f&&!this.o)return function zj(i,a,o,s,l,C,R){var j=hj(a),U=l.closedCaptions&&0<l.closedCaptions.size;return null!=l.emsgSchemeIdUris&&0<l.emsgSchemeIdUris.length&&(new T).ia("emsg",i.K.bind(i,s,C,l.emsgSchemeIdUris)).parse(R),function Cj(i,a,o){var s=hj(a);G.J(s,"checking buffer length");var l=Math.max(i.g.bufferBehind,i.c.presentationTimeline.a),C=le(i.a.O,a.type);if(null==C)return G.J(s,"buffer behind okay because nothing buffered:","presentationTime="+o,"bufferBehind="+l),Promise.resolve();var R=o-C,j=R-l;return.01>=j?(G.J(s,"buffer behind okay:","presentationTime="+o,"bufferedBehind="+R,"bufferBehind="+l,"underflow="+Math.abs(j)),Promise.resolve()):(G.F(s,"buffer behind too large:","presentationTime="+o,"bufferedBehind="+R,"bufferBehind="+l,"overflow="+j),i.a.O.remove(a.type,C,C+j).then(function(){this.f||G.F(s,"evicted "+j+" seconds")}.bind(i)))}(i,a,o).then(function(){if(!this.f)return G.F(j,"appending media segment"),pe(this.a.O,a.type,R,C.startTime+s.startTime,C.endTime+s.startTime,U)}.bind(i)).then(function(){if(!this.f)return G.J(j,"appended media segment"),a.Cb=l,a.Ha=C,Promise.resolve()}.bind(i))}(this,a,o,R,j,l,i[1])}.bind(i)).then(function(){this.f||this.o||(a.Oa=!1,a.yd=!1,a.Sa||this.a.td(),aj(this,a,0),function Aj(i,a,o){if(!i.u){var s=hj(a);if(1==(a=Array.from(i.b.values())).length&&"text"==a[0].type||(i.u=a.every((function(i){return"text"==i.type||!i.Sa&&!i.Wa&&i.Ha}))),i.u){for(G.debug(s,"startup complete"),o=fj(i,o),i.h[o]||nj(i,o).then(function(){this.f||(G.F(s,"calling onCanSwitch()..."),this.a.ne())}.bind(i)).catch(Ie.wc),o=0;o<i.c.periods.length;++o)nj(i,o).catch(Ie.wc);i.a.Yf&&(G.F(s,"calling onStartupComplete()..."),i.a.Yf())}}}(this,a,j),G.F(C,"finished fetch and append"))}.bind(i)).catch(function(i){this.f||this.o||(a.Oa=!1,"text"==a.type&&this.g.ignoreTextStreamFailures?(1001==i.code?G.m(C,"Text stream failed to download. Proceeding without it."):G.m(C,"Text stream failed to parse. Proceeding without it."),this.b.delete("text")):7001==i.code?(a.Oa=!1,a.La=null,aj(this,a,0)):3017==i.code?function Bj(i,a,o){var s=hj(a);if(Array.from(i.b.values()).some((function(i){return i!=a&&i.yd})))G.debug(s,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var l=Math.round(100*i.l);if(20<l)i.l-=.2;else{if(!(4<l))return G.error(s,"MediaSource threw QuotaExceededError too many times"),a.Xb=!0,i.o=!0,void i.a.onError(o);i.l-=.04}G.m(s,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*i.l))+"%"),a.yd=!0}aj(i,a,4)}(this,a,i):(G.error(C,"failed fetch and append: code="+i.code),a.Xb=!0,i.severity=2,qj(this,i)))}.bind(i))}(i,a,s,C,o),null)}(i,a);null!=s&&(aj(i,a,s),a.Xb=!1)}catch(a){return void qj(i,a)}s=Array.from(i.b.values()),function rj(i,a){var o=hj(a),s=fj(i,a.stream);if(a.ka!=s){var l=a.ka,C=Array.from(i.b.values());C.every((function(i){return i.ka==l||sj(i)}))?C.every(Dj)?(G.debug(o,"all need Period "+l),nj(i,l).then(function(){if(!this.f)if(C.every(function(i){var a=Dj(i),o=fj(this,i.stream);return!!sj(i)||a&&i.ka==l&&o!=l}.bind(this))){var i=this.c.periods[l];G.F(o,"calling onChooseStreams()...");var a=this.a.oe(i),s=new Map;a.variant&&a.variant.video&&s.set("video",a.variant.video),a.variant&&a.variant.audio&&s.set("audio",a.variant.audio),a.text&&s.set("text",a.text);for(var R=(a=t(this.b.keys())).next();!R.done;R=a.next())if(R=R.value,!s.has(R)&&"text"!=R)return G.error(o,"invalid Streams chosen: missing "+R+" Stream"),void this.a.onError(new D(2,5,5005));for(R=(a=t(Array.from(s.keys()))).next();!R.done;R=a.next())if(R=R.value,!this.b.has(R)){if("text"!=R)return G.error(o,"invalid Streams chosen: unusable "+R+" Stream"),void this.a.onError(new D(2,5,5005));Ui(this,null,null,s.get("text"),i.startTime),s.delete(R)}for(R=(a=t(Array.from(this.b.keys()))).next();!R.done;R=a.next()){R=R.value;var j=this.b.get(R),U=s.get(R);if(U){var _=sj(j);_&&(j.ka=l,j.Bd=i.startTime),dj(this,U,!1,0,!1),_&&sj(j)||aj(this,this.b.get(R),0)}else this.b.delete(R)}G.F(o,"calling onCanSwitch()..."),this.a.ne()}else G.debug(o,"ignoring transition to Period",l,"since another is happening")}.bind(i)).catch(Ie.wc)):G.debug(o,"all MediaStates need Period "+l+", but not all MediaStates are idle"):G.debug(o,"not all MediaStates need Period "+l)}}(i,a),i.u&&s.every((function(i){return i.endOfStream}))&&(G.F(o,"calling endOfStream()..."),i.a.O.endOfStream().then(function(){if(!this.f){var i=this.a.O.ca();0!=i&&i<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(i)}}.bind(i)))}}}function tj(i,a,o){return a.Cb&&a.Ha?(o=fj(i,a.Cb),i.c.periods[o].startTime+a.Ha.endTime):Math.max(o,a.Bd)}function kj(i,a,o,s,l){var C=hj(a);return a.Ha&&a.stream==a.Cb?(s=a.Ha.position+1,G.J(C,"next position known:","position="+s),vj(i,a,l,s)):(a.Ha?(G.F(C,"next position unknown: another Stream buffered"),C=fj(i,a.Cb),C=wj(i,a,i.c.periods[C].startTime+a.Ha.endTime,l)):(G.F(C,"next position unknown: nothing buffered"),C=wj(i,a,s||o,l)),null==C?null:(o=null,null==s&&(o=vj(i,a,l,Math.max(0,C-1))),o||vj(i,a,l,C)))}function wj(i,a,o,s){var l=hj(a);return i=i.c.periods[s],G.debug(l,"looking up segment:","presentationTime="+o,"currentPeriod.startTime="+i.startTime),o=Math.max(0,o-i.startTime),null==(a=a.stream.findSegmentPosition(o))&&G.m(l,"cannot find segment:","currentPeriod.startTime="+i.startTime,"lookupTime="+o),a}function vj(i,a,o,s){var l=hj(a);return o=i.c.periods[o],(a=a.stream.getSegmentReference(s))?(i=(s=i.c.presentationTimeline).Wb(),s=s.xb(),o.startTime+a.endTime<i||o.startTime+a.startTime>s?(G.J(l,"segment is not available:","currentPeriod.startTime="+o.startTime,"reference.startTime="+a.startTime,"reference.endTime="+a.endTime,"availabilityStart="+i,"availabilityEnd="+s),null):a):(G.F(l,"segment does not exist:","currentPeriod.startTime="+o.startTime,"position="+s),null)}function sj(i){return i&&"text"==i.type&&"application/cea-608"==i.stream.mimeType}function Dj(i){return!i.Oa&&null==i.La&&!i.Sa&&!i.Wa}function Ti(i,a){var o=oi(i.c.periods,a+Ne);return o?i.c.periods.indexOf(o):0}function fj(i,a){for(var o=i.c.periods,s=0;s<o.length;s++){for(var l=o[s],C=new Set,R=t(l.variants),j=R.next();!j.done;j=R.next())(j=j.value).audio&&C.add(j.audio),j.video&&C.add(j.video),j.video&&j.video.trickModeVideo&&C.add(j.video.trickModeVideo);for(R=(l=t(l.textStreams)).next();!R.done;R=l.next())C.add(R.value);if(C.has(a))return s}return-1}function yj(i,a,o){var s=xg(o.c(),o.b,o.a,i.g.retryParameters);return G.J("fetching: reference=",o),i=i.a.Db.request(1,s),a.fb=i,i.promise.then((function(i){return a.fb=null,i.data}))}function jj(i,a,o,s){return u((function g(){var l,C,R,j;return x(g,(function(U){switch(U.j){case 1:return l=hj(a),a.Sa=!1,a.Kc=!1,a.lc=0,a.Wa=!0,a.Cb=null,a.Ha=null,G.debug(l,"clearing buffer"),s?(R=i.a.Za(),j=i.a.O.ca(),C=i.a.O.remove(a.type,R+s,j)):C=se(i.a.O,a.type).then(function(){if(!this.f&&o)return this.a.O.flush(a.type)}.bind(i)),v(U,C,2);case 2:if(i.f)return U.return();G.debug(l,"cleared buffer"),a.Wa=!1,a.endOfStream=!1,aj(i,a,0),w(U)}}))}))}function aj(i,a,o){var s=hj(a),l=a.type;"text"!=l||i.b.has(l)?(G.J(s,"updating in "+o+" seconds"),a.La=new Rb((function(){return u((function h(){var o;return x(h,(function(s){switch(s.j){case 1:return Ba(s,2),v(s,oj(i,a),4);case 4:Fa(s,0);break;case 2:o=Ga(s),i.a&&i.a.onError(o),w(s)}}))}))})).R(o)):G.F(s,"Text stream is unloaded. No update is needed.")}function Ri(i){null!=i.La&&(i.La.stop(),i.La=null)}function Si(i){return u((function d(){return x(d,(function(a){if(1===a.j){if(i.fb)return v(a,i.fb.abort(),0);a.C(0)}}))}))}function qj(i,a){Ub(i.H).then(function(){this.f||(this.a.onError(a),a.handled||this.g.failureCallback(a))}.bind(i))}function hj(i){return"("+i.type+":"+i.stream.id+")"}function Ej(i,a,o,s,l,C){if(200<=o&&299>=o&&202!=o)return{uri:l||s,vd:s,data:a,headers:i,fromCache:!!i["x-shaka-from-cache"]};l=null;try{l=Jb(a)}catch(i){}throw G.debug("HTTP error text:",l),new D(401==o||403==o?2:1,1,1001,s,o,l,i,C)}function Fj(i,a,o,s){var l=new Fj.b;Bc(a.headers).forEach((function(i,a){l.append(a,i)}));var C=new Fj.a,R={Ud:!1,He:!1};if(i=new J(i=Fj.l(i,o,{body:a.body||void 0,headers:l,method:a.method,signal:C.signal,credentials:a.allowCrossSiteCredentials?"include":void 0},R,s),(function(){return R.Ud=!0,C.abort(),Promise.resolve()})),a=a.retryParameters.timeout){var j=new I((function(){R.He=!0,C.abort()}));j.R(a/1e3),i.finally((function(){j.stop()}))}return i}function Gj(i,a,o,s){var l=new Gj.f,C=Date.now(),R=0,j=new Promise((function(j,U){for(var _ in l.open(a.method,i,!0),l.responseType="arraybuffer",l.timeout=a.retryParameters.timeout,l.withCredentials=a.allowCrossSiteCredentials,l.onabort=function(){U(new D(1,1,7001,i,o))},l.onload=function(a){for(var s=(a=a.target).getAllResponseHeaders().trim().split("\r\n"),l={},C=(s=t(s)).next();!C.done;C=s.next())l[(C=C.value.split(": "))[0].toLowerCase()]=C.slice(1).join(": ");try{var R=Ej(l,a.response,a.status,i,a.responseURL,o);j(R)}catch(i){U(i)}},l.onerror=function(a){U(new D(1,1,1002,i,a,o))},l.ontimeout=function(){U(new D(1,1,1003,i,o))},l.onprogress=function(i){var a=Date.now();(100<a-C||i.lengthComputable&&i.loaded==i.total)&&(s(a-C,i.loaded-R,i.total-i.loaded),R=i.loaded,C=a)},a.headers)l.setRequestHeader(_.toLowerCase(),a.headers[_]);l.send(a.body)}));return new J(j,(function(){return l.abort(),Promise.resolve()}))}function Hj(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Jj(i,a,o){this.h=i,this.b=new Map,this.c=!1,this.g=a,this.f=o,this.a=new Hj}function Kj(i,a,o,s,l,C){var R=function Ij(i,a){i.b+=a;var o=i.g;return i.g++,i.c.set(o,a),o}(i.a,s);s=i.b.get(a)||Promise.resolve(),i.b.set(a,s.then((function(){return u((function m(){var a,s,j,U,_,O;return x(m,(function(B){switch(B.j){case 1:return v(B,function Lj(i,a){return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return v(s,i.h.request(1,a).promise,2);case 2:return o=s.s,s.return(o.data)}}))}))}(i,o),2);case 2:if(a=B.s,i.c)throw new D(2,9,7001);if(l)for(var F in s=new Uint8Array(a),(j=new Gf(s)).data)U=Number(F),_=j.data[U],O=j.a[U],i.f(_,O);return i.a.close(R,a.byteLength),F=i.a,i.g(0==F.b?0:F.f/F.b,i.a.a),B.return(C(a))}}))}))})))}function Nj(i,a){var o=this;this.c=i,this.b=i.objectStore(a),this.a=new E,i.onabort=function(i){i.preventDefault(),o.a.reject()},i.onerror=function(i){i.preventDefault(),o.a.reject()},i.oncomplete=function(){o.a.resolve()}}function Oj(i,a){return new Promise((function(o,s){var l=i.b.openCursor();l.onerror=s,l.onsuccess=function(i){if(!(i=i.target.result))return o();a(i.key,i.value,i),i.continue()}}))}function Pj(i){this.b=i,this.a=[]}function Qj(i,a){return Rj(i,a,"readwrite")}function Rj(i,a,o){var s=new Nj(o=i.b.transaction([a],o),a);return i.a.push(s),s.promise().then((function(){fc(i.a,s)}),(function(){fc(i.a,s)})),s}function Sj(i,a,o){this.b=new Pj(i),this.c=a,this.a=o}function Tj(i){return Promise.reject(new D(2,9,9011,"Cannot add new value to "+i))}function Uj(i,a,o,s){a=(i=Qj(i.b,a)).store();for(var l={},C=(o=t(o)).next();!C.done;l={key:l.key},C=o.next())l.key=C.value,a.delete(l.key).onsuccess=function(i){return function(){return s(i.key)}}(l);return i.promise()}function Vj(i,a,o){return u((function f(){var s,l,C,R,j,U,_;return x(f,(function(O){switch(O.j){case 1:for(s=Rj(i.b,a,"readonly"),l=s.store(),C={},R=[],j={},U=t(o),_=U.next();!_.done;j={request:j.request,key:j.key},_=U.next())j.key=_.value,j.request=l.get(j.key),j.request.onsuccess=function(i){return function(){null==i.request.result&&R.push(i.key),C[i.key]=i.request.result}}(j);return v(O,s.promise(),2);case 2:if(R.length)throw new D(2,9,9012,"Could not find values for "+R);return O.return(o.map((function(i){return C[i]})))}}))}))}function Wj(i){this.a=new Pj(i)}function Xj(){this.a=new Map}function bk(i,a,o){if(!(i=i.a.get(a)))throw new D(2,9,9013,"Could not find mechanism with name "+a);if(!(a=i.getCells().get(o)))throw new D(2,9,9013,"Could not find cell with name "+o);return a}function ek(i,a){un.set(i,a)}Qi.prototype.destroy=function(){var i=this;return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:a=[];for(var l=t(i.b.values()),C=l.next();!C.done;C=l.next())Ri(o=C.value),a.push(Si(o));return v(s,Promise.all(a),2);case 2:i.b.clear(),i.i.clear(),i.a=null,i.c=null,i.w=null,i.h=null,i.g=null,i.f=!0,w(s)}}))}))},Qi.prototype.configure=function(i){this.g=i,this.H=new Sb({maxAttempts:Math.max(i.retryParameters.maxAttempts,2),baseDelay:i.retryParameters.baseDelay,backoffFactor:i.retryParameters.backoffFactor,fuzzFactor:i.retryParameters.fuzzFactor,timeout:0},!0)},Qi.prototype.start=function(){var i=this;return u((function d(){var a,o,s;return x(d,(function(l){switch(l.j){case 1:return a=i.a.Za(),o=Ti(i,a),(s=i.a.oe(i.c.periods[o])).variant||s.text?v(l,Ui(i,s.variant?s.variant.audio:null,s.variant?s.variant.video:null,s.text,a),2):(G.error("init: no Streams chosen"),l.return(new D(2,5,5005)));case 2:if(i.f)return l.return();G.debug("init: completed initial Stream setup"),i.a&&i.a.Pf&&(G.F("init: calling onInitialStreamsSetup()..."),i.a.Pf()),w(l)}}))}))},Qi.prototype.K=function(i,a,o,s){var l=s.reader.wd(),C=s.reader.wd(),R=s.reader.I(),j=s.reader.I(),U=s.reader.I(),_=s.reader.I();s=s.reader.gb(s.reader.N.byteLength-s.reader.ga()),i=i.startTime+a.startTime+j/R,o.includes(l)&&("urn:mpeg:dash:event:2012"==l?this.a.Qf():this.a.onEvent(new K("emsg",{detail:{startTime:i,endTime:i+U/R,schemeIdUri:l,value:C,timescale:R,presentationTimeDelta:j,eventDuration:U,id:_,messageData:s}})))},A("shaka.net.HttpFetchPlugin",Fj),Fj.l=function(i,a,o,s,l){return u((function h(){var C,R,j,U,_,O,B,F,H,W,$,he,ye;return x(h,(function(Ee){switch(Ee.j){case 1:return C=Fj.g,R=Fj.c,O=_=0,B=Date.now(),Ba(Ee,2),v(Ee,C(i,o),4);case 4:return j=Ee.s,F=j.clone().body.getReader(),W=(H=j.headers.get("Content-Length"))?parseInt(H,10):0,$=function(i){!function c(){return u((function ea(){var a,o,s;return x(ea,(function(C){switch(C.j){case 1:return Ba(C,2),v(C,F.read(),4);case 4:a=C.s,Fa(C,3);break;case 2:return o=Ga(C),G.F("error reading from stream",o.message),C.return();case 3:a.done||(_+=a.value.byteLength),(100<(s=Date.now())-B||a.done)&&(l(s-B,_-O,W-_),O=_,B=s),a.done?i.close():(i.enqueue(a.value),c()),w(C)}}))}))}()},new R({start:$}),v(Ee,j.arrayBuffer(),5);case 5:U=Ee.s,Fa(Ee,3);break;case 2:if(he=Ga(Ee),s.Ud)throw new D(1,1,7001,i,a);if(s.He)throw new D(1,1,1003,i,a);throw new D(1,1,1002,i,he,a);case 3:return ye={},j.headers.forEach((function(i,a){ye[a.trim()]=i})),Ee.return(Ej(ye,U,j.status,i,j.url,a))}}))}))},Fj.isSupported=function(){if(!i.ReadableStream)return!1;try{new ReadableStream({})}catch(i){return!1}return!(!i.fetch||!i.AbortController)},Fj.isSupported=Fj.isSupported,Fj.g=i.fetch,Fj.a=i.AbortController,Fj.c=i.ReadableStream,Fj.b=i.Headers,Fj.isSupported()&&(lc("http",Fj,2),lc("https",Fj,2)),A("shaka.net.HttpXHRPlugin",Gj),Gj.f=i.XMLHttpRequest,lc("http",Gj,1),lc("https",Gj,1),Hj.prototype.close=function(i,a){if(this.c.has(i)){var o=this.c.get(i);this.c.delete(i),this.f+=o,this.a+=a}},Jj.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then((function(){}),(function(){}))},Nj.prototype.abort=function(){try{this.c.abort()}catch(i){}return this.a.catch((function(){}))},Nj.prototype.store=function(){return this.b},Nj.prototype.promise=function(){return this.a},Pj.prototype.destroy=function(){return Promise.all(this.a.map((function(i){return i.abort()})))},(s=Sj.prototype).destroy=function(){return this.b.destroy()},s.hasFixedKeySpace=function(){return!0},s.addSegments=function(){return Tj(this.c)},s.removeSegments=function(i,a){return Uj(this,this.c,i,a)},s.getSegments=function(i){var a=this;return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return v(s,Vj(a,a.c,i),2);case 2:return o=s.s,s.return(o.map((function(i){return a.Wd(i)})))}}))}))},s.addManifests=function(){return Tj(this.a)},s.updateManifestExpiration=function(i,a){var o=Qj(this.b,this.a),s=o.store();return s.get(i).onsuccess=function(o){(o=o.target.result)&&(o.expiration=a,s.put(o,i))},o.promise()},s.removeManifests=function(i,a){return Uj(this,this.a,i,a)},s.getManifests=function(i){var a=this;return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return v(s,Vj(a,a.a,i),2);case 2:return o=s.s,s.return(o.map((function(i){return a.mc(i)})))}}))}))},s.getAllManifests=function(){var i=this;return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return a=Rj(i.b,i.a,"readonly"),o=new Map,v(s,Oj(a,(function(a,s){o.set(a,i.mc(s))})),2);case 2:return v(s,a.promise(),3);case 3:return s.return(o)}}))}))},s.Wd=function(i){return i},s.mc=function(i){return i},s.add=function(i,a){var o=this;return u((function f(){var s,l,C,R;return x(f,(function(j){switch(j.j){case 1:s=Qj(o.b,i),l=s.store(),C=[];for(var U=t(a),_=U.next();!_.done;_=U.next())R=_.value,l.add(R).onsuccess=function(i){C.push(i.target.result)};return v(j,s.promise(),2);case 2:return j.return(C)}}))}))},Wj.prototype.destroy=function(){return this.a.destroy()},Wj.prototype.getAll=function(){var i=this;return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return a=Rj(i.a,"session-ids","readonly"),o=[],v(s,Oj(a,(function(i,a){o.push(a)})),2);case 2:return v(s,a.promise(),3);case 3:return s.return(o)}}))}))},Wj.prototype.add=function(i){for(var a=Qj(this.a,"session-ids"),o=a.store(),s=(i=t(i)).next();!s.done;s=i.next())o.add(s.value);return a.promise()},Wj.prototype.remove=function(i){var a=this;return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return v(s,Oj(o=Qj(a.a,"session-ids"),(function(a,o,s){0<=i.indexOf(o.sessionId)&&s.delete()})),2);case 2:return v(s,o.promise(),0)}}))}))},Xj.prototype.destroy=function(){for(var i=[],a=t(this.a.values()),o=a.next();!o.done;o=a.next())i.push(o.value.destroy());return this.a.clear(),Promise.all(i)},Xj.prototype.init=function(){var i=this;un.forEach((function(a,o){var s=a();s?i.a.set(o,s):G.info("Skipping "+o+" as it is not supported on this platform")}));for(var a=[],o=t(this.a.values()),s=o.next();!s.done;s=o.next())a.push(s.value.init());return Promise.all(a)},Xj.prototype.erase=function(){var i=this;return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return a=Array.from(i.a.values()),(o=0<a.length)||un.forEach((function(i){(i=i())&&a.push(i)})),v(s,Promise.all(a.map((function(i){return i.erase()}))),2);case 2:if(!o)return v(s,Promise.all(a.map((function(i){return i.destroy()}))),0);s.C(0)}}))}))},A("shaka.offline.StorageMuxer.register",ek),A("shaka.offline.StorageMuxer.unregister",(function(i){un.delete(i)}));var un=new Map;function fk(i){Sj.apply(this,arguments)}function gk(i){return function hk(i){var a=i.streams.filter((function(i){return"audio"==i.contentType})),o=i.streams.filter((function(i){return"video"==i.contentType}));if(!a.every((function(i){return i.variantIds}))||!o.every((function(i){return i.variantIds}))){a.forEach((function(i){i.variantIds=[]})),o.forEach((function(i){i.variantIds=[]}));var s=0;if(o.length&&!a.length){G.debug("Found video-only content. Creating variants for video.");var l=s++;o.forEach((function(i){i.variantIds.push(l)}))}if(!o.length&&a.length){G.debug("Found audio-only content. Creating variants for audio.");var C=s++;a.forEach((function(i){i.variantIds.push(C)}))}o.length&&a.length&&(G.debug("Found audio-video content. Creating variants."),a.forEach((function(i){o.forEach((function(a){var o=s++;i.variantIds.push(o),a.variantIds.push(o)}))})))}}(i),i.streams.forEach((function(){})),{startTime:i.startTime,streams:i.streams.map(ik)}}function ik(i){var a=i.initSegmentUri?jk(i.initSegmentUri):null;return{id:i.id,originalId:null,primary:i.primary,presentationTimeOffset:i.presentationTimeOffset,contentType:i.contentType,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:void 0,kind:i.kind,language:i.language,label:i.label,width:i.width,height:i.height,initSegmentKey:a,encrypted:i.encrypted,keyId:i.keyId,segments:i.segments.map(kk),variantIds:i.variantIds}}function kk(i){var a=jk(i.uri);return{startTime:i.startTime,endTime:i.endTime,dataKey:a}}function jk(i){var a;if((a=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(i))||(a=/^offline:segment\/([0-9]+)$/.exec(i)))return Number(a[1]);throw new D(2,9,9004,"Could not parse uri "+i)}function lk(i,a,o,s){Sj.call(this,i,a,o),this.f=s}function mk(){this.g=this.c=this.b=this.a=this.f=null}function ok(i,a,o,s){this.a=i,this.g=a,this.f=o,this.c=s,this.b=["offline:",i,"/",a,"/",o,"/",s].join("")}function pk(i){if(null==(i=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(i)))return null;var a=i[1];if("manifest"!=a&&"segment"!=a)return null;var o=i[2];if(!o)return null;var s=i[3];return s&&null!=a?new ok(a,o,s,Number(i[4])):null}function qk(i,a){this.b=i,this.a=a}function sk(i,a,o){var s=a.streams.filter((function(i){return"audio"==i.contentType})),l=a.streams.filter((function(i){return"video"==i.contentType}));return s=function tk(i,a,o){for(var s=new Set,l=t(a),C=l.next();!C.done;C=l.next()){var R=t(C.value.variantIds);for(C=R.next();!C.done;C=R.next())s.add(C.value)}for(l=t(o),C=l.next();!C.done;C=l.next())for(R=t(C.value.variantIds),C=R.next();!C.done;C=R.next())s.add(C.value);for(l=new Map,s=t(s),C=s.next();!C.done;C=s.next())C=C.value,l.set(C,{id:C,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(a=t(a),s=a.next();!s.done;s=a.next())for(s=s.value,C=uk(i,s),R=t(s.variantIds),s=R.next();!s.done;s=R.next())(s=l.get(s.value)).language=C.language,s.primary=s.primary||C.primary,s.audio=C;for(o=t(o),a=o.next();!a.done;a=o.next())for(s=a.value,a=uk(i,s),C=t(s.variantIds),s=C.next();!s.done;s=C.next())(s=l.get(s.value)).primary=s.primary||a.primary,s.video=a;return l}(i,s,l),l=a.streams.filter((function(i){return"text"==i.contentType})).map((function(a){return uk(i,a)})),a.streams.forEach((function(s){s=s.segments.map((function(a,o){return vk(i,o,a)})),o.Eb(s,a.startTime)})),{startTime:a.startTime,variants:Array.from(s.values()),textStreams:l}}function uk(i,a){var o=a.segments.map((function(a,o){return vk(i,o,a)})),s=new $f(o);return o={id:a.id,originalId:a.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(i){return s.find(i)},getSegmentReference:function(i){return s.get(i)},initSegmentReference:null,presentationTimeOffset:a.presentationTimeOffset,mimeType:a.mimeType,codecs:a.codecs,width:a.width||void 0,height:a.height||void 0,frameRate:a.frameRate||void 0,pixelAspectRatio:a.pixelAspectRatio||void 0,kind:a.kind,encrypted:a.encrypted,keyId:a.keyId,language:a.language,label:a.label||null,type:a.contentType,primary:a.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=a.initSegmentKey&&(o.initSegmentReference=function wk(i,a){var o=new ok("segment",i.b,i.a,a);return new Xf((function(){return[o.toString()]}),0,null)}(i,a.initSegmentKey)),o}function vk(i,a,o){var s=new ok("segment",i.b,i.a,o.dataKey);return new V(a,o.startTime,o.endTime,(function(){return[s.toString()]}),0,null)}function xk(){this.a=null}function yk(i){var a=pk(i);return a&&"manifest"==a.a?yk.h(i):a&&"segment"==a.a?yk.i(a.key(),a):Vb(new D(2,1,9004,i))}function zk(i,a,o){return u((function f(){var s,l,C,R,j,U;return x(f,(function(_){switch(_.j){case 1:s=[];for(var O=[],B=t(o),F=B.next();!F.done;F=B.next()){F=F.value;for(var H=!1,W=t(O),$=W.next();!$.done;$=W.next())if(Ak(($=$.value).info,F)){$.sessionIds.push(F.sessionId),H=!0;break}H||O.push({info:F,sessionIds:[F.sessionId]})}l=t(O),C=l.next();case 2:if(C.done){_.C(4);break}return R=C.value,j=function Bk(i,a,o){return u((function f(){var s,l,C,R;return x(f,(function(j){switch(j.j){case 1:return s=new Qc({Db:a,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Ba(j,2),s.configure(i),v(j,function Yc(i,a,o,s,l,C){var R=new Map;return R.set(a,{audioCapabilities:l,videoCapabilities:C,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:a,drmInfos:[{keySystem:a,licenseServerUri:o,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:s,initData:null,keyIds:null}]}),Zc(i,R)}(s,o.info.keySystem,o.info.licenseUri,o.info.serverCertificate,o.info.audioCapabilities,o.info.videoCapabilities),4);case 4:Fa(j,3);break;case 2:return l=Ga(j),G.m("Error initializing EME",l),v(j,s.destroy(),5);case 5:case 9:return j.return([]);case 3:return Ba(j,6),v(j,ed(s),8);case 8:Fa(j,7);break;case 6:return C=Ga(j),G.m("Error setting server certificate",C),v(j,s.destroy(),9);case 7:return R=[],v(j,Promise.all(o.sessionIds.map((function(i){return u((function r(){var a;return x(r,(function(o){switch(o.j){case 1:return Ba(o,2),v(o,function hd(i,a){return u((function e(){var o,s,l;return x(e,(function(C){switch(C.j){case 1:return v(C,id(i,a),2);case 2:return(o=C.s)?(s=[],(l=i.b.get(o))&&(l.Ca=new E,s.push(l.Ca)),G.J("Attempting to remove session",a),s.push(o.remove()),v(C,Promise.all(s),0)):(G.J("Ignoring attempt to remove missing session",a),C.return())}}))}))}(s,i),4);case 4:R.push(i),Fa(o,0);break;case 2:a=Ga(o),G.m("Error deleting offline session",a),w(o)}}))}))}))),10);case 10:return v(j,s.destroy(),11);case 11:return j.return(R)}}))}))}(i,a,R),v(_,j,5);case 5:U=_.s,s=s.concat(U),C=l.next(),_.C(2);break;case 4:return _.return(s)}}))}))}function Ak(i,a){function d(i,a){return i.robustness==a.robustness&&i.contentType==a.contentType}return i.keySystem==a.keySystem&&i.licenseUri==a.licenseUri&&hc(i.audioCapabilities,a.audioCapabilities,d)&&hc(i.videoCapabilities,a.videoCapabilities,d)}function Ck(i,a){var o=Dk(),s=this;this.h=a,this.c=i,this.f=o,this.i=null,this.g=[],this.b=this.a=null,this.l=!0,this.o=Promise.resolve().then((function(){return function Ek(i){return u((function d(){return x(d,(function(a){if(1===a.j){if(i.l){if(0==i.g.length||i.a&&!i.a.$a)var o=!1;else{i.a&&(i.a.za.eb(),i.a=null);var s=(o=i.g.shift()).create(i.f);s?(o.za.Fb(),i.a={node:s.node,payload:s.payload,$a:s.$a,za:o.za}):o.za.zc(),o=!0}return o?o=Promise.resolve():i.a?o=function Hk(i){return u((function d(){var a,o;return x(d,(function(s){switch(s.j){case 1:return i.c=i.h.sf(i.c,i.f,i.a.node,i.a.payload),Ba(s,2),i.b=i.h.Ze(i.c,i.f,i.a.payload),v(s,i.b.promise,4);case 4:i.b=null,i.c==i.a.node&&(i.a.za.xc(),i.a=null),Fa(s,0);break;case 2:return 7001==(a=Ga(s)).code?i.a.za.eb():i.a.za.onError(a),i.a=null,i.b=null,o=i,v(s,i.h.handleError(i.f,a),5);case 5:o.c=s.s,w(s)}}))}))}(i):(i.h.Of(i.c),i.i=new E,o=i.i),v(a,o,1)}a.C(0)}}))}))}(s)}))}function Gk(i,a){var o={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Sg:function(){}};return i.g.push({create:a,za:o}),i.b&&i.b.abort(),Fk(i),o}function Fk(i){i.i&&(i.i.resolve(),i.i=null)}function Ik(i){this.a=null;for(var a=0;a<i.textTracks.length;++a){var o=i.textTracks[a];o.mode="disabled","Shaka Player TextTrack"==o.label&&(this.a=o)}this.a||(this.a=i.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function Kk(i){if(i.startTime>=i.endTime)return G.m("Invalid cue times: "+i.startTime+" - "+i.endTime),null;var a=new VTTCue(i.startTime,i.endTime,i.payload);a.lineAlign=i.lineAlign,a.positionAlign=i.positionAlign,i.size&&(a.size=i.size);try{a.align=i.textAlign}catch(i){}return"center"==i.textAlign&&"center"!=a.align&&(a.align="middle"),"vertical-lr"==i.writingMode?a.vertical="lr":"vertical-rl"==i.writingMode&&(a.vertical="rl"),1==i.lineInterpretation&&(a.snapToLines=!1),null!=i.line&&(a.line=i.line),null!=i.position&&(a.position=i.position),a}function Jk(i,a){var o=i.mode;i.mode="showing"==o?"showing":"hidden";for(var s=i.cues,l=s.length-1;0<=l;l--){var C=s[l];C&&a(C)&&i.removeCue(C)}i.mode=o}function Lk(i,a,o,s,l){var C,R=l in s,j=!0;for(C in a){var U=l+"."+C,_=R?s[l]:o[C];R||C in o?void 0===a[C]?void 0===_||R?delete i[C]:i[C]=cc(_):_.constructor==Object&&a[C]&&a[C].constructor==Object?(i[C]||(i[C]=cc(_)),U=Lk(i[C],a[C],_,s,U),j=j&&U):typeof a[C]!=typeof _||null==a[C]||"function"!=typeof a[C]&&a[C].constructor!=_.constructor?(G.jc("Invalid config, wrong type for "+U),j=!1):("function"==typeof o[C]&&o[C].length!=a[C].length&&G.Z("Unexpected number of arguments for "+U),i[C]=a[C]):(G.jc("Invalid config, unrecognized key "+U),j=!1)}return j}function Mk(i,a){for(var o={},s=o,l=0,C=0;!(0>(l=i.indexOf(".",l)));)0!=l&&"\\"==i[l-1]||(s[C=i.substring(C,l).replace(/\\\./g,".")]={},s=s[C],C=l+1),l+=1;return s[i.substring(C).replace(/\\\./g,".")]=a,o}function Nk(){}function Ok(){var i=5e5,a=1/0;navigator.connection&&(navigator.connection.downlink&&(i=1e6*navigator.connection.downlink),navigator.connection.saveData&&(a=360));var o={retryParameters:Tb(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:qd,fairPlayTransform:!0,updateExpirationTime:1},s={retryParameters:Tb(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(i){if(i)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},l={retryParameters:Tb(),failureCallback:function(i){return G.error("Unhandled streaming error",i),[i]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(Lc("Web0S")||Kc()||Lc("CrKey"))&&(l.stallSkip=0);var C={trackSelectionCallback:function(i){return u((function n(){return x(n,(function(a){if(1===a.j)return a.return(i)}))}))},progressCallback:function(i,a){return[i,a]},usePersistentLicense:!0},R={drm:o,manifest:s,streaming:l,offline:C,abrFactory:P,abr:{enabled:!0,defaultBandwidthEstimate:i,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:a,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return C.trackSelectionCallback=function(i){return u((function n(){return x(n,(function(a){if(1===a.j)return a.return(function Pk(i,a){var o=i.filter((function(i){return"variant"==i.type})),s=[],l=Ae(a,o.map((function(i){return i.language})));l&&(s=o.filter((function(i){return N(i.language)==l}))),0==s.length&&(s=o.filter((function(i){return i.primary}))),0==s.length&&(1<new Set(o.map((function(i){return i.language}))).size&&G.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),s=o);var C=s.filter((function(i){return i.height&&480>=i.height}));if(C.length&&(C.sort((function(i,a){return a.height-i.height})),s=C.filter((function(i){return i.height==C[0].height}))),o=[],s.length){var R=Math.floor(s.length/2);s.sort((function(i,a){return i.bandwidth-a.bandwidth})),o.push(s[R])}for(s=t(i),R=s.next();!R.done;R=s.next())"text"==(R=R.value).type&&o.push(R);return o}(i,R.preferredAudioLanguage))}))}))},R}function Qk(i,a,o){var s={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Lk(i,a,o||Ok(),s,"")}function Rk(){this.a=null,this.b=[]}function Sk(i,a){if(null==i.a)i.a={timestamp:Date.now()/1e3,state:a,duration:0};else{var o=Date.now()/1e3;i.a.duration=o-i.a.timestamp,i.a.state!=a&&(i.b.push(i.a),i.a={timestamp:o,state:a,duration:0})}}function Tk(i,a){var o=0;i.a&&i.a.state==a&&(o+=i.a.duration);for(var s=t(i.b),l=s.next();!l.done;l=s.next())o+=(l=l.value).state==a?l.duration:0;return o}function Vk(){this.b=this.c=null,this.a=[]}function Wk(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.w=NaN,this.a=new Rk,this.c=new Vk}function Y(a,o){var s=this;bc.call(this),this.i=ui,this.a=null,this.ob=!1,this.g=new M,this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.D=this.fc=this.H=this.qb=this.o=this.G=this.h=this.T=null,this.ke=1e9,this.hc=new Set,this.sb=!0,this.sa=null,this.je=!1,this.ge=0,this.ra=null,this.ea=new Ph,this.b=Yk(this),this.ic={width:1/0,height:1/0},this.w=null,this.Pb=new Yh(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.qa=this.b.preferredTextLanguage,this.nb=this.b.preferredTextRole,this.Mc=[],o&&o(this),this.T=function Zk(i){return new L((function(a,o){i.l&&i.l.segmentDownloaded(a,o)}))}(this),this.g.B(i,"online",(function(){s.Cd()})),this.K={name:"detach"},this.V={name:"attach"},this.Ma={name:"unload"},this.Zc={name:"manifest-parser"},this.Uc={name:"manifest"},this.pb={name:"media-source"},this.Nc={name:"drm-engine"},this.$={name:"load"},this.dd={name:"src-equals-drm-engine"},this.rb={name:"src-equals"};var l=new Map;l.set(this.V,(function(i,a){return Yb(function $k(i,a,o){return null==a.v&&(a.v=o.v,i.g.B(a.v,"error",(function(){var a=ql(i);a&&i.Ra(a)}))),i.a=a.v,Promise.resolve()}(s,i,a))})),l.set(this.K,(function(i){return i.v&&(s.g.pa(i.v,"error"),i.v=null),s.a=null,Yb(i=Promise.resolve())})),l.set(this.Ma,(function(i){return Yb(al(s,i))})),l.set(this.pb,(function(a){return a=function bl(a,o){return u((function e(){var s,l,C,R;return x(e,(function(j){switch(j.j){case 1:return s=i.muxjs?new Bd:new Cd,l=a.b.textDisplayFactory,C=new l,a.Rc=l,v(j,(R=new fe(o.v,s,C)).u,2);case 2:a.G=R,w(j)}}))}))}(s,a),Yb(a)})),l.set(this.Zc,(function(i,a){var o=function cl(i,a,o){return u((function f(){var s,l,C,R;return x(f,(function(j){switch(j.j){case 1:if(a.Ea=o.Ea,a.mimeType=o.mimeType,a.uri=o.uri,s=a.uri,l=i.T,i.Ob=s,a.Ea){i.u=a.Ea(),j.C(2);break}return C=i,v(j,Kt.create(s,l,i.b.manifest.retryParameters,a.mimeType),3);case 3:C.u=j.s;case 2:R=cc(i.b.manifest),o.v&&"AUDIO"===o.v.nodeName&&(R.disableVideo=!0),i.u.configure(R),w(j)}}))}))}(s,i,a);return Yb(o)})),l.set(this.Uc,(function(i){return function dl(i,a){var o=a.uri,s=i.T;i.ec=new Ji((function(){return i.Be()})),function Ki(i,a){i.b=a}(i.ec,(function(a){sl(i,"timelineregionadded",a)}));var l={networkingEngine:s,filterNewPeriod:function(a){return i.Vc(a)},filterAllPeriods:function(a){return tl(i,a)},onTimelineRegionAdded:function(a){var o=i.ec;e:{for(var s=t(o.a),l=s.next();!l.done;l=s.next())if((l=l.value).schemeIdUri==a.schemeIdUri&&l.id==a.id&&l.startTime==a.startTime&&l.endTime==a.endTime){s=l;break e}s=null}null==s&&(o.a.add(a),o.b(a))},onEvent:function(a){return i.dispatchEvent(a)},onError:function(a){return i.Ra(a)}};return new J(Promise.resolve().then((function(){return u((function h(){var a;return x(h,(function(s){switch(s.j){case 1:return a=i,v(s,i.u.start(o,l),2);case 2:if(a.c=s.s,i.dispatchEvent(new K("manifestparsed")),0==i.c.periods.length)throw new D(2,4,4014);!function ul(i){function c(i){return i.video&&i.audio||i.video&&i.video.codecs.includes(",")}i.some((function(i){return i.variants.some(c)}))&&(G.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),i.forEach((function(i){i.variants=i.variants.filter(c)})))}(i.c.periods),w(s)}}))}))})),(function(){return G.info("Aborting parser step..."),i.u.stop()}))}(s,i)})),l.set(this.Nc,(function(i){return i=function el(i,a){return u((function e(){return x(e,(function(o){switch(o.j){case 1:return i.h=vl(i,{Db:i.T,onError:function(a){i.Ra(a)},yc:function(a){wl(i,a)},onExpirationUpdated:function(a,o){xl(i,a,o)},onEvent:function(a){i.dispatchEvent(a)}}),i.h.configure(i.b.drm),v(o,Xc(i.h,ni(i.c.periods),i.c.offlineSessionIds),2);case 2:return v(o,i.h.Qb(a.v),3);case 3:tl(i,i.c.periods),w(o)}}))}))}(s,i),Yb(i)})),l.set(this.$,(function(i,a){return Yb(function fl(i,a,o){return u((function f(){var s,l,C,R,j,U,_,O,B,F;return x(f,(function(H){switch(H.j){case 1:return a.startTime=o.startTime,s=a.v,l=a.uri,i.Ob=l,i.H=new ri({rc:function(){return a.v.playbackRate},Id:function(i){a.v.playbackRate=i},le:function(i){a.v.currentTime+=i}}),i.w=new Wk,C=function(){return yl(i)},R=function(){return zl(i)},i.g.B(s,"playing",C),i.g.B(s,"pause",C),i.g.B(s,"ended",C),i.g.B(s,"ratechange",R),j=i.b.abrFactory,i.l&&i.Lc==j||(i.Lc=j,i.l=new j,i.l.configure(i.b.abr)),function Al(i,a){for(var o=0;o<a.length;o++){for(var s=a[o],l=new Map,C=t(s.variants),R=C.next();!R.done;R=C.next())if((R=R.value).video&&R.video.closedCaptions)for(var j=t((R=R.video).closedCaptions.keys()),U=j.next();!U.done;U=j.next())if(U=U.value,!l.has(U)){var _={id:i.ke++,originalId:U,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:R.closedCaptions.get(U),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:R.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};l.set(U,_)}for(C=(l=t(l.values())).next();!C.done;C=l.next())s.textStreams.push(C.value)}}(i,i.c.periods),i.Pb=new Yh(i.b.preferredAudioLanguage,i.b.preferredVariantRole,i.b.preferredAudioChannelCount),i.qa=i.b.preferredTextLanguage,function Bl(i,a,o){0<a&&(i.X()?G.m("|playRangeStart| has been configured for live content. Ignoring the setting."):i.Ee(a)),o<i.ca()&&(i.X()?G.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):i.Ba(o))}(i.c.presentationTimeline,i.b.playRangeStart,i.b.playRangeEnd),i.l.init((function(a,o,s){o=void 0!==o&&o,s=void 0===s?0:s,G.debug("switch_");e:{for(var l=t(i.c.periods),C=l.next();!C.done;C=l.next())if((C=C.value).variants.includes(a)){l=C;break e}l=null}Cl(i,l,a,!0),i.f&&ej(i.f,a,o,s)&&Dl(i)})),i.o=function El(i,a){return new Di(i.a,i.c,i.b.streaming,a,(function(){i.qb&&mi(i.qb,!0),i.f&&function lj(i){function c(s){var l=i.a.O;return s="text"==s?null!=(s=l.a).a&&null!=s.b&&a>=s.a&&a<s.b:Ed(s=me(l,s),a,o)}var a=i.a.Za(),o=i.g.smallGapLimit,s=!1,l=Ti(i,a);if(Ac(i.b.values(),(function(i){return i.ka==l})))for(var C=t(i.b.keys()),R=C.next();!R.done;R=C.next())c(R=R.value)||(gj(i,i.b.get(R)),s=!0);else Ac(i.b.keys(),c)||(G.debug("(all): seeked: unbuffered seek: clearing all buffers"),i.b.forEach((function(a){gj(i,a)})),s=!0);s||G.debug("(all): seeked: buffered seek: presentationTime="+a)}(i.f),i.D&&Rl(i)}),(function(a){return i.dispatchEvent(a)}))}(i,a.startTime),i.qb=function Fl(i){var a=new pi(i.c);!function qi(i,a){i.b=a}(a,(function(){Kl(i)}));var o=new Li(i.ec);!function Pi(i,a,o,s){i.a=a,i.b=o,i.c=s}(o,(function(a){sl(i,"timelineregionenter",a)}),(function(a){sl(i,"timelineregionexit",a)}),(function(a,o){o||(sl(i,"timelineregionenter",a),sl(i,"timelineregionexit",a))}));var s=new li(i.a);return s.a.add(a),s.a.add(o),s}(i),U=Math.max(i.c.minBufferTime,i.b.streaming.rebufferingGoal),Gl(i,U),i.f=function Hl(i){return new Qi(i.c,{Za:function(){return i.o.g()},getBandwidthEstimate:function(){return i.l.getBandwidthEstimate()},O:i.G,Db:i.T,oe:i.Mf.bind(i),ne:i.Te.bind(i),onError:i.Ra.bind(i),onEvent:function(a){return i.dispatchEvent(a)},Qf:i.Rf.bind(i),td:i.Wf.bind(i)})}(i),i.f.configure(i.b.streaming),vt.Vd(i.c,i.b.preferredAudioChannelCount),i.i=ci,i.dispatchEvent(new K("streaming")),v(H,i.f.start(),2);case 2:i.b.streaming.startAtSegmentBoundary&&(_=i.o.g(),O=function Jl(i,a){function d(i,a){if(!i)return null;var o=i.findSegmentPosition(a-l.startTime);return null==o?null:(o=i.getSegmentReference(o))?o.startTime+l.startTime:null}var o=Vi(i.f),s=Xi(i.f),l=Ll(i);return o=d(o,a),null!=(s=d(s,a))&&null!=o?Math.max(s,o):null!=s?s:null!=o?o:a}(i,_),i.o.o(O)),i.c.periods.forEach(i.Vc.bind(i)),Kl(i),Dl(i),B=Ll(i)||i.c.periods[0],F=B.variants.some((function(i){return i.primary})),i.b.preferredAudioLanguage||F||G.m("No preferred audio language set.  We will choose an arbitrary language initially"),Ml(i,B.variants),i.g.ua(s,"loadedmetadata",(function(){i.w.b=Date.now()/1e3-o.Ld})),w(H)}}))}))}(s,i,a))})),l.set(this.dd,(function(i){return i=function gl(i,a){return u((function e(){var o,s;return x(e,(function(l){switch(l.j){case 1:return o=Pe,i.h=vl(i,{Db:i.T,onError:function(a){i.Ra(a)},yc:function(a){wl(i,a)},onExpirationUpdated:function(a,o){xl(i,a,o)},onEvent:function(a){i.dispatchEvent(a)}}),i.h.configure(i.b.drm),s={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:o.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(l,Xc(i.h,[s],[]),2);case 2:return v(l,i.h.Qb(a.v),0)}}))}))}(s,i),Yb(i)})),l.set(this.rb,(function(i,a){return function hl(i,a,o){function e(){return yl(i)}if(a.uri=o.uri,a.startTime=o.startTime,i.Ob=a.uri,i.w=new Wk,i.o=new Ci(a.v),null!=a.startTime&&i.o.o(a.startTime),i.H=new ri({rc:function(){return a.v.playbackRate},Id:function(i){a.v.playbackRate=i},le:function(i){a.v.currentTime+=i}}),Gl(i,i.b.streaming.rebufferingGoal),i.g.B(a.v,"playing",e),i.g.B(a.v,"pause",e),i.g.B(a.v,"ended",e),i.g.B(a.v,"ratechange",(function(){return zl(i)})),"none"!=i.a.preload&&i.g.ua(a.v,"loadedmetadata",(function(){i.w.b=Date.now()/1e3-o.Ld})),i.a.audioTracks&&(i.g.B(i.a.audioTracks,"addtrack",(function(){return Kl(i)})),i.g.B(i.a.audioTracks,"removetrack",(function(){return Kl(i)})),i.g.B(i.a.audioTracks,"change",(function(){return Kl(i)}))),i.a.textTracks){var s=i.a.textTracks;i.g.B(s,"addtrack",(function(){return Kl(i)})),i.g.B(s,"removetrack",(function(){return Kl(i)})),i.g.B(s,"change",(function(){return Kl(i)}))}a.v.src=a.uri,(Kc()||Lc("Web0S"))&&a.v.load(),i.i=di,i.dispatchEvent(new K("streaming"));var l=new E;ti(i.a,HTMLMediaElement.HAVE_METADATA,i.g,(function(){l.resolve()}));var C=!1;return i.Mc.push((function(){C=!0})),ti(i.a,HTMLMediaElement.HAVE_CURRENT_DATA,i.g,(function(){return u((function m(){return x(m,(function(a){switch(a.j){case 1:if(C)return a.return();if(function Ol(i){var a=i.b.preferredAudioLanguage;if(""!=a){i.Dd(a);var o=i.b.preferredVariantRole;""!=o&&i.Dd(a,o)}}(i),Pl(i).find((function(i){return"disabled"!=i.mode}))){a.C(2);break}return v(a,new Promise((function(a){i.g.ua(i.a.textTracks,"change",a),new I(a).R(1)})),2);case 2:if(C)return a.return();!function Ql(i){var a=i.b.preferredTextLanguage;if(""!=a){i.Ed(a);var o=i.b.preferredTextRole;""!=o&&i.Ed(a,o)}}(i),w(a)}}))}))})),i.a.error?l.reject(ql(i)):"none"==i.a.preload&&(G.Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),i.g.ua(i.a,"error",(function(){l.reject(ql(i))})),new J(l,(function(){return l.reject(new D(2,7,7001)),Promise.resolve()}))}(s,i,a)})),this.Ta=new Ck(this.K,{sf:function(i,a,o,l){var C=null;return i==s.K&&(C=o==s.K?s.K:s.V),i==s.V&&(C=o==s.K||a.v!=l.v?s.K:o==s.V?s.V:o==s.pb||o==s.$?s.pb:o==s.rb?s.dd:null),i==s.pb&&(C=o==s.$&&a.v==l.v?s.Zc:s.Ma),i==s.Zc&&(C=il(s.$,s.Uc,s.Ma,o,a,l)),i==s.Uc&&(C=il(s.$,s.Nc,s.Ma,o,a,l)),i==s.Nc&&(C=il(s.$,s.$,s.Ma,o,a,l)),i==s.dd&&(C=o==s.rb&&a.v==l.v?s.rb:s.Ma),i!=s.$&&i!=s.rb||(C=s.Ma),i==s.Ma&&(C=l.v&&a.v==l.v?s.V:s.K),C},Ze:function(i,a,o){return s.dispatchEvent(new K("onstatechange",{state:i.name})),l.get(i)(a,o)},handleError:function(i,a){return u((function k(){return x(k,(function(o){switch(o.j){case 1:return G.m("The walker saw an error:"),a instanceof D?G.m("Error Code:",a.code):(G.m("Error Message:",a.message),G.m("Error Stack:",a.stack)),v(o,al(s,i),2);case 2:return o.return(i.v?s.V:s.K)}}))}))},Of:function(i){s.dispatchEvent(new K("onstateidle",{state:i.name}))}}),a&&this.Qb(a,!0)}xa(fk,Sj),fk.prototype.updateManifestExpiration=function(i,a){var o=Qj(this.b,this.a),s=o.store(),l=new E;return s.get(i).onsuccess=function(o){(o=o.target.result)?(o.expiration=a,s.put(o),l.resolve()):l.reject(new D(2,9,9012,"Could not find values for "+i))},o.promise().then((function(){return l}))},fk.prototype.mc=function(i){return{originalManifestUri:i.originalManifestUri,duration:i.duration,size:i.size,expiration:null==i.expiration?1/0:i.expiration,periods:i.periods.map(gk),sessionIds:i.sessionIds,drmInfo:i.drmInfo,appMetadata:i.appMetadata}},fk.prototype.Wd=function(i){return{data:i.data}},xa(lk,Sj),lk.prototype.hasFixedKeySpace=function(){return this.f},lk.prototype.addSegments=function(i){return this.f?Tj(this.c):this.add(this.c,i)},lk.prototype.addManifests=function(i){return this.f?Tj(this.a):this.add(this.a,i)},lk.prototype.mc=function(i){return null==i.expiration&&(i.expiration=1/0),i},(s=mk.prototype).init=function(){var a=this,o=new E,s=i.indexedDB.open("shaka_offline_db",4);return s.onsuccess=function(i){i=i.target.result,a.f=i;var s=i.objectStoreNames;s.contains("manifest")&&s.contains("segment")?(G.debug("Mounting v1 idb storage cell"),s=new fk(i,"segment","manifest")):s=null,a.a=s,(s=i.objectStoreNames).contains("manifest-v2")&&s.contains("segment-v2")?(G.debug("Mounting v2 idb storage cell"),s=new lk(i,"segment-v2","manifest-v2",!0)):s=null,a.b=s,(s=i.objectStoreNames).contains("manifest-v3")&&s.contains("segment-v3")?(G.debug("Mounting v3 idb storage cell"),s=new lk(i,"segment-v3","manifest-v3",!1)):s=null,a.c=s,i.objectStoreNames.contains("session-ids")?(G.debug("Mounting session ID idb storage cell"),i=new Wj(i)):i=null,a.g=i,o.resolve()},s.onupgradeneeded=function(i){i=i.target.result;for(var a=t(["segment-v3","manifest-v3","session-ids"]),o=a.next();!o.done;o=a.next())o=o.value,i.objectStoreNames.contains(o)||i.createObjectStore(o,{autoIncrement:!0})},s.onerror=function(i){o.reject(new D(2,9,9001,s.error)),i.preventDefault()},o},s.destroy=function(){var i=this;return u((function d(){return x(d,(function(a){switch(a.j){case 1:if(!i.a){a.C(2);break}return v(a,i.a.destroy(),2);case 2:if(!i.b){a.C(4);break}return v(a,i.b.destroy(),4);case 4:if(!i.c){a.C(6);break}return v(a,i.c.destroy(),6);case 6:if(!i.g){a.C(8);break}return v(a,i.g.destroy(),8);case 8:i.f&&i.f.close(),w(a)}}))}))},s.getCells=function(){var i=new Map;return this.a&&i.set("v1",this.a),this.b&&i.set("v2",this.b),this.c&&i.set("v3",this.c),i},s.getEmeSessionCell=function(){return this.g},s.erase=function(){var a=this;return u((function d(){return x(d,(function(o){switch(o.j){case 1:if(!a.a){o.C(2);break}return v(o,a.a.destroy(),2);case 2:if(!a.b){o.C(4);break}return v(o,a.b.destroy(),4);case 4:if(!a.c){o.C(6);break}return v(o,a.c.destroy(),6);case 6:return a.f&&a.f.close(),v(o,function nk(){var a=new E,o=i.indexedDB.deleteDatabase("shaka_offline_db");return o.onblocked=function(){G.m("Deleting","shaka_offline_db","is being blocked")},o.onsuccess=function(){a.resolve()},o.onerror=function(i){a.reject(new D(2,9,9001,o.error)),i.preventDefault()},a}(),8);case 8:return a.f=null,a.a=null,a.b=null,a.c=null,v(o,a.init(),0)}}))}))},ek("idb",(function(){return Lc("CrKey")||!i.indexedDB?null:new mk})),ok.prototype.Aa=function(){return this.g},ok.prototype.fa=function(){return this.f},ok.prototype.key=function(){return this.c},ok.prototype.toString=function(){return this.b},(s=xk.prototype).configure=function(){},s.start=function(i){var a=this;return u((function e(){var o,s,l,C,R;return x(e,(function(j){switch(j.j){case 1:return o=pk(i),a.a=o,null==o||"manifest"!=o.a?j.return(Promise.reject(new D(2,1,9004,o))):(s=new Xj,Ca(j,2),v(j,s.init(),4));case 4:return v(j,bk(s,o.Aa(),o.fa()),5);case 5:return v(j,j.s.getManifests([o.key()]),6);case 6:return l=j.s,C=l[0],R=new qk(o.Aa(),o.fa()),j.return(function rk(i,a){var o=new X(null,0);o.Ba(a.duration);var s=a.periods.map((function(a){return sk(i,a,o)})),l=a.drmInfo?[a.drmInfo]:[];return a.drmInfo&&s.forEach((function(i){i.variants.forEach((function(i){i.drmInfos=l}))})),{presentationTimeline:o,minBufferTime:2,offlineSessionIds:a.sessionIds,periods:s}}(R,C));case 2:return Ha(j),v(j,s.destroy(),7);case 7:La(j,0)}}))}))},s.stop=function(){return Promise.resolve()},s.update=function(){},s.onExpirationUpdated=function(i,a){var o=this;return u((function f(){var s,l,C,R,j,U,_,O;return x(f,(function(B){switch(B.j){case 1:return s=o.a,l=new Xj,Ba(B,2,3),v(B,l.init(),5);case 5:return v(B,bk(l,s.Aa(),s.fa()),6);case 6:return v(B,(C=B.s).getManifests([s.key()]),7);case 7:if(R=B.s,j=R[0],U=j.sessionIds.includes(i),_=null==j.expiration||j.expiration>a,!U||!_){B.C(3);break}return G.debug("Updating expiration for stored content"),v(B,C.updateManifestExpiration(s.key(),a),3);case 3:return Ha(B),v(B,l.destroy(),10);case 10:La(B,0);break;case 2:O=Ga(B),G.error("There was an error updating",s,O),B.C(3)}}))}))},Kt.Lb("application/x-offline-manifest",xk),A("shaka.offline.OfflineScheme",yk),yk.h=function(i){return Xb(i={uri:i,vd:i,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},yk.i=function(i,a){var o=new Xj;return Xb(void 0).Y((function(){return o.init()})).Y((function(){return bk(o,a.Aa(),a.fa())})).Y((function(i){return i.getSegments([a.key()])})).Y((function(i){return{uri:a,vd:a,data:i[0].data,headers:{}}})).finally((function(){return o.destroy()}))},lc("offline",yk),Ck.prototype.destroy=function(){var i=this;return u((function d(){return x(d,(function(a){switch(a.j){case 1:return i.l=!1,i.b&&i.b.abort(),Fk(i),v(a,i.o,2);case 2:i.a&&i.a.za.eb();for(var o=t(i.g),s=o.next();!s.done;s=o.next())s.value.za.eb();i.a=null,i.g=[],i.h=null,w(a)}}))}))},A("shaka.text.SimpleTextDisplayer",Ik),Ik.prototype.remove=function(i,a){return!!this.a&&(Jk(this.a,(function(o){return o.startTime<a&&o.endTime>i})),!0)},Ik.prototype.remove=Ik.prototype.remove,Ik.prototype.append=function(i){var a=Kk,o=i.map((function(i){if(i.nestedCues.length){var a=i.nestedCues.map((function(i){return i.spacer?"\n":i.payload+" "})).join("").replace(/ $/m,"");(i=i.clone()).nestedCues=[],i.payload=a}return i})),s=[];i=this.a.cues?Array.from(this.a.cues):[];for(var l={},C=(o=t(o)).next();!C.done;l={Ab:l.Ab},C=o.next())l.Ab=C.value,i.some(function(i){return function(a){return a.startTime==i.Ab.startTime&&a.endTime==i.Ab.endTime&&a.text==i.Ab.payload}}(l))||(C=a(l.Ab))&&s.push(C);s.slice().sort((function(i,a){return i.startTime!=a.startTime?i.startTime-a.startTime:i.endTime!=a.endTime?i.endTime-a.startTime:"line"in VTTCue.prototype?s.indexOf(a)-s.indexOf(i):s.indexOf(i)-s.indexOf(a)})).forEach(function(i){this.a.addCue(i)}.bind(this))},Ik.prototype.append=Ik.prototype.append,Ik.prototype.destroy=function(){return this.a&&Jk(this.a,(function(){return!0})),this.a=null,Promise.resolve()},Ik.prototype.destroy=Ik.prototype.destroy,Ik.prototype.isTextVisible=function(){return"showing"==this.a.mode},Ik.prototype.isTextVisible=Ik.prototype.isTextVisible,Ik.prototype.setTextVisibility=function(i){this.a.mode=i?"showing":"hidden"},Ik.prototype.setTextVisibility=Ik.prototype.setTextVisibility,A("shaka.util.ConfigUtils.mergeConfigObjects",Lk),A("shaka.util.ConfigUtils.convertToConfigObject",Mk),A("shaka.util.PlayerConfiguration",Nk),Nk.mergeConfigObjects=Qk,bb(Y,bc),A("shaka.Player",Y),Y.prototype.destroy=function(){var i=this;return u((function d(){var a;return x(d,(function(o){switch(o.j){case 1:return i.i==Jn?o.return():(i.i=Jn,a=Gk(i.Ta,(function(){return{node:i.K,payload:Dk(),$a:!1}})),v(o,new Promise((function(o){a.Fb=function(){G.info("Preparing to destroy walker...")},a.xc=function(){o(),i.dispatchEvent(new K("loaded"))},a.eb=function(){o()},a.onError=function(){o()},a.zc=function(){o()}})),2));case 2:return v(o,i.Ta.destroy(),3);case 3:if(i.g&&(i.g.release(),i.g=null),i.Lc=null,i.l=null,i.b=null,!i.T){o.C(0);break}return v(o,i.T.destroy(),5);case 5:i.T=null,w(o)}}))}))},Y.prototype.destroy=Y.prototype.destroy,Y.version="v2.5.20";var En=["2","5"];bt=new function(i){this.a=i,this.c=Fe,this.b=Ge}(new Ce(Number(En[0]),Number(En[1])));var _n=["output-restricted","internal-error"],Vn={};function al(i,a){return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return i.i!=Jn&&(i.i=ui),o=i.Mc.map((function(i){return i()})),i.Mc=[],v(s,Promise.all(o),2);case 2:if(i.dispatchEvent(new K("unloading")),a.Ea=null,a.mimeType=null,a.startTime=null,a.uri=null,a.v&&(i.g.pa(a.v,"loadedmetadata"),i.g.pa(a.v,"playing"),i.g.pa(a.v,"pause"),i.g.pa(a.v,"ended"),i.g.pa(a.v,"ratechange")),i.qb&&(i.qb.release(),i.qb=null),i.fc&&(i.fc.stop(),i.fc=null),!i.u){s.C(3);break}return v(s,i.u.stop(),4);case 4:i.u=null;case 3:if(!i.l){s.C(5);break}return v(s,i.l.stop(),5);case 5:if(!i.f){s.C(7);break}return v(s,i.f.destroy(),8);case 8:i.f=null;case 7:if(i.H&&(i.H.release(),i.H=null),i.o&&(i.o.release(),i.o=null),!i.G){s.C(9);break}return v(s,i.G.destroy(),10);case 10:i.G=null;case 9:if(!a.v||!a.v.src){s.C(11);break}return v(s,new Promise((function(i){return new I(i).R(.1)})),12);case 12:a.v.removeAttribute("src"),a.v.load();case 11:if(!i.h){s.C(13);break}return v(s,i.h.destroy(),14);case 14:i.h=null;case 13:i.ea.a.clear(),i.Ob=null,i.D=null,i.hc.clear(),i.c=null,i.w=null,i.Rc=null,i.sb=!0,rl(i),w(s)}}))}))}function vl(i,a){return new Qc(a,i.b.drm.updateExpirationTime)}function Gl(i,a){i.D=new bi,i.D.a=Wt,ei(i.D,a,Math.min(.5,a/2)),rl(i),i.fc=new I((function(){Rl(i)})).Ka(.25)}function Rl(i){switch(i.i){case di:var a=!!i.a.ended||Dd(i.a.buffered)>=i.a.duration-1;break;case ci:e:if(i.a.ended||ke(i.G))a=!0;else{if(i.c.presentationTimeline.X()){var o=i.c.presentationTimeline.xb();if(Dd(i.a.buffered)>=o){a=!0;break e}}a=!1}break;default:a=!1}var s=Fd(i.a.buffered,i.a.currentTime),l=a,C=(o=i.D).b.get(o.a);a=o.a,s=l||s>=C?Qt:Wt,o.a=s,a!=s&&rl(i)}function Sl(i){if(i.u){var a=cc(i.b.manifest);i.a&&"AUDIO"===i.a.nodeName&&(a.disableVideo=!0),i.u.configure(a)}if(i.h&&i.h.configure(i.b.drm),i.f){i.f.configure(i.b.streaming);try{i.c.periods.forEach(i.Vc.bind(i))}catch(a){i.Ra(a)}var o=Vi(i.f),s=Xi(i.f);a=Ll(i),o=vt.ce(o,s,a.variants),i.l&&o&&o.allowedByApplication&&o.allowedByKeySystem?Ml(i,a.variants):(G.debug("Choosing new streams after changing configuration"),Tl(i,a))}if(i.G&&(a=i.b.textDisplayFactory,i.Rc!=a)){o=new a;var l=(s=i.G).g;s.g=o,l&&(o.setTextVisibility(l.isTextVisible()),l.destroy()),s.a&&(s.a.c=o),i.Rc=a,i.f&&((o=(a=i.f).b.get("text"))&&dj(a,o.stream,!0,0,!0))}i.l&&(i.l.configure(i.b.abr),i.b.abr.enabled&&!i.sb?i.l.enable():i.l.disable(),Ul(i)),i.D&&(a=i.b.streaming.rebufferingGoal,i.c&&(a=Math.max(a,i.c.minBufferTime)),ei(i.D,a,Math.min(.5,a/2)))}function Pl(i){return Array.from(i.a.textTracks).filter((function(i){return"metadata"!=i.kind&&"chapters"!=i.kind&&"Shaka Player TextTrack"!=i.label}))}function Cl(i,a,o,s){Rh(i.ea,a).variant=o,(i=i.w.c).c!=o&&(i.c=o,i.a.push({timestamp:Date.now()/1e3,id:o.id,type:"variant",fromAdaptation:s,bandwidth:o.bandwidth}))}function Zl(i,a,o,s){Qh(i.ea,a,o),(i=i.w.c).b!=o&&(i.b=o,i.a.push({timestamp:Date.now()/1e3,id:o.id,type:"text",fromAdaptation:s,bandwidth:null}))}function Yk(i){var a=Ok();return a.streaming.failureCallback=function(a){i.X()&&[1001,1002,1003].includes(a.code)&&(a.severity=1,G.m("Live streaming error.  Retrying automatically..."),i.Cd())},a.textDisplayFactory=function(){return new Ik(i.a)},a}function tl(i,a){var o=i.f?Vi(i.f):null,s=i.f?Xi(i.f):null;if(a.forEach(vt.filterNewPeriod.bind(null,i.h,o,s)),o=function gc(i,a){var o=0;return i.forEach((function(i){o+=a(i)?1:0})),o}(a,(function(i){return i.variants.some(vt.Bb)})),0==o)throw new D(2,4,4032);if(o<a.length)throw new D(2,4,4011);a.forEach(function(i){vt.Sd(i.variants,this.b.restrictions,this.ic)&&this.f&&Ll(this)==i&&Kl(this),hm(this,i.variants)}.bind(i))}function bm(i,a,o,s){return o=void 0!==o&&o,s=void 0===s?0:s,i.sb?(i.sa=a,i.je=o,i.ge=s,!0):((a=ej(i.f,a,o,s))&&cm(i),a)}function $l(i,a){if(i.sb)return i.ra=a,!0;var o=dj(i.f,a,!0,0,!1);return o&&am(i),o}function rl(i){var a=i.fd();if(i.w&&i.D&&i.o){var o=i.H;o.f=a,si(o),yl(i)}i.dispatchEvent(new K("buffering",{buffering:a}))}function zl(i){var a=i.a.playbackRate;0!=a&&i.H.set(a)}function yl(i){if(i.w&&i.D){var a=i.w.a;i.D.a==Wt?Sk(a,"buffering"):i.a.paused?Sk(a,"paused"):i.a.ended?Sk(a,"ended"):Sk(a,"playing")}}function Ml(i,a){try{hm(i,a)}catch(a){return i.Ra(a),null}var o=a.filter((function(i){return vt.Bb(i)}));return o=i.Pb.create(o),i.l.setVariants(Array.from(o.values())),i.l.chooseVariant()}function Tl(i,a){var o=fm(i,a,!1),s=vt.Sb(a.textStreams,i.qa,i.nb)[0]||null,l=!1;s&&(i.b.streaming.alwaysStreamText||i.uc())&&(Zl(i,a,s,!0),l=$l(i,s)),(o||l)&&Dl(i)}function fm(i,a,o){o=void 0===o||o;var s=Ml(i,a.variants),l=!1;return s&&(Cl(i,a,s,!0),l=bm(i,s,!0)),o&&l&&Dl(i),l}function Dl(i){im(i,new K("adaptation"))}function Kl(i){im(i,new K("trackschanged"))}function cm(i){im(i,new K("variantchanged"))}function am(i){im(i,new K("textchanged"))}function gm(i){im(i,new K("texttrackvisibility"))}function Ul(i){im(i,new K("abrstatuschanged",{Rg:i.b.abr.enabled}))}function sl(i,a,o){i.dispatchEvent(new K(a,{detail:{schemeIdUri:o.schemeIdUri,value:o.value,startTime:o.startTime,endTime:o.endTime,id:o.id,eventElement:o.eventElement}}))}function ql(i){if(!i.a.error)return null;var a=i.a.error.code;if(1==a)return null;var o=i.a.error.msExtendedCode;return o&&(0>o&&(o+=Math.pow(2,32)),o=o.toString(16)),new D(2,3,3016,a,o,i.a.error.message)}function wl(i,a){if(i.f){var o=Ll(i),s=!1,l=Object.keys(a);0==l.length&&G.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var C=1==l.length&&"00"==l[0];C&&G.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),l.length&&i.c.periods.forEach((function(i){i.variants.forEach((function(i){vt.Cf(i).forEach((function(o){var l=i.allowedByKeySystem;o.keyId&&(o=a[C?"00":o.keyId],i.allowedByKeySystem=!!o&&!_n.includes(o)),l!=i.allowedByKeySystem&&(s=!0)}))}))})),l=Vi(i.f);var R=Xi(i.f);(l=vt.ce(l,R,o.variants))&&!l.allowedByKeySystem&&(G.debug("Choosing new variants after key status changed"),fm(i,o)),s&&(Kl(i),Ml(i,o.variants))}}function xl(i,a,o){i.u&&i.u.onExpirationUpdated&&i.u.onExpirationUpdated(a,o),i.dispatchEvent(new K("expirationupdated"))}function hm(i,a){var o=i.h?Cc(i.h.$):{},s=Object.keys(o);s=s.length&&"00"==s[0];for(var l=!1,C=!1,R=[],j=[],U=t(a),_=U.next();!_.done;_=U.next()){var O=[];(_=_.value).audio&&O.push(_.audio),_.video&&O.push(_.video);for(var B=(O=t(O)).next();!B.done;B=O.next())if((B=B.value).keyId){var F=o[s?"00":B.keyId];F?_n.includes(F)&&(j.includes(F)||j.push(F)):R.includes(B.keyId)||R.push(B.keyId)}_.allowedByApplication?_.allowedByKeySystem&&(l=!0):C=!0}if(!l)throw new D(2,4,4012,{hasAppRestrictions:C,missingKeys:R,restrictedKeyStatuses:j})}function im(i,a){u((function e(){return x(e,(function(o){switch(o.j){case 1:return v(o,Promise.resolve(),2);case 2:i.i!=Jn&&i.dispatchEvent(a),w(o)}}))}))}function em(i){for(var a=new Set,o=(i=t(i)).next();!o.done;o=i.next())(o=o.value).language?a.add(N(o.language)):a.add("und");return a}function dm(i){for(var a=new Map,o=(i=t(i)).next();!o.done;o=i.next()){var s=o.value;o="und";var l=[];for(s.language&&(o=N(s.language)),(l="variant"==s.type?s.audioRoles:s.roles)&&l.length||(l=[""]),a.has(o)||a.set(o,new Set),l=(s=t(l)).next();!l.done;l=s.next())l=l.value,a.get(o).add(l)}var C=[];return a.forEach((function(i,a){for(var o=t(i),s=o.next();!s.done;s=o.next())C.push({language:a,role:s.value})})),C}function Wl(i){return null==(i=Ll(i))?[]:i.variants.filter((function(i){return vt.Bb(i)}))}function Ll(i){for(var a=i.o.g(),o=null,s=(i=t(i.c.periods)).next();!s.done;s=i.next())(s=s.value).startTime<=a&&(o=s);return o}function Vl(i){var a=Ll(i);return Rh(i.ea,a).variant}function nl(){return new D(2,7,7e3)}function il(i,a,o,s,l,C){return s==i&&l.v==C.v&&l.uri==C.uri&&l.mimeType==C.mimeType&&l.Ea==C.Ea?a:o}function Dk(){return{Ea:null,v:null,mimeType:null,startTime:null,Ld:null,uri:null}}function ol(i){return new Promise((function(a,o){i.eb=function(){return o(nl())},i.xc=function(){return a()},i.onError=function(i){return o(i)},i.zc=function(){return o(nl())}}))}Y.registerSupportPlugin=function(i,a){Vn[i]=a},Y.isBrowserSupported=function(){if(!(i.Promise&&i.Uint8Array&&Array.prototype.forEach))return!1;var a=Nc();return!(a&&12>a||!(i.MediaKeys&&i.navigator&&i.navigator.requestMediaKeySystemAccess&&i.MediaKeySystemAccess&&i.MediaKeySystemAccess.prototype.getConfiguration))&&(!!Hc()||Ic("application/x-mpegurl"))},Y.probeSupport=function(){return wd().then((function(i){for(var a=Kt.eg(),o={},s=t('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),l=s.next();!l.done;l=s.next()){o[l=l.value]=Hc()?!!ae(l)||(MediaSource.isTypeSupported(l)||Ob(l)):Ic(l);var C=l.split(";")[0];o[C]=o[C]||o[l]}for(var R in i={manifest:a,media:o,drm:i},Vn)i[R]=Vn[R]();return i}))},Y.prototype.Qb=function(i,a){if(a=void 0===a||a,this.i==Jn)return Promise.reject(nl());var o=Dk();o.v=i,Hc()||(a=!1);var s=a?this.pb:this.V,l=Gk(this.Ta,(function(){return{node:s,payload:o,$a:!1}}));return l.Fb=function(){return G.info("Starting attach...")},ol(l)},Y.prototype.attach=Y.prototype.Qb,Y.prototype.detach=function(){var i=this;if(this.i==Jn)return Promise.reject(nl());var a=Gk(this.Ta,(function(){return{node:i.K,payload:Dk(),$a:!1}}));return a.Fb=function(){return G.info("Starting detach...")},ol(a)},Y.prototype.detach=Y.prototype.detach,Y.prototype.Od=function(i){var a=this;if(i=void 0===i||i,this.i==Jn)return Promise.reject(nl());Hc()||(i=!1);var o=Dk(),s=Gk(this.Ta,(function(s){var l=s.v&&i?a.pb:s.v?a.V:a.K;return o.v=s.v,{node:l,payload:o,$a:!1}}));return s.Fb=function(){return G.info("Starting unload...")},ol(s)},Y.prototype.unload=Y.prototype.Od,Y.prototype.load=function(i,a,o){if(this.i==Jn)return Promise.reject(nl());this.dispatchEvent(new K("loading"));var s=Dk();s.uri=i,s.Ld=Date.now()/1e3,o&&"string"!=typeof o&&(De("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),s.Ea=function(){return new o}),o&&"string"==typeof o&&(s.mimeType=o),void 0!==a&&(s.startTime=a);var l=function pl(i,a){if(a.Ea)return!1;if(!Hc())return!0;var o=a.mimeType,s=a.uri||"";return o||(o={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[Kt.getExtension(s)]),!!o&&(""!=(a.v||Jc()).canPlayType(o)&&(!Kt.isSupported(s,o)||Mc()&&i.b.streaming.useNativeHlsOnSafari))}(this,s)?this.rb:this.$,C=Gk(this.Ta,(function(i){return null==i.v?null:(s.v=i.v,{node:l,payload:s,$a:!0})}));return C.Fb=function(){return G.info("Starting load of "+i+"...")},new Promise((function(i,a){C.zc=function(){return a(new D(2,7,7002))},C.xc=function(){return i()},C.eb=function(){return a(nl())},C.onError=function(i){return a(i)}}))},Y.prototype.load=Y.prototype.load,Y.prototype.configure=function(i,a){2==arguments.length&&"string"==typeof i&&(i=Mk(i,a));var o=Qk(this.b,i,Yk(this));return Sl(this),o},Y.prototype.configure=Y.prototype.configure,Y.prototype.getConfiguration=function(){var i=Yk(this);return Qk(i,this.b,Yk(this)),i},Y.prototype.getConfiguration=Y.prototype.getConfiguration,Y.prototype.mg=function(){for(var i in this.b)delete this.b[i];Qk(this.b,Yk(this),Yk(this)),Sl(this)},Y.prototype.resetConfiguration=Y.prototype.mg,Y.prototype.kf=function(){return this.i},Y.prototype.getLoadMode=Y.prototype.kf,Y.prototype.qf=function(){return this.a},Y.prototype.getMediaElement=Y.prototype.qf,Y.prototype.Ub=function(){return this.T},Y.prototype.getNetworkingEngine=Y.prototype.Ub,Y.prototype.pc=function(){return this.Ob},Y.prototype.getAssetUri=Y.prototype.pc,Y.prototype.nf=function(){return De("getManifestUri",'Please use "getAssetUri" instead.'),this.pc()},Y.prototype.getManifestUri=Y.prototype.nf,Y.prototype.X=function(){return this.c?this.c.presentationTimeline.X():!(!this.a||!this.a.src)&&1/0==this.a.duration},Y.prototype.isLive=Y.prototype.X,Y.prototype.bb=function(){return!!this.c&&this.c.presentationTimeline.bb()},Y.prototype.isInProgress=Y.prototype.bb,Y.prototype.Hf=function(){if(this.c){if(!this.c.periods.length)return!1;var i=this.c.periods[0].variants;return!!i.length&&!i[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Y.prototype.isAudioOnly=Y.prototype.Hf,Y.prototype.Be=function(){if(this.c){var i=this.c.presentationTimeline;return{start:i.wb(),end:i.Ga()}}return this.a&&this.a.src&&(i=this.a.seekable).length?{start:i.start(0),end:i.end(i.length-1)}:{start:0,end:0}},Y.prototype.seekRange=Y.prototype.Be,Y.prototype.keySystem=function(){return kd(this.drmInfo())},Y.prototype.keySystem=Y.prototype.keySystem,Y.prototype.drmInfo=function(){return this.h?this.h.a:null},Y.prototype.drmInfo=Y.prototype.drmInfo,Y.prototype.Tb=function(){return this.h?this.h.Tb():1/0},Y.prototype.getExpiration=Y.prototype.Tb,Y.prototype.fd=function(){return!!this.D&&this.D.a==Wt},Y.prototype.isBuffering=Y.prototype.fd,Y.prototype.uf=function(){if(this.H){var i=this.H;i=i.f?0:i.c}else i=0;return i},Y.prototype.getPlaybackRate=Y.prototype.uf,Y.prototype.Eg=function(i){0==i?G.Z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(i),this.i==ci&&cj(this.f,1<Math.abs(i)))},Y.prototype.trickPlay=Y.prototype.Eg,Y.prototype.Ue=function(){this.i==di&&this.H.set(1),this.i==ci&&(this.H.set(1),cj(this.f,!1))},Y.prototype.cancelTrickPlay=Y.prototype.Ue,Y.prototype.cd=function(){if(this.c&&this.o){for(var i=Vl(this),a=[],o=t(Wl(this)),s=o.next();!s.done;s=o.next()){s=s.value;var l=vt.Qd(s);l.active=s==i,a.push(l)}return a}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map((function(i){return vt.de(i)})):[]},Y.prototype.getVariantTracks=Y.prototype.cd,Y.prototype.zb=function(){if(this.c&&this.o){for(var i=function Xl(i){var a=Ll(i);if(null==a)return null;if(!Rh(i.ea,a).text){var o=vt.Sb(a.textStreams,i.qa,i.nb);o.length&&Qh(i.ea,a,o[0])}return Rh(i.ea,a).text}(this),a=[],o=t(function Yl(i){var a=Ll(i);return null==a?[]:a.textStreams.filter((function(a){return!i.hc.has(a)}))}(this)),s=o.next();!s.done;s=o.next()){s=s.value;var l=vt.Fc(s);l.active=s==i,a.push(l)}return a}return this.a&&this.a.src&&this.a.textTracks?Pl(this).map((function(i){return vt.Ff(i)})):[]},Y.prototype.getTextTracks=Y.prototype.zb,Y.prototype.Fd=function(i){if(this.c&&this.f){var a=Ll(this),o=a.textStreams.find((function(a){return a.id==i.id}));o?(Zl(this,a,o,!1),$l(this,o),this.qa=o.language):G.error("No stream with id",i.id)}else if(this.a&&this.a.src&&this.a.textTracks){for(o=(a=t(a=Pl(this))).next();!o.done;o=a.next())o=o.value,vt.ed(o)==i.id?o.mode=this.ob?"showing":"hidden":o.mode="disabled";am(this)}},Y.prototype.selectTextTrack=Y.prototype.Fd,Y.prototype.og=function(){De("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var i=this.zb().filter((function(i){return"application/cea-608"==i.mimeType}));0<i.length?this.Fd(i[0]):G.m("Unable to find the text track embedded in the video.")},Y.prototype.selectEmbeddedTextTrack=Y.prototype.og,Y.prototype.Jg=function(){De("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var i=this.zb().filter((function(i){return i.active}))[0];return!!i&&"application/cea-608"==i.mimeType},Y.prototype.usingEmbeddedTextTrack=Y.prototype.Jg,Y.prototype.pg=function(i,a,o){if(o=void 0===o?0:o,this.c&&this.f){var s=Ll(this);this.b.abr.enabled&&G.Z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var l=s.variants.find((function(a){return a.id==i.id}));l?vt.Bb(l)?(Cl(this,s,l,!1),bm(this,l,a,o),this.Pb=new Xh(l),Ml(this,s.variants)):G.error("Unable to switch to restricted track",i.id):G.error("No variant with id",i.id)}else if(this.a&&this.a.audioTracks){for(o=(a=t(a=Array.from(this.a.audioTracks))).next();!o.done;o=a.next())o=o.value,vt.ed(o)==i.id&&(o.enabled=!0);cm(this)}},Y.prototype.selectVariantTrack=Y.prototype.pg,Y.prototype.ef=function(){return dm(this.cd())},Y.prototype.getAudioLanguagesAndRoles=Y.prototype.ef,Y.prototype.Bf=function(){return dm(this.zb())},Y.prototype.getTextLanguagesAndRoles=Y.prototype.Bf,Y.prototype.df=function(){return Array.from(em(this.cd()))},Y.prototype.getAudioLanguages=Y.prototype.df,Y.prototype.Af=function(){return Array.from(em(this.zb()))},Y.prototype.getTextLanguages=Y.prototype.Af,Y.prototype.Dd=function(i,a){if(this.c&&this.o){var o=Ll(this);this.Pb=new Yh(i,a||"",0,""),fm(this,o)}else if(this.a&&this.a.audioTracks){var s=Array.from(this.a.audioTracks);o=N(i);for(var l=null,C=null,R=(s=t(s)).next();!R.done;R=s.next()){R=R.value;var j=vt.de(R);N(j.language)==o&&(l=R,a?j.roles.includes(a)&&(C=R):0==j.roles.length&&(C=R))}C?(C.enabled=!0,cm(this)):l&&(l.enabled=!0,cm(this))}},Y.prototype.selectAudioLanguage=Y.prototype.Dd,Y.prototype.Ed=function(i,a){if(this.c&&this.o){var o=Ll(this);this.qa=i,this.nb=a||"";var s=vt.Sb(o.textStreams,this.qa,this.nb)[0]||null;s&&(Zl(this,o,s,!1),(this.b.streaming.alwaysStreamText||this.uc())&&$l(this,s))}else{var l=N(i);(o=this.zb().filter((function(i){return N(i.language)==l&&(!a||i.roles.includes(a))}))[0])&&this.Fd(o)}},Y.prototype.selectTextLanguage=Y.prototype.Ed,Y.prototype.qg=function(i){if(this.c&&this.o){for(var a=Ll(this),o=null,s=t(Wl(this)),l=s.next();!l.done;l=s.next())if((l=l.value).audio.label==i){o=l;break}null==o?G.m("No variants were found with label: "+i+". Ignoring the request to switch."):(this.Pb=new Yh(o.language,"",0,i),fm(this,a))}},Y.prototype.selectVariantsByLabel=Y.prototype.qg,Y.prototype.uc=function(){var i=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Pl(this).some((function(i){return"showing"==i.mode})):i},Y.prototype.isTextTrackVisible=Y.prototype.uc,Y.prototype.tg=function(i){var a=this;return u((function e(){var o,s,l,C;return x(e,(function(R){switch(R.j){case 1:if(a.ob==(o=!!i))return R.return();if(a.ob=o,a.i!=ci){if(a.a&&a.a.src&&a.a.textTracks)for(var j=t(Pl(a)),U=j.next();!U.done;U=j.next())"disabled"!=(s=U.value).mode&&(s.mode=o?"showing":"hidden");R.C(2);break}if(a.G.g.setTextVisibility(o),a.b.streaming.alwaysStreamText){R.C(2);break}if(!o){!function bj(i){i.G=!0;var a=i.b.get("text");a&&(Ri(a),Si(a).catch((function(){})),i.b.delete("text"))}(a.f),R.C(2);break}if(Wi(a.f,"text")){R.C(2);break}if(l=Ll(a),!(0<(C=vt.Sb(l.textStreams,a.qa,a.nb)).length)){R.C(2);break}return v(R,Yi(a.f,C[0]),2);case 2:gm(a),w(R)}}))}))},Y.prototype.setTextTrackVisibility=Y.prototype.tg,Y.prototype.wf=function(){if(!this.X())return G.m("getPlayheadTimeAsDate is for live streams!"),null;var i=this.Ta.f,a=0;if(this.o)a=this.o.g();else if(i){if(null==i.startTime)return new Date;a=i.startTime}return this.c?new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime)):this.a&&this.a.getStartDate?(i=this.a.getStartDate(),isNaN(i.getTime())?(G.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(i.getTime()+1e3*a)):(G.m("No way to get playhead time as Date!"),null)},Y.prototype.getPlayheadTimeAsDate=Y.prototype.wf,Y.prototype.yf=function(){if(!this.X())return G.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var i=this.a.getStartDate();return isNaN(i.getTime())?(G.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):i}return G.m("No way to get presentation start time as Date!"),null},Y.prototype.getPresentationStartTimeAsDate=Y.prototype.yf,Y.prototype.$c=function(){var i={total:[],audio:[],video:[],text:[]};return this.i==di&&(i.total=Gd(this.a.buffered)),this.i==ci&&this.G.$c(i),i},Y.prototype.getBufferedInfo=Y.prototype.$c,Y.prototype.getStats=function(){if(this.i!=ci&&this.i!=di)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};yl(this);var i=this.a;if(i.getVideoPlaybackQuality){i=i.getVideoPlaybackQuality();var a=this.w,o=Number(i.totalVideoFrames);a.o=Number(i.droppedVideoFrames),a.l=o,this.w.i=Number(i.corruptedVideoFrames)}this.h?i=(i=this.h).K?i.K:NaN:i=NaN,this.w.h=i,this.i==ci&&((i=Vl(this))&&(this.w.u=i.bandwidth),i&&i.video&&(a=this.w,o=i.video.height||NaN,a.w=i.video.width||NaN,a.g=o),i=this.l.getBandwidthEstimate(),this.w.f=i);var s=this.w;i=s.w,a=s.g,o=s.u;for(var l=s.l,C=s.o,R=s.i,j=s.f,U=s.b,_=Tk(s.a,"playing"),O=Tk(s.a,"paused"),B=Tk(s.a,"buffering"),F=s.h,H=function Uk(i){function c(i){return{timestamp:i.timestamp,state:i.state,duration:i.duration}}for(var a=[],o=t(i.b),s=o.next();!s.done;s=o.next())a.push(c(s.value));return i.a&&a.push(c(i.a)),a}(s.a),G=[],W=(s=t(s.c.a)).next();!W.done;W=s.next())W=W.value,G.push({timestamp:W.timestamp,id:W.id,type:W.type,fromAdaptation:W.fromAdaptation,bandwidth:W.bandwidth});return{width:i,height:a,streamBandwidth:o,decodedFrames:l,droppedFrames:C,corruptedFrames:R,estimatedBandwidth:j,loadLatency:U,playTime:_,pauseTime:O,bufferingTime:B,licenseTime:F,stateHistory:H,switchHistory:G}},Y.prototype.getStats=Y.prototype.getStats,Y.prototype.addTextTrack=function(i,a,o,s,l,C){var R=this;return u((function m(){var j,U,_,O,B,F,H,W,$;return x(m,(function(he){switch(he.j){case 1:if(R.i==di)throw G.error("Cannot add text when loaded with src="),Error("State error!");if(R.i!=ci)throw G.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(j=Ll(R),U=Pe,_=R.c.periods.indexOf(j),B=(O=_+1)>=R.c.periods.length?R.c.presentationTimeline.ca():R.c.periods[O].startTime,1/0==(F=B-j.startTime))throw new D(1,4,4033);return H=new V(1,0,F,(function(){return[i]}),0,null),W={id:R.ke++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(i){return 1==i?H:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:s,codecs:l||"",kind:o,encrypted:!1,keyId:null,language:a,label:C||null,type:U.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},R.hc.add(W),j.textStreams.push(W),v(he,Yi(R.f,W),2);case 2:return($=Wi(R.f,"text"))&&Qh(R.ea,j,$),R.hc.delete(W),G.debug("Choosing new streams after adding a text stream"),Tl(R,j),Kl(R),he.return(vt.Fc(W))}}))}))},Y.prototype.addTextTrack=Y.prototype.addTextTrack,Y.prototype.Hd=function(i,a){this.ic.width=i,this.ic.height=a},Y.prototype.setMaxHardwareResolution=Y.prototype.Hd,Y.prototype.Cd=function(){if(this.i==ci){var i=this.f;if(i.f)G.error("Unable to retry after StreamingEngine is destroyed!"),i=!1;else if(i.o)G.error("Unable to retry after StreamingEngine encountered a fatal error!"),i=!1;else{for(var a=t(i.b.values()),o=a.next();!o.done;o=a.next()){var s=hj(o=o.value);o.Xb&&(G.info(s,"Retrying after failure..."),o.Xb=!1,aj(i,o,.1))}i=!0}}else i=!1;return i},Y.prototype.retryStreaming=Y.prototype.Cd,Y.prototype.lf=function(){return this.c},Y.prototype.getManifest=Y.prototype.lf,Y.prototype.mf=function(){return this.u?this.u.constructor:null},Y.prototype.getManifestParserFactory=Y.prototype.mf,(s=Y.prototype).Vc=function(i){var a=this.f?Vi(this.f):null,o=this.f?Xi(this.f):null;if(vt.filterNewPeriod(this.h,a,o,i),!(a=i.variants).some(vt.Bb))throw new D(2,4,4011);if(hm(this,i.variants),vt.Sd(a,this.b.restrictions,this.ic)&&this.f&&Ll(this)==i&&Kl(this),i=this.h?this.h.a:null)for(o=(a=t(a)).next();!o.done;o=a.next())for(var s=(o=t(o.value.drmInfos)).next();!s.done;s=o.next())if((s=s.value).keySystem==i.keySystem)for(var l=(s=t(s.initData||[])).next();!l.done;l=s.next())l=l.value,gd(this.h,l.initDataType,l.initData)},s.Mf=function(i){G.debug("onChooseStreams_",i);try{G.J("onChooseStreams_, choosing variant from ",i.variants),G.J("onChooseStreams_, choosing text from ",i.textStreams),this.sb=!0,this.l.disable(),Ul(this),G.debug("Choosing new streams after period changed");var a=Ml(this,i.variants),o=vt.Sb(i.textStreams,this.qa,this.nb)[0]||null;this.sa&&(i.variants.includes(this.sa)&&(a=this.sa),this.sa=null),this.ra&&(i.textStreams.includes(this.ra)&&(o=this.ra),this.ra=null),a&&Cl(this,i,a,!0),o&&Zl(this,i,o,!0);var s=this.f,l=s.b.get("video");if(l)var C=s.c.periods[l.ka];else{var R=s.b.get("audio");C=R?s.c.periods[R.ka]:null}var j=a?a.audio:null;if(!C&&o){var U;if(U=j){i=o;var _=N(this.b.preferredTextLanguage),O=N(j.language),B=N(i.language);U=we(B,_)&&!we(O,B)}U&&(this.ob=!0),this.ob&&this.G.g.setTextVisibility(!0),gm(this)}var F=this.b.streaming.alwaysStreamText||this.uc()?{variant:a,text:o}:{variant:a,text:null};return G.J("onChooseStreams_, chose variant ",F.variant),G.J("onChooseStreams_, chose text ",F.text),F}catch(i){return this.Ra(i),{variant:null,text:null}}},s.Te=function(){G.debug("canSwitch_"),this.sb=!1,this.b.abr.enabled&&(this.l.enable(),Ul(this)),this.sa&&(ej(this.f,this.sa,this.je,this.ge),cm(this),this.sa=null),this.ra&&(dj(this.f,this.ra,!0,0,!1),am(this),this.ra=null)},s.Rf=function(){this.u&&this.u.update&&this.u.update()},s.Wf=function(){this.o&&this.o.u()},s.Ra=function(i){if(this.i!=Jn){var a=new K("error",{detail:i});this.dispatchEvent(a),a.defaultPrevented&&(i.handled=!0)}};var Jn=0,ui=1,ci=2,di=3;function lm(i,a){var o=sk(new qk(i.Aa(),i.fa()),a.periods[0],new X(null,0)),s=a.appMetadata||{};return o=km(o),{offlineUri:i.toString(),originalManifestUri:a.originalManifestUri,duration:a.duration,size:a.size,expiration:a.expiration,tracks:o,appMetadata:s}}function km(i){for(var a=[],o=vt.tf(i.variants),s=(o=t(o)).next();!s.done;s=o.next())a.push(vt.Qd(s.value));for(o=(i=t(i.textStreams)).next();!o.done;o=i.next())a.push(vt.Fc(o.value));return a}function mm(){this.a={}}function nm(i,a){var o=a.audio,s=a.video;if(o&&!s&&(i.a[o.id]=o.bandwidth||a.bandwidth),!o&&s&&(i.a[s.id]=s.bandwidth||a.bandwidth),o&&s){var l=o.bandwidth||393216,C=s.bandwidth||a.bandwidth-l;0>=C&&(G.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),C=a.bandwidth),i.a[o.id]=l,i.a[s.id]=C}}function pm(i,a){var o=i.a[a];return null==o&&(o=0,G.error("Asking for bitrate of stream not given to the estimator")),0==o&&G.m("Using bitrate of 0, this stream won't affect progress"),o}function qm(i){this.a=!1,this.b=new E,this.c=i}function um(i){var a=new vm;i.periods.forEach((function(i,o){var s=wm(i.variants);if(0==o)for(var l=(s=t(s.a)).next();!l.done;l=s.next())a.add(l.value);else!function xm(i,a){i.a=i.a.filter((function(i){return ym(a,i)}))}(a,s)}));for(var o=(i=t(i.periods)).next();!o.done;o=i.next())(o=o.value).variants=o.variants.filter((function(i){return ym(a,new zm(i))}))}function zm(i){var a=i.audio;i=i.video,this.b=a?a.mimeType:null,this.a=a?a.codecs.split(".")[0]:null,this.f=i?i.mimeType:null,this.c=i?i.codecs.split(".")[0]:null}function vm(){this.a=[]}function ym(i,a){return i.a.some((function(i){return a.b==i.b&&a.a==i.a&&a.f==i.f&&a.c==i.c}))}function wm(i){for(var a=new vm,o=(i=t(i)).next();!o.done;o=i.next())a.add(new zm(o.value));return a}function Z(i){var a=this;if(i&&i.constructor!=Y)throw new D(2,9,9008);this.b=this.a=null,i?(this.a=i.b,this.b=i.Ub()):(this.a=Ok(),this.b=new L),this.f=!1,this.c=[],this.g=[];var o=!i;this.h=new qm((function(){return u((function f(){var i;return x(f,(function(s){switch(s.j){case 1:return i=function(){},v(s,Promise.all(a.g.map((function(a){return a.then(i,i)}))),2);case 2:if(!o){s.C(3);break}return v(s,a.b.destroy(),3);case 3:a.a=null,a.b=null,w(s)}}))}))}))}function Bm(){if(Hc())e:{for(var i=t(un.values()),a=i.next();!a.done;a=i.next())if(a=(a=a.value)()){a.destroy(),i=!0;break e}i=!1}else i=!1;return i}function Qm(i,a){for(var o=[],s=t(i.periods),l=s.next();!l.done;l=s.next())for(var C=(l=t(l.value.streams)).next();!C.done;C=l.next())C=C.value,a&&"video"==C.contentType?o.push({contentType:Dc(C.mimeType,C.codecs),robustness:i.drmInfo.videoRobustness}):a||"audio"!=C.contentType||o.push({contentType:Dc(C.mimeType,C.codecs),robustness:i.drmInfo.audioRobustness});return o}function Om(i,a,o){return u((function f(){return x(f,(function(s){if(1===s.j)return v(s,function Rm(i,a,o,s){return u((function g(){var l,C,R;return x(g,(function(j){switch(j.j){case 1:return s.drmInfo?(l=function dk(i){var a=Array.from(i.a.keys());if(!a.length)throw new D(2,9,9e3,"No supported storage mechanisms found");return i.a.get(a[0]).getEmeSessionCell()}(o),C=s.sessionIds.map((function(i){return{sessionId:i,keySystem:s.drmInfo.keySystem,licenseUri:s.drmInfo.licenseServerUri,serverCertificate:s.drmInfo.serverCertificate,audioCapabilities:Qm(s,!1),videoCapabilities:Qm(s,!0)}})),v(j,zk(a,i,C),2)):j.return();case 2:return R=j.s,v(j,l.remove(R),3);case 3:return v(j,l.add(C.filter((function(i){return-1==R.indexOf(i.sessionId)}))),0)}}))}))}(i.b,i.a.drm,o,a),0)}))}))}function Pm(i,a,o,s){function f(){R+=1,i.a.offline.progressCallback(j,R/C)}var l=function Sm(i){var a=[];return i.periods.forEach((function(i){i.streams.forEach((function(i){null!=i.initSegmentKey&&a.push(i.initSegmentKey),i.segments.forEach((function(i){a.push(i.dataKey)}))}))})),a}(s),C=l.length+1,R=0,j=lm(o,s);return Promise.all([a.removeSegments(l,f),a.removeManifests([o.key()],f)])}function Ym(i,a,o,s,l,C){var R={id:C.id,originalId:C.originalId,primary:C.primary,presentationTimeOffset:C.presentationTimeOffset||0,contentType:C.type,mimeType:C.mimeType,codecs:C.codecs,frameRate:C.frameRate,pixelAspectRatio:C.pixelAspectRatio,kind:C.kind,language:C.language,label:C.label,width:C.width||null,height:C.height||null,initSegmentKey:null,encrypted:C.encrypted,keyId:C.keyId,segments:[],variantIds:[]};l=l.presentationTimeline.Wb();var j=C.id,U=C.initSegmentReference;return U&&(U=xg(U.c(),U.b,U.a,i.a.streaming.retryParameters),Kj(a,j,U,.5*pm(s,C.id),!0,(function(a){return u((function q(){var s;return x(q,(function(l){switch(l.j){case 1:return v(l,o.addSegments([{data:a}]),2);case 2:s=l.s,i.c.push(s[0]),R.initSegmentKey=s[0],w(l)}}))}))}))),function Zm(i,a,o){for(var s=null==(a=i.findSegmentPosition(a))?null:i.getSegmentReference(a);s;)o(s),s=i.getSegmentReference(++a)}(C,l,(function(l){var U=xg(l.c(),l.b,l.a,i.a.streaming.retryParameters);Kj(a,j,U,function om(i,a,o){return o=o.endTime-o.startTime,pm(i,a)*o}(s,C.id,l),!1,(function(a){return u((function y(){var s;return x(y,(function(C){switch(C.j){case 1:return v(C,o.addSegments([{data:a}]),2);case 2:s=C.s,i.c.push(s[0]),R.segments.push({startTime:l.startTime,endTime:l.endTime,dataKey:s[0]}),w(C)}}))}))}))})),R}function Gm(i){if(i.h.a)throw new D(2,9,7001)}function Em(){if(!Bm())throw new D(2,9,9e3)}function Cm(i,a){return u((function e(){return x(e,(function(o){switch(o.j){case 1:return i.g.push(a),Ca(o,2),v(o,a,4);case 4:return o.return(o.s);case 2:Ha(o),fc(i.g,a),La(o,0)}}))}))}function $m(i){var a=new Set(i.variants.map((function(i){return i.video}))),o=new Set(i.variants.map((function(i){return i.audio})));i=i.textStreams,1<a.size&&G.m("Multiple video tracks selected to be stored");for(var s=(a=t(o)).next();!s.done;s=a.next()){s=s.value;for(var l=t(o),C=l.next();!C.done;C=l.next())s!=(C=C.value)&&s.language==C.language&&G.m("Similar audio tracks were selected to be stored",s.id,C.id)}for(a=(o=t(i)).next();!a.done;a=o.next())for(a=a.value,l=(s=t(i)).next();!l.done;l=s.next())a!=(l=l.value)&&a.language==l.language&&G.m("Similar text tracks were selected to be stored",a.id,l.id)}Y.LoadMode={DESTROYED:Jn,NOT_LOADED:ui,MEDIA_SOURCE:ci,SRC_EQUALS:di},qm.prototype.destroy=function(){var i=this;return this.a?this.b:(this.a=!0,this.c().then((function(){i.b.resolve()}),(function(){i.b.resolve()})))},vm.prototype.add=function(i){ym(this,i)||this.a.push(i)},A("shaka.offline.Storage",Z),Z.support=Bm,Z.prototype.destroy=function(){return this.h.destroy()},Z.prototype.destroy=Z.prototype.destroy,Z.prototype.configure=function(i,a){2==arguments.length&&"string"==typeof i&&(i=Mk(i,a));var o=i,s=!1;return null!=o.trackSelectionCallback&&(s=!0,o.offline=o.offline||{},o.offline.trackSelectionCallback=o.trackSelectionCallback,delete o.trackSelectionCallback),null!=o.progressCallback&&(s=!0,o.offline=o.offline||{},o.offline.progressCallback=o.progressCallback,delete o.progressCallback),null!=o.usePersistentLicense&&(s=!0,o.offline=o.offline||{},o.offline.usePersistentLicense=o.usePersistentLicense,delete o.usePersistentLicense),s&&De("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Qk(this.a,i)},Z.prototype.configure=Z.prototype.configure,Z.prototype.getConfiguration=function(){var i=Ok();return Qk(i,this.a,Ok()),i},Z.prototype.getConfiguration=Z.prototype.getConfiguration,Z.prototype.Ub=function(){return this.b},Z.prototype.getNetworkingEngine=Z.prototype.Ub,Z.prototype.store=function(i,a,o){var s=this;return Cm(this,function Dm(i,a,o,s){return u((function g(){var l,C,R,j,U,_,O,B,F;return x(g,(function(H){switch(H.j){case 1:return Em(),i.f?H.return(Promise.reject(new D(2,9,9006))):(i.f=!0,v(H,function Fm(i,a,o){return u((function f(){var s,l,C,R,j,U;return x(f,(function(_){switch(_.j){case 1:return s=null,l=i.b,C={networkingEngine:l,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(i){s=i}},v(_,o(),2);case 2:return(R=_.s).configure(i.a.manifest),Gm(i),Ca(_,3),v(_,R.start(a,C),5);case 5:return j=_.s,Gm(i),U=function Vm(i){for(var a=new Set,o=(i=t(i.periods)).next();!o.done;o=i.next()){for(var s=t((o=o.value).textStreams),l=s.next();!l.done;l=s.next())a.add(l.value);for(s=(o=t(o.variants)).next();!s.done;s=o.next())(s=s.value).audio&&a.add(s.audio),s.video&&a.add(s.video)}return a}(j),v(_,Promise.all(zc(U,(function(i){return i.createSegmentIndex()}))),6);case 6:if(Gm(i),s)throw s;return _.return(j);case 3:return Ha(_),v(_,R.stop(),7);case 7:La(_,0)}}))}))}(i,a,s),2));case 2:if(l=H.s,Gm(i),!(!l.presentationTimeline.X()&&!l.presentationTimeline.bb()))throw new D(2,9,9005,a);return C=null,R=new Xj,U=j=null,Ba(H,3,4),v(H,function Hm(i,a,o){return u((function f(){var s,l,C;return x(f,(function(R){switch(R.j){case 1:return s=new Qc({Db:i.b,onError:o,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),l=ni(a.periods),C=i.a,s.configure(C.drm),v(R,function Vc(i,a,o){return i.w=[],i.G=o,Wc(i,a)}(s,l,C.offline.usePersistentLicense),2);case 2:return v(R,ed(s),3);case 3:return v(R,fd(s),4);case 4:return R.return(s)}}))}))}(i,l,(function(i){U=U||i})),6);case 6:if(C=H.s,Gm(i),U)throw U;return v(H,function Im(i,a,o){return u((function f(){var s,l;return x(f,(function(C){switch(C.j){case 1:return s={width:1/0,height:1/0},function rm(i,a,o){for(var s=(i=t(i.periods)).next();!s.done;s=i.next())(s=s.value).variants=s.variants.filter((function(i){return vt.ld(i,a,o)}))}(a,i.a.restrictions,s),function sm(i){for(var a=(i=t(i.periods)).next();!a.done;a=i.next())(a=a.value).variants=a.variants.filter((function(i){var a=!0;return i.audio&&(a=a&&ie(i.audio)),i.video&&(a=a&&ie(i.video)),a}))}(a),function tm(i,a){for(var o=t(i.periods),s=o.next();!s.done;s=o.next())(s=s.value).variants=s.variants.filter((function(i){return xd(a,i)}))}(a,o),um(a),l=i.a.preferredAudioChannelCount,vt.Vd(a,l),v(C,function Am(i,a){return u((function e(){var o,s,l,C;return x(e,(function(R){switch(R.j){case 1:o=null,s=t(i.periods),l=s.next();case 2:if(l.done){R.C(0);break}return C=l.value,o&&(C.variants=C.variants.filter((function(i){return ym(o,new zm(i))}))),v(R,a(C),5);case 5:o=wm(C.variants),l=s.next(),R.C(2)}}))}))}(a,(function(a){return u((function p(){var o,s,l,C,R,j,U,_;return x(p,(function(O){switch(O.j){case 1:o=vt,s=[];for(var B=t(a.variants),F=B.next();!F.done;F=B.next())l=F.value,s.push(o.Qd(l));for(F=(B=t(a.textStreams)).next();!F.done;F=B.next())C=F.value,s.push(o.Fc(C));return v(O,i.a.offline.trackSelectionCallback(s),2);case 2:for(R=O.s,j=new Set,U=new Set,F=(B=t(R)).next();!F.done;F=B.next())"variant"==(_=F.value).type&&j.add(_.id),"text"==_.type&&U.add(_.id);a.variants=a.variants.filter((function(i){return j.has(i.id)})),a.textStreams=a.textStreams.filter((function(i){return U.has(i.id)})),w(O)}}))}))})),2);case 2:(function Km(i){if(0==i.periods.length)throw new D(2,4,4014);for(var a=(i=t(i.periods)).next();!a.done;a=i.next())$m(a.value)})(a),w(C)}}))}))}(i,l,C),7);case 7:return v(H,R.init(),8);case 8:return Gm(i),v(H,function Zj(i){var a=null;if(i.a.forEach((function(i,o){i.getCells().forEach((function(i,s){i.hasFixedKeySpace()||a||(a={path:{Aa:o,fa:s},fa:i})}))})),a)return a;throw new D(2,9,9013,"Could not find a cell that supports add-operations")}(R),9);case 9:return j=H.s,Gm(i),v(H,function Jm(i,a,o,s,l,C){return u((function k(){var R,j,U,_,O,B,F,H,G,W;return x(k,(function($){switch($.j){case 1:return R=function jm(i,a,o){var s=null==a.expiration?1/0:a.expiration;return{offlineUri:null,originalManifestUri:i,duration:a.presentationTimeline.ca(),size:0,expiration:s,tracks:a=km(a.periods[0]),appMetadata:o}}(l,s,C),j=s.periods.some((function(i){return i.variants.some((function(i){return i.drmInfos&&i.drmInfos.length}))})),U=s.periods.some((function(i){return i.variants.some((function(i){return i.drmInfos.some((function(i){return i.initData&&i.initData.length}))}))})),O=null,(_=j&&!U)&&(B=o.a,O=Mi.get(B.keySystem)),F=new Jj(i.b,(function(a,o){R.size=o,i.a.offline.progressCallback(R,a)}),(function(a,s){_&&i.a.offline.usePersistentLicense&&O==s&&gd(o,"cenc",a)})),Ca($,2),G=H=function Mm(i,a,o,s,l,C,R){var j=new mm,U=l.periods.map((function(s){return function Wm(i,a,o,s,l,C){for(var R=t(C.variants),j=R.next();!j.done;j=R.next())nm(s,j.value);for(R=t(C.textStreams),j=R.next();!j.done;j=R.next())s.a[j.value.id]=52;R=function Xm(i){for(var a=new Set,o=t(i.textStreams),s=o.next();!s.done;s=o.next())a.add(s.value);for(i=t(i.variants),o=i.next();!o.done;o=i.next())(o=o.value).audio&&a.add(o.audio),o.video&&a.add(o.video);return a}(C);var U=new Map;for(R=t(R),j=R.next();!j.done;j=R.next()){var _=Ym(i,a,o,s,l,j=j.value);U.set(j.id,_)}return C.variants.forEach((function(i){i.audio&&U.get(i.audio.id).variantIds.push(i.id),i.video&&U.get(i.video.id).variantIds.push(i.id)})),{startTime:C.startTime,streams:Array.from(U.values())}}(i,a,o,j,l,s)})),_=s.a,O=i.a.offline.usePersistentLicense;return _&&O&&(_.initData=[]),{originalManifestUri:C,duration:l.presentationTimeline.ca(),size:0,expiration:s.Tb(),periods:U,sessionIds:O?md(s):[],drmInfo:_,appMetadata:R}}(i,F,a,o,s,l,C),v($,function Mj(i){return u((function d(){return x(d,(function(a){switch(a.j){case 1:return v(a,Promise.all(i.b.values()),2);case 2:return a.return(i.a.a)}}))}))}(F),4);case 4:if(G.size=$.s,H.expiration=o.Tb(),W=md(o),H.sessionIds=i.a.offline.usePersistentLicense?W:[],j&&i.a.offline.usePersistentLicense&&!W.length)throw new D(2,9,9007);return $.return(H);case 2:return Ha($),v($,F.destroy(),5);case 5:La($,0)}}))}))}(i,j.fa,C,l,a,o),10);case 10:if(_=H.s,Gm(i),U)throw U;return v(H,j.fa.addManifests([_]),11);case 11:return O=H.s,Gm(i),B=new ok("manifest",j.path.Aa,j.path.fa,O[0]),H.return(lm(B,_));case 4:return Ha(H),i.f=!1,i.c=[],v(H,R.destroy(),12);case 12:if(!C){H.C(13);break}return v(H,C.destroy(),13);case 13:La(H,0);break;case 3:if(F=Ga(H),!j){H.C(15);break}return v(H,j.fa.removeSegments(i.c,(function(){})),15);case 15:throw U||F}}))}))}(this,i,a||{},(function(){return u((function g(){var a,l;return x(g,(function(C){switch(C.j){case 1:return o&&"string"!=typeof o?(De("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),a=o,C.return(new a)):v(C,Kt.create(i,s.b,s.a.manifest.retryParameters,o),2);case 2:return l=C.s,C.return(l)}}))}))})))},Z.prototype.store=Z.prototype.store,Z.prototype.zf=function(){return this.f},Z.prototype.getStoreInProgress=Z.prototype.zf,Z.prototype.remove=function(i){return Cm(this,function Nm(i,a){return u((function e(){var o,s,l,C,R,j;return x(e,(function(U){switch(U.j){case 1:return Em(),null==(o=pk(a))||"manifest"!=o.a?U.return(Promise.reject(new D(2,9,9004,a))):(s=o,l=new Xj,Ca(U,2),v(U,l.init(),4));case 4:return v(U,bk(l,s.Aa(),s.fa()),5);case 5:return v(U,(C=U.s).getManifests([s.key()]),6);case 6:return R=U.s,j=R[0],v(U,Promise.all([Om(i,j,l),Pm(i,C,s,j)]),2);case 2:return Ha(U),v(U,l.destroy(),8);case 8:La(U,0)}}))}))}(this,i))},Z.prototype.remove=Z.prototype.remove,Z.prototype.jg=function(){return Cm(this,function Tm(i){return u((function d(){var a,o,s,l,C,R,j,U,_;return x(d,(function(O){switch(O.j){case 1:return Em(),a=i.b,o=i.a.drm,s=new Xj,l=!1,Ca(O,2),v(O,s.init(),4);case 4:for(C=[],function ck(i,a){i.a.forEach((function(i){a(i.getEmeSessionCell())}))}(s,(function(i){return C.push(i)})),R=Promise.resolve(),j={},U=t(C),_=U.next();!_.done;j={Ec:j.Ec},_=U.next())j.Ec=_.value,R=R.then(function(i){return function(){return u((function z(){var s,C;return x(z,(function(R){switch(R.j){case 1:return v(R,i.Ec.getAll(),2);case 2:return s=R.s,v(R,zk(o,a,s),3);case 3:return C=R.s,v(R,i.Ec.remove(C),4);case 4:C.length!=s.length&&(l=!0),w(R)}}))}))}}(j));return v(O,R,2);case 2:return Ha(O),v(O,s.destroy(),6);case 6:La(O,3);break;case 3:return O.return(!l)}}))}))}(this))},Z.prototype.removeEmeSessions=Z.prototype.jg,Z.prototype.list=function(){return Cm(this,function Um(){return u((function c(){var i,a,o;return x(c,(function(s){switch(s.j){case 1:return Em(),i=[],a=new Xj,Ca(s,2),v(s,a.init(),4);case 4:return o=Promise.resolve(),function ak(i,a){i.a.forEach((function(i,o){i.getCells().forEach((function(i,s){a({Aa:o,fa:s},i)}))}))}(a,(function(a,s){o=o.then((function(){return u((function n(){return x(n,(function(o){switch(o.j){case 1:return v(o,s.getAllManifests(),2);case 2:o.s.forEach((function(o,s){var l=lm(new ok("manifest",a.Aa,a.fa,s),o);i.push(l)})),w(o)}}))}))}))})),v(s,o,2);case 2:return Ha(s),v(s,a.destroy(),6);case 6:La(s,3);break;case 3:return s.return(i)}}))}))}())},Z.prototype.list=Z.prototype.list,Z.deleteAll=function(){return u((function c(){var i;return x(c,(function(a){switch(a.j){case 1:return i=new Xj,Ca(a,2),v(a,i.erase(),2);case 2:return Ha(a),v(a,i.destroy(),5);case 5:La(a,0)}}))}))};var Mi=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");Vn.offline=Bm,A("shaka.polyfill.installAll",(function(){for(var i=0;i<Oi.length;++i)try{Oi[i].Re()}catch(i){G.Z("Error installing polyfill!",i)}}));var Ni,_i,Oi=[];function bn(i,a){for(var o={priority:a=a||0,Re:i},s=0;s<Oi.length;s++)if(Oi[s].priority<a)return void Oi.splice(s,0,o);Oi.push(o)}function dn(i){var a=i.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var o=new Event(a,i);else(o=document.createEvent("Event")).initEvent(a,i.bubbles,i.cancelable);i.target.dispatchEvent(o)}function en(i,a,o){if("input"==i&&"range"===this.type)i="change";HTMLInputElement.prototype.originalAddEventListener.call(this,i,a,o)}function fn(){var i=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(a){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return(o=i.apply(this,o)).abort=function(){},o}}function ln(i,a){G.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var o=new mn(i,a);return Promise.resolve(o)}catch(i){return Promise.reject(i)}}function mn(i,a){if(G.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=i,i.startsWith("com.apple.fps"))for(var o=t(a),s=o.next();!s.done;s=o.next()){var l=s.value;if("required"==l.persistentState)s=null;else{s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label};var C=!1,R=!1;if(l.audioCapabilities)for(var j=t(l.audioCapabilities),U=j.next();!U.done;U=j.next())if((U=U.value).contentType){C=!0;var _=U.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,_)&&(s.audioCapabilities.push(U),R=!0)}if(l.videoCapabilities)for(U=(l=t(l.videoCapabilities)).next();!U.done;U=l.next())(j=U.value).contentType&&(C=!0,U=j.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,U)&&(s.videoCapabilities.push(j),R=!0));C||(R=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),s=R?s:null}if(s)return void(this.a=s)}throw(o=Error("Unsupported keySystem")).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,o}function on(i){G.debug("PatchedMediaKeysApple.setMediaKeys");var a=this.mediaKeys;return a&&a!=i&&pn(a,null),delete this.mediaKeys,(this.mediaKeys=i)?pn(i,this):Promise.resolve()}function nn(i){G.debug("PatchedMediaKeysApple.MediaKeys"),this.b=new WebKitMediaKeys(i),this.a=new M}function pn(i,a){if(i.a.hb(),!a)return Promise.resolve();i.a.B(a,"webkitneedkey",rn);try{return ti(a,HTMLMediaElement.HAVE_METADATA,i.a,(function(){a.webkitSetMediaKeys(i.b)})),Promise.resolve()}catch(i){return Promise.reject(i)}}function qn(i){G.debug("PatchedMediaKeysApple.MediaKeySession"),bc.call(this),this.b=null,this.g=i,this.c=this.a=null,this.f=new M,this.sessionId="",this.expiration=NaN,this.closed=new E,this.keyStatuses=new sn}function rn(i){if(G.debug("PatchedMediaKeysApple.onWebkitNeedKey_",i),i=new Uint8Array(i.initData),new DataView(i.buffer,i.byteOffset,i.byteLength).getUint32(0,!0)+4!=i.byteLength)throw new RangeError("Malformed FairPlay init data");i=Kb(i=Ib(i.subarray(4),!0));var a=new Event("encrypted");a.initDataType="skd",a.initData=i,this.dispatchEvent(a)}function tn(i,a){var o=i.keyStatuses;o.size=null==a?0:1,o.a=a,i.dispatchEvent(new K("keystatuseschange"))}function sn(){this.size=0,this.a=void 0}function vn(i,a){G.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var o=new wn(i,a);return Promise.resolve(o)}catch(i){return Promise.reject(i)}}function wn(i,a){G.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=i;for(var o=!1,s=0;s<a.length;++s){var l=a[s],C={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label},R=!1;if(l.audioCapabilities)for(var j=0;j<l.audioCapabilities.length;++j){var U=l.audioCapabilities[j];if(U.contentType){R=!0;var _=U.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,_)&&(C.audioCapabilities.push(U),o=!0)}}if(l.videoCapabilities)for(j=0;j<l.videoCapabilities.length;++j)(U=l.videoCapabilities[j]).contentType&&(R=!0,_=U.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,_)&&(C.videoCapabilities.push(U),o=!0));if(R||(o=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==l.persistentState&&(o=!1),o)return void(this.a=C)}throw(o=Error("Unsupported keySystem")).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,o}function yn(i){G.debug("PatchedMediaKeysMs.setMediaKeys");var a=this.mediaKeys;return a&&a!=i&&zn(a,null),delete this.mediaKeys,(this.mediaKeys=i)?zn(i,this):Promise.resolve()}function xn(i){G.debug("PatchedMediaKeysMs.MediaKeys"),this.b=new MSMediaKeys(i),this.a=new M}function zn(i,a){if(i.a.hb(),!a)return Promise.resolve();i.a.B(a,"msneedkey",Bn);try{return ti(a,HTMLMediaElement.HAVE_METADATA,i.a,(function(){a.msSetMediaKeys(i.b)})),Promise.resolve()}catch(i){return Promise.reject(i)}}function An(i){G.debug("PatchedMediaKeysMs.MediaKeySession"),bc.call(this),this.c=null,this.g=i,this.b=this.a=null,this.f=new M,this.sessionId="",this.expiration=NaN,this.closed=new E,this.keyStatuses=new Cn}function Bn(i){if(G.debug("PatchedMediaKeysMs.onMsNeedKey_",i),i.initData){var a=document.createEvent("CustomEvent");a.initCustomEvent("encrypted",!1,!1,null),a.initDataType="cenc",a.initData=function Hf(i){if(!i)return i;var a=new Gf(i);if(1>=a.data.length)return i;i=[];for(var o={},s=(a=t(a.data)).next();!s.done;o={tc:o.tc},s=a.next())o.tc=s.value,i.some(function(i){return function(a){return Le.Da(a,i.tc)}}(o))||i.push(o.tc);return Le.concat.apply(Le,i instanceof Array?i:function Sa(i){for(var a,o=[];!(a=i.next()).done;)o.push(a.value);return o}(t(i)))}(i.initData).buffer,this.dispatchEvent(a)}}function Dn(i,a){var o=i.keyStatuses;o.size=null==a?0:1,o.a=a,i.dispatchEvent(new K("keystatuseschange"))}function Cn(){this.size=0,this.a=void 0}function Fn(){return G.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function Gn(i){return G.debug("PatchedMediaKeysNop.setMediaKeys"),null==i?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Hn(){throw new TypeError("Illegal constructor.")}function In(){throw new TypeError("Illegal constructor.")}A("shaka.polyfill.register",bn),bn((function(){cn()}),-1),bn((function(){if(i.Document){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen,(a=Document.prototype).exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",dn),document.addEventListener("webkitfullscreenerror",dn),document.addEventListener("mozfullscreenchange",dn),document.addEventListener("mozfullscreenerror",dn),document.addEventListener("MSFullscreenChange",dn),document.addEventListener("MSFullscreenError",dn)}})),bn((function(){G.debug("InputEvent.install"),Lc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(G.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=en)})),bn((function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})})),bn((function(){G.debug("mathRound.install")})),bn((function(){G.debug("MediaSource.install");var a=Nc();i.MediaSource?i.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(G.info("Patching Chromecast MSE bugs."),function kn(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(a){var o=a.split(/ *; */);return o.shift(),o.some((function(i){return i.startsWith("codecs=")}))?cast.__platform__.canDisplayType(a):i(a)}}()):a?(function hn(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(a){return"mp2t"!=a.split(/ *; */)[0].split("/")[1].toLowerCase()&&i(a)}}(),12>=a?(G.info("Patching Safari 11 & 12 MSE bugs."),fn(),function gn(){var i=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(a,o){return i.call(this,a,o-.001)}}()):(G.info("Patching Safari 13 MSE bugs."),fn())):Lc("Tizen 2")||Lc("Tizen 3")||Lc("Tizen 4")?function jn(){var i=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(a){return"opus"!=Gc(a)[0]&&i(a)}}():G.info("Using native MSE as-is."):G.info("No MSE implementation available.")})),mn.prototype.createMediaKeys=function(){G.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var i=new nn(this.keySystem);return Promise.resolve(i)},mn.prototype.getConfiguration=function(){return G.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.a},nn.prototype.createSession=function(i){if(G.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(i=i||"temporary"))throw new TypeError("Session type "+i+" is unsupported on this platform.");return new qn(this.b,i)},nn.prototype.setServerCertificate=function(i){return G.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),i&&new Uint8Array(i),Promise.resolve(!0)},bb(qn,bc),(s=qn.prototype).generateRequest=function(i,a){G.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.a=new E;try{this.b=this.g.createSession("video/mp4",new Uint8Array(a)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.yg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.wg.bind(this)),this.f.B(this.b,"webkitkeyerror",this.xg.bind(this)),tn(this,"status-pending")}catch(i){this.a.reject(i)}return this.a},s.load=function(){return G.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},s.update=function(i){G.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.c=new E;try{this.b.update(new Uint8Array(i))}catch(i){this.c.reject(i)}return this.c},s.close=function(){G.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(i){this.closed.reject(i)}return this.closed},s.remove=function(){return G.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},s.yg=function(i){G.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",i),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new K("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:i.message.buffer}))},s.wg=function(i){G.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",i),this.c&&(tn(this,"usable"),this.c.resolve(),this.c=null)},s.xg=function(i){if(G.debug("PatchedMediaKeysApple.onWebkitKeyError_",i),(i=Error("EME PatchedMediaKeysApple key error")).errorCode=this.b.error,null!=this.a)this.a.reject(i),this.a=null;else if(null!=this.c)this.c.reject(i),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:tn(this,"output-not-allowed");break;default:tn(this,"internal-error")}},(s=sn.prototype).forEach=function(i){this.a&&i(this.a,Ni)},s.get=function(i){if(this.has(i))return this.a},s.has=function(i){var a=Ni;return!(!this.a||!Le.Da(new Uint8Array(i),new Uint8Array(a)))},s.entries=function(){},s.keys=function(){},s.values=function(){},bn((function(){i.HTMLVideoElement&&i.WebKitMediaKeys&&(G.info("Using Apple-prefixed EME"),Ni=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=on,i.MediaKeys=nn,i.MediaKeySystemAccess=mn,navigator.requestMediaKeySystemAccess=ln)})),wn.prototype.createMediaKeys=function(){G.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var i=new xn(this.keySystem);return Promise.resolve(i)},wn.prototype.getConfiguration=function(){return G.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.a},xn.prototype.createSession=function(i){if(G.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(i=i||"temporary"))throw new TypeError("Session type "+i+" is unsupported on this platform.");return new An(this.b,i)},xn.prototype.setServerCertificate=function(){return G.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},bb(An,bc),(s=An.prototype).generateRequest=function(i,a){G.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(a),null),this.f.B(this.c,"mskeymessage",this.Vf.bind(this)),this.f.B(this.c,"mskeyadded",this.Tf.bind(this)),this.f.B(this.c,"mskeyerror",this.Uf.bind(this)),Dn(this,"status-pending")}catch(i){this.a.reject(i)}return this.a},s.load=function(){return G.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},s.update=function(i){G.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.b=new E;try{this.c.update(new Uint8Array(i))}catch(i){this.b.reject(i)}return this.b},s.close=function(){G.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(i){this.closed.reject(i)}return this.closed},s.remove=function(){return G.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},s.Vf=function(i){G.debug("PatchedMediaKeysMs.onMsKeyMessage_",i),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new K("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:i.message.buffer}))},s.Tf=function(i){G.debug("PatchedMediaKeysMs.onMsKeyAdded_",i),this.a?(G.debug("Simulating completion for a PR persistent license."),Dn(this,"usable"),this.a.resolve(),this.a=null):this.b&&(Dn(this,"usable"),this.b.resolve(),this.b=null)},s.Uf=function(i){if(G.debug("PatchedMediaKeysMs.onMsKeyError_",i),(i=Error("EME PatchedMediaKeysMs key error")).errorCode=this.c.error,null!=this.a)this.a.reject(i),this.a=null;else if(null!=this.b)this.b.reject(i),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Dn(this,"output-not-allowed");break;default:Dn(this,"internal-error")}},(s=Cn.prototype).forEach=function(i){this.a&&i(this.a,_i)},s.get=function(i){if(this.has(i))return this.a},s.has=function(i){var a=_i;return!(!this.a||!Le.Da(new Uint8Array(i),new Uint8Array(a)))},s.entries=function(){},s.keys=function(){},s.values=function(){},bn((function(){!i.HTMLVideoElement||!i.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(G.info("Using ms-prefixed EME v20140218"),_i=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=yn,i.MediaKeys=xn,i.MediaKeySystemAccess=wn,navigator.requestMediaKeySystemAccess=vn)})),Hn.prototype.createSession=function(){},Hn.prototype.setServerCertificate=function(){},In.prototype.getConfiguration=function(){},In.prototype.createMediaKeys=function(){},bn((function(){!i.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(G.info("EME not available."),navigator.requestMediaKeySystemAccess=Fn,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Gn,i.MediaKeys=Hn,i.MediaKeySystemAccess=In)}),-10);var er,tr="";function Kn(i){return tr?tr+i.charAt(0).toUpperCase()+i.slice(1):i}function Ln(i,a){G.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var o=new Mn(i,a);return Promise.resolve(o)}catch(i){return Promise.reject(i)}}function Nn(i){G.debug("PatchedMediaKeysWebkit.setMediaKeys");var a=this.mediaKeys;return a&&a!=i&&On(a,null),delete this.mediaKeys,(this.mediaKeys=i)&&On(i,this),Promise.resolve()}function Mn(i,a){G.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.a=this.keySystem=i;var o=!1;"org.w3.clearkey"==i&&(this.a="webkit-org.w3.clearkey",o=!1);var s=!1,l=document.getElementsByTagName("video");l=l.length?l[0]:document.createElement("video");for(var C=0;C<a.length;++C){var R=a[C],j={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:R.initDataTypes,sessionTypes:["temporary"],label:R.label},U=!1;if(R.audioCapabilities)for(var _=0;_<R.audioCapabilities.length;++_){var O=R.audioCapabilities[_];if(O.contentType){U=!0;var B=O.contentType.split(";")[0];l.canPlayType(B,this.a)&&(j.audioCapabilities.push(O),s=!0)}}if(R.videoCapabilities)for(_=0;_<R.videoCapabilities.length;++_)(O=R.videoCapabilities[_]).contentType&&(U=!0,l.canPlayType(O.contentType,this.a)&&(j.videoCapabilities.push(O),s=!0));if(U||(s=l.canPlayType("video/mp4",this.a)||l.canPlayType("video/webm",this.a)),"required"==R.persistentState&&(o?(j.persistentState="required",j.sessionTypes=["persistent-license"]):s=!1),s)return void(this.b=j)}throw o="Unsupported keySystem","org.w3.clearkey"!=i&&"com.widevine.alpha"!=i||(o="None of the requested configurations were supported."),(o=Error(o)).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,o}function Pn(i){G.debug("PatchedMediaKeysWebkit.MediaKeys"),this.g=i,this.b=null,this.a=new M,this.c=[],this.f={}}function On(i,a){i.b=a,i.a.hb();var o=tr;a&&(i.a.B(a,o+"needkey",i.Zf.bind(i)),i.a.B(a,o+"keymessage",i.Bg.bind(i)),i.a.B(a,o+"keyadded",i.zg.bind(i)),i.a.B(a,o+"keyerror",i.Ag.bind(i)))}function Rn(i,a){var o=i.f[a];return o?(G.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",o),o):(o=i.c.shift())?(o.sessionId=a,i.f[a]=o,G.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",o),o):null}function Qn(i,a,o){G.debug("PatchedMediaKeysWebkit.MediaKeySession"),bc.call(this),this.f=i,this.h=!1,this.a=this.b=null,this.c=a,this.g=o,this.sessionId="",this.expiration=NaN,this.closed=new E,this.keyStatuses=new Tn}function Un(i,a,o){if(i.h)return Promise.reject(Error("The session is already initialized."));i.h=!0;try{if("persistent-license"==i.g)if(o)var s=new Uint8Array(Kb("LOAD_SESSION|"+o));else{var l=Kb("PERSISTENT|"),C=new Uint8Array(l.byteLength+a.byteLength);C.set(new Uint8Array(l),0),C.set(new Uint8Array(a),l.byteLength),s=C}else s=new Uint8Array(a)}catch(i){return Promise.reject(i)}i.b=new E;var R=Kn("generateKeyRequest");try{i.f[R](i.c,s)}catch(a){if("InvalidStateError"!=a.name)return i.b=null,Promise.reject(a);new I((function(){try{i.f[R](i.c,s)}catch(a){i.b.reject(a),i.b=null}})).R(.01)}return i.b}function Sn(i,a){var o=i.keyStatuses;o.size=null==a?0:1,o.a=a,i.dispatchEvent(new K("keystatuseschange"))}function Tn(){this.size=0,this.a=void 0}function Wn(i){if("picture-in-picture"==(i=i.target).webkitPresentationMode){document.pictureInPictureElement=i;var a=new Event("enterpictureinpicture");i.dispatchEvent(a)}else document.pictureInPictureElement==i&&(document.pictureInPictureElement=null),a=new Event("leavepictureinpicture"),i.dispatchEvent(a)}function Xn(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Yn(){var i=document.pictureInPictureElement;return i?(i.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Zn(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function $n(i){i?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function ao(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function bo(a,o,s){return new i.TextTrackCue(a,o,s)}function co(a,o,s){return new i.TextTrackCue(a+"-"+o+"-"+s,a,o,s)}function eo(){}Mn.prototype.createMediaKeys=function(){G.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var i=new Pn(this.a);return Promise.resolve(i)},Mn.prototype.getConfiguration=function(){return G.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.b},(s=Pn.prototype).createSession=function(i){if(G.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(i=i||"temporary")&&"persistent-license"!=i)throw new TypeError("Session type "+i+" is unsupported on this platform.");var a=this.b||document.createElement("video");return a.src||(a.src="about:blank"),i=new Qn(a,this.g,i),this.c.push(i),i},s.setServerCertificate=function(){return G.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},s.Zf=function(i){G.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",i);var a=document.createEvent("CustomEvent");a.initCustomEvent("encrypted",!1,!1,null),a.initDataType="cenc",i.initData instanceof ArrayBuffer?a.initData=i.initData:a.initData=i.initData.buffer,this.b.dispatchEvent(a)},s.Bg=function(i){G.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",i);var a=Rn(this,i.sessionId);a?(i=new K("message",{messageType:null==a.keyStatuses.a?"licenserequest":"licenserenewal",message:i.message}),G.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),a.b&&(a.b.resolve(),a.b=null),a.dispatchEvent(i)):G.error("Session not found",i.sessionId)},s.zg=function(i){G.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",i),(i=Rn(this,i.sessionId))&&(G.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Sn(i,"usable"),i.a&&i.a.resolve(),i.a=null)},s.Ag=function(i){G.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",i);var a=Rn(this,i.sessionId);a&&a.handleError(i)},bb(Qn,bc),(s=Qn.prototype).handleError=function(i){G.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",i);var a=Error("EME v0.1b key error"),o=i.errorCode;o.systemCode=i.systemCode,a.errorCode=o,!i.sessionId&&this.b?(45==i.systemCode&&(a.message="Unsupported session type."),this.b.reject(a),this.b=null):i.sessionId&&this.a?(this.a.reject(a),this.a=null):(a=i.systemCode,i.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Sn(this,"output-restricted"):Sn(this,1==a?"expired":"internal-error"))},s.Kd=function(i,a){if(this.a)this.a.then(this.Kd.bind(this,i,a)).catch(this.Kd.bind(this,i,a));else{if(this.a=i,"webkit-org.w3.clearkey"==this.c){var o=Gb(a),s=JSON.parse(o);"oct"!=s.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),o=Le.Fa(s.keys[0].k),s=Le.Fa(s.keys[0].kid)}else o=new Uint8Array(a),s=null;var l=Kn("addKey");try{this.f[l](this.c,o,s,this.sessionId)}catch(i){this.a.reject(i),this.a=null}}},s.generateRequest=function(i,a){return G.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Un(this,a,null)},s.load=function(i){return G.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.g?Un(this,null,i):Promise.reject(Error("Not a persistent session."))},s.update=function(i){G.debug("PatchedMediaKeysWebkit.MediaKeySession.update",i);var a=new E;return this.Kd(a,i),a},s.close=function(){if(G.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var i=Kn("cancelKeyRequest");try{this.f[i](this.c,this.sessionId)}catch(i){}}return this.closed.resolve(),this.closed},s.remove=function(){return G.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(s=Tn.prototype).forEach=function(i){this.a&&i(this.a,er)},s.get=function(i){if(this.has(i))return this.a},s.has=function(i){var a=er;return!(!this.a||!Le.Da(new Uint8Array(i),new Uint8Array(a)))},s.entries=function(){},s.keys=function(){},s.values=function(){},bn((function(){if(!(!i.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)G.info("Using webkit-prefixed EME v0.1b"),tr="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;G.info("Using nonprefixed EME v0.1b")}er=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Ln,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Nn,i.MediaKeys=Pn,i.MediaKeySystemAccess=Mn}})),bn((function(){if(i.HTMLVideoElement){var a=HTMLVideoElement.prototype;a.requestPictureInPicture&&document.exitPictureInPicture||!a.webkitSupportsPresentationMode||(G.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,a.requestPictureInPicture=Xn,Object.defineProperty(a,"disablePictureInPicture",{get:Zn,set:$n,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Yn,document.addEventListener("webkitpresentationmodechanged",Wn,!0))}})),bn((function(){if(G.debug("VideoPlayPromise.install"),i.HTMLMediaElement){var a=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var i=a.apply(this);return i&&i.catch((function(){})),i}}})),bn((function(){if(i.HTMLVideoElement){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=ao)}})),bn((function(){if(i.VTTCue)G.info("Using native VTTCue.");else if(i.TextTrackCue){var a=TextTrackCue.length;if(3==a)G.info("Using VTTCue polyfill from 3 argument TextTrackCue."),i.VTTCue=bo;else if(6==a)G.info("Using VTTCue polyfill from 6 argument TextTrackCue."),i.VTTCue=co;else{try{var o=!!bo(1,2,"")}catch(i){o=!1}o&&(G.info("Using VTTCue polyfill from 3 argument TextTrackCue."),i.VTTCue=bo)}}else G.error("VTTCue not available.")})),A("shaka.text.TtmlTextParser",eo),eo.prototype.parseInit=function(){},eo.prototype.parseInit=eo.prototype.parseInit,eo.prototype.parseMedia=function(i,a){var o=Gb(i),s=[],l=new DOMParser,C=null;if(""==o)return s;try{C=l.parseFromString(o,"text/xml")}catch(i){throw new D(2,2,2005,"Failed to parse TTML.")}if(C){if(o=C.getElementsByTagName("parsererror")[0])throw new D(2,2,2005,o.textContent);if(!(l=C.getElementsByTagName("tt")[0]))throw new D(2,2,2005,"TTML does not contain <tt> tag.");var R=Lt.getAttributeNS(l,"http://www.w3.org/ns/ttml#parameter","frameRate"),j=Lt.getAttributeNS(l,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),U=Lt.getAttributeNS(l,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),_=Lt.getAttributeNS(l,"http://www.w3.org/ns/ttml#parameter","tickRate");if(C=l.getAttribute("xml:space")||"default",o=Lt.getAttributeNS(l,"http://www.w3.org/ns/ttml#styling","extent"),"default"!=C&&"preserve"!=C)throw new D(2,2,2005,"Invalid xml:space value: "+C);C="default"==C,R=new fo(R,j,U,_),j=go(l.getElementsByTagName("metadata")[0]),U=go(l.getElementsByTagName("styling")[0]),_=go(l.getElementsByTagName("layout")[0]);for(var O=[],B=0;B<_.length;B++){var F,H,W=_[B],$=U,he=o,ye=new Jd,Ee=W.getAttribute("xml:id");if(Ee)ye.id=Ee,Ee=null,he&&(Ee=rr.exec(he)||or.exec(he)),he=Ee?Number(Ee[1]):null,Ee=Ee?Number(Ee[2]):null,(F=jo(W,$,"extent"))&&(null!=(F=(H=rr.exec(F))||or.exec(F))&&(ye.width=null!=he?100*Number(F[1])/he:Number(F[1]),ye.height=null!=Ee?100*Number(F[2])/Ee:Number(F[2]),ye.widthUnits=H||null!=he?dt:0,ye.heightUnits=H||null!=Ee?dt:0)),(W=jo(W,$,"origin"))&&(null!=(F=(H=rr.exec(W))||or.exec(W))&&(ye.viewportAnchorX=null!=he?100*Number(F[1])/he:Number(F[1]),ye.viewportAnchorY=null!=Ee?100*Number(F[2])/Ee:Number(F[2]),ye.viewportAnchorUnits=H||null!=he?dt:0));else G.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),ye=null;ye&&O.push(ye)}for(o=ko(l.getElementsByTagName("body")[0]),l=(o=t(o)).next();!l.done;l=o.next())(l=lo(l.value,a.periodStart,R,j,U,_,O,C,!1))&&s.push(l)}return s},eo.prototype.parseMedia=eo.prototype.parseMedia;var nr,ir,rr=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,ar=/^(\d+px|\d+em)$/,or=/^(\d+)px (\d+)px$/,sr=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,ur=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,cr=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,lr=/^(\d*(?:\.\d*)?)f$/,fr=/^(\d*(?:\.\d*)?)t$/,dr=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,hr={left:st,center:"center",right:"end",start:st,end:"end"},pr={left:"line-left",center:"center",right:"line-right"};function go(i){var a=[];if(!i)return a;for(var o=t(i.childNodes),s=o.next();!s.done;s=o.next())(s=s.value).nodeType==Node.ELEMENT_NODE&&"br"!==s.nodeName&&(s=go(s),a=a.concat(s));return a.length||a.push(i),a}function ko(i){if(!i)return[];for(var a=[],o=(i=t(i.childNodes)).next();!o.done;o=i.next())(o=o.value)instanceof Element&&(o.hasAttribute("begin")?a.push(o):a=a.concat(ko(o)));return a}function vo(i,a){for(var o="",s=t(i.childNodes),l=s.next();!l.done;l=s.next())"br"==(l=l.value).nodeName&&i.childNodes[0]!==l?o+="\n":l.childNodes&&0<l.childNodes.length?o+=vo(l,a):a?o+=l=(l=l.textContent.trim()).replace(/\s+/g," "):o+=l.textContent;return o}function lo(i,a,o,s,l,C,R,j,U){if(U&&"br"==i.nodeName)return(i=new Hd(0,0,"")).spacer=!0,i;var _=/^[\s\n]*$/.test(i.textContent),O=i.nodeType==Node.ELEMENT_NODE&&!i.hasAttribute("begin")&&!i.hasAttribute("end");if(i.nodeType!=Node.ELEMENT_NODE||O&&_||O&&!U)return null;_=wo(i.getAttribute("begin"),o),O=wo(i.getAttribute("end"),o);var B=wo(i.getAttribute("dur"),o);if(null==O&&null!=B&&(O=_+B),!U&&(null==_||null==O))throw new D(2,2,2001);if(_=U&&null==_?0:_+a,O=U&&null==O?0:O+a,B="",U=[],Array.from(i.childNodes).find((function(i){return i.nodeType===Node.TEXT_NODE&&/\S+/.test(i.textContent)})))B=vo(i,j);else for(var F=t(i.childNodes),H=F.next();!H.done;H=F.next())(H=lo(H.value,a,o,s,l,C,R,j,!0))&&(H.startTime=H.startTime||_,H.endTime=H.endTime||O,U.push(H));if((a=new Hd(_,O,B)).nestedCues=U,(C=xo(i,"region",C,"")[0])&&C.getAttribute("xml:id")){var G=C.getAttribute("xml:id");a.region=R.filter((function(i){return i.id==G}))[0]}return function yo(i,a,o,s,l){"rtl"==zo(a,o,l,"direction")&&(i.direction="rtl");var C=zo(a,o,l,"writingMode");"tb"==C||"tblr"==C?i.writingMode="vertical-lr":"tbrl"==C?i.writingMode="vertical-rl":"rltb"==C||"rl"==C?i.direction="rtl":C&&(i.direction=rt),(C=zo(a,o,l,"textAlign"))?(i.positionAlign=pr[C],i.lineAlign=hr[C],i.textAlign=tt[C.toUpperCase()]):i.textAlign="start",(C=zo(a,o,l,"displayAlign"))&&(i.displayAlign=it[C.toUpperCase()]);(C=zo(a,o,l,"color"))&&(i.color=C);(C=zo(a,o,l,"backgroundColor"))&&(i.backgroundColor=C);(C=zo(a,o,l,"fontFamily"))&&(i.fontFamily=C);(C=zo(a,o,l,"fontWeight"))&&"bold"==C&&(i.fontWeight=700),(C=zo(a,o,l,"wrapOption"))&&"noWrap"==C&&(i.wrapLine=!1),(C=zo(a,o,l,"lineHeight"))&&C.match(ar)&&(i.lineHeight=C),(C=zo(a,o,l,"fontSize"))&&C.match(ar)&&(i.fontSize=C),(C=zo(a,o,l,"fontStyle"))&&(i.fontStyle=ft[C.toUpperCase()]);if(s){C=s.getAttribute("imagetype");var R=s.getAttribute("encoding");s=s.textContent.trim(),"PNG"==C&&"Base64"==R&&s&&(i.backgroundImage="data:image/png;base64,"+s)}(o=jo(o,l,"textDecoration"))&&Ao(i,o),(a=Bo(a,l,"textDecoration"))&&Ao(i,a)}(a,i,C,s=xo(i,"backgroundImage",s,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0],l),a}function Ao(i,a){for(var o=a.split(" "),s=0;s<o.length;s++)switch(o[s]){case"underline":i.textDecoration.includes("underline")||i.textDecoration.push("underline");break;case"noUnderline":i.textDecoration.includes("underline")&&fc(i.textDecoration,"underline");break;case"lineThrough":i.textDecoration.includes("lineThrough")||i.textDecoration.push("lineThrough");break;case"noLineThrough":i.textDecoration.includes("lineThrough")&&fc(i.textDecoration,"lineThrough");break;case"overline":i.textDecoration.includes("overline")||i.textDecoration.push("overline");break;case"noOverline":i.textDecoration.includes("overline")&&fc(i.textDecoration,"overline")}}function zo(i,a,o,s){return(i=Bo(i,o,s))?i:jo(a,o,s)}function jo(i,a,o){if(!i)return null;for(var s=go(i),l=0;l<s.length;l++){var C=Lt.getAttributeNS(s[l],"http://www.w3.org/ns/ttml#styling",o);if(C)return C}return Co(i,a,o)}function Bo(i,a,o){var s=Lt.getAttributeNS(i,"http://www.w3.org/ns/ttml#styling",o);return s||Co(i,a,o)}function Co(i,a,o){i=xo(i,"style",a,"");for(var s=null,l=0;l<i.length;l++){var C=Lt.getAttributeNS(i[l],"http://www.w3.org/ns/ttml#styling",o);C||(C=Bo(i[l],a,o)),C&&(s=C)}return s}function xo(i,a,o,s,l){var C=[];if(!i||1>o.length)return C;var R=i;for(i=null;R&&!(i=l?Lt.getAttributeNS(R,l,a):R.getAttribute(a))&&(R=R.parentNode)instanceof Element;);if(a=i)for(l=(a=t(a=a.split(" "))).next();!l.done;l=a.next())for(l=l.value,R=(i=t(o)).next();!R.done;R=i.next())if(s+(R=R.value).getAttribute("xml:id")==l){C.push(R);break}return C}function wo(i,a){var o=null;if(sr.test(i)){o=sr.exec(i);var s=Number(o[1]),l=Number(o[2]),C=Number(o[3]),R=Number(o[4]);o=(C+=(R+=(Number(o[5])||0)/a.b)/a.frameRate)+60*l+3600*s}else ur.test(i)?o=Do(ur,i):cr.test(i)?o=Do(cr,i):lr.test(i)?(o=lr.exec(i),o=Number(o[1])/a.frameRate):fr.test(i)?(o=fr.exec(i),o=Number(o[1])/a.a):dr.test(i)&&(o=Do(dr,i));return o}function Do(i,a){var o=i.exec(a);return null==o||""==o[0]?null:(Number(o[4])||0)/1e3+(Number(o[3])||0)+60*(Number(o[2])||0)+3600*(Number(o[1])||0)}function fo(i,a,o,s){this.frameRate=Number(i)||30,this.b=Number(a)||1,this.a=Number(s),0==this.a&&(this.a=i?this.frameRate*this.b:1),o&&(i=/^(\d+) (\d+)$/g.exec(o))&&(this.frameRate*=Number(i[1])/Number(i[2]))}function Eo(){this.a=new eo}function Fo(){}function Ho(i,a,o){var s;if(s=/^align:(start|middle|center|end|left|right)$/.exec(a))a=s[1],i.textAlign="middle"==a?et:tt[a.toUpperCase()];else if(s=/^vertical:(lr|rl)$/.exec(a))i.writingMode="lr"==s[1]?"vertical-lr":"vertical-rl";else if(s=/^size:([\d.]+)%$/.exec(a))i.size=Number(s[1]);else if(s=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(a))i.position=Number(s[1]),s[2]&&(a=s[2],i.positionAlign="line-left"==a||"start"==a?"line-left":"line-right"==a||"end"==a?"line-right":"center");else{if(!(s=/^region:(.*)$/.exec(a))){e:{if(o=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(a))i.lineInterpretation=1,i.line=Number(o[1]),o[2]&&(i.lineAlign=ut[o[2].toUpperCase()]);else{if(!(o=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(a))){i=!1;break e}i.lineInterpretation=ot,i.line=Number(o[1]),o[2]&&(i.lineAlign=ut[o[2].toUpperCase()])}i=!0}return i}(a=function Io(i,a){var o=i.filter((function(i){return i.id==a}));return o.length?o[0]:(G.m("VTT parser could not find a region with id: ",a," The region will be ignored."),null)}(o,s[1]))&&(i.region=a)}return!0}function Go(i){if(null==(i=Vg(i,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var a=Number(i[2]),o=Number(i[3]);return 59<a||59<o?null:Number(i[4])/1e3+o+60*a+3600*(Number(i[1])||0)}function Jo(){this.a=null}function Ko(i,a,o){var s,l,C;return(new T).L("payl",Ff((function(i){s=Gb(i)}))).L("iden",Ff((function(i){l=Gb(i)}))).L("sttg",Ff((function(i){C=Gb(i)}))).parse(i),s?function Lo(i,a,o,s,l){if(i=new Hd(s,l,i),a&&(i.id=a),o)for(a=new Tg(o),o=Wg(a);o;)Ho(i,o,[])||G.m("VTT parser encountered an invalid VTT setting: ",o," The setting will be ignored."),Ug(a),o=Wg(a);return i}(s,l,C,a,o):null}function Mo(){}function Oo(){nr?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(nr=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Po):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function Po(i,a){var o=this;return u((function f(){var s;return x(f,(function(l){switch(l.j){case 1:return console.assert(o==navigator,'bad "this" for requestMediaKeySystemAccess'),v(l,nr.call(o,i,a),2);case 2:return Qo(s=l.s)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=nr,l.return(s)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=Ro,l.return(Ro.call(o,i,a)))}}))}))}function Ro(i,a){var o=this;return u((function f(){var s,l,C,R,j,U,_,O;return x(f,(function(B){switch(B.j){case 1:console.assert(o==navigator,'bad "this" for requestMediaKeySystemAccess'),s=So(i),l=[];for(var F=t(a),H=F.next();!H.done;H=F.next())C=H.value,R=To(C.videoCapabilities,s),j=To(C.audioCapabilities,s),C.videoCapabilities&&C.videoCapabilities.length&&!R.length||C.audioCapabilities&&C.audioCapabilities.length&&!j.length||((U=Object.assign({},C)).videoCapabilities=R,U.audioCapabilities=j,l.push(U));if(!l.length)throw(_=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",_.code=DOMException.NOT_SUPPORTED_ERR,_;return v(B,nr.call(o,i,l),2);case 2:return O=B.s,B.return(new Uo(O,s))}}))}))}function To(i,a){return i?i.filter((function(i){return!i.encryptionScheme||i.encryptionScheme==a})):i}function Vo(){}function Xo(){ir?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(ir=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Yo):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Yo(i){var a=this;return u((function e(){var o;return x(e,(function(s){switch(s.j){case 1:return console.assert(a==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(s,ir.call(a,i),2);case 2:return o=s.s,i.keySystemConfiguration&&o.keySystemAccess?Qo(o.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=ir,s.return(o)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Zo,s.return(Zo.call(a,i))):s.return(o)}}))}))}function Zo(i){var a=this;return u((function e(){var o,s,l,C,R,j,U;return x(e,(function(_){switch(_.j){case 1:return console.assert(a==navigator.mediaCapabilities,'bad "this" for decodingInfo'),o=null,i.keySystemConfiguration&&(s=i.keySystemConfiguration,l=s.keySystem,C=s.audio&&s.audio.encryptionScheme,R=s.video&&s.video.encryptionScheme,o=So(l),j={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:i},C&&C!=o||R&&R!=o)?_.return(j):v(_,ir.call(a,i),2);case 2:return(U=_.s).keySystemAccess&&(U.keySystemAccess=new Uo(U.keySystemAccess,o)),_.return(U)}}))}))}function Uo(i,a){this.b=i,this.a=a,this.keySystem=i.keySystem}function So(i){return i.startsWith("com.widevine")||i.startsWith("com.microsoft")||i.startsWith("com.adobe")||i.startsWith("org.w3")?"cenc":i.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",i,"Please contribute!"),null)}function Qo(i){var a=(i=i.getConfiguration()).audioCapabilities&&i.audioCapabilities[0];return!(!(i=i.videoCapabilities&&i.videoCapabilities[0]||a)||void 0===i.encryptionScheme)}function $o(){}function cn(){Oo(),Xo()}pt["application/ttml+xml"]=eo,A("shaka.text.Mp4TtmlParser",Eo),Eo.prototype.parseInit=function(i){var a=!1;if((new T).L("moov",Cf).L("trak",Cf).L("mdia",Cf).L("minf",Cf).L("stbl",Cf).ia("stsd",Ef).L("stpp",(function(i){a=!0,i.parser.stop()})).parse(i),!a)throw new D(2,2,2007)},Eo.prototype.parseInit=Eo.prototype.parseInit,Eo.prototype.parseMedia=function(i,a){var o=!1,s=[];if((new T).L("mdat",Ff(function(i){o=!0,s=s.concat(this.a.parseMedia(i,a))}.bind(this))).parse(i),!o)throw new D(2,2,2007);return s},Eo.prototype.parseMedia=Eo.prototype.parseMedia,pt['application/mp4; codecs="stpp"']=Eo,pt['application/mp4; codecs="stpp.ttml.im1t"']=Eo,pt['application/mp4; codecs="stpp.TTML.im1t"']=Eo,A("shaka.text.VttTextParser",Fo),Fo.prototype.parseInit=function(){},Fo.prototype.parseInit=Fo.prototype.parseInit,Fo.prototype.parseMedia=function(i,a){var o=Gb(i);if(o=(o=o.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(o[0]))throw new D(2,2,2e3);var s=a.segmentStart;if(null==s&&(s=0,o[0].includes("X-TIMESTAMP-MAP"))){var l=o[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),C=o[0].match(/MPEGTS:(\d+)/m);if(l&&C){if(null==(s=Go(new Tg(l[1]))))throw new D(2,2,2e3);s=a.periodStart+(Number(C[1])/9e4-s)}}C=[];var R=o[0].split("\n");for(l=1;l<R.length;l++)if(/^Region:/.test(R[l])){var j=new Tg(R[l]),U=new Jd;Wg(j),Ug(j);for(var _=Wg(j);_;){var O;e:{var B=U,F=_;if(O=/^id=(.*)$/.exec(F))B.id=O[1];else if(O=/^width=(\d{1,2}|100)%$/.exec(F))B.width=Number(O[1]);else if(O=/^lines=(\d+)$/.exec(F))B.height=Number(O[1]),B.heightUnits=2;else if(O=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(F))B.regionAnchorX=Number(O[1]),B.regionAnchorY=Number(O[2]);else if(O=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(F))B.viewportAnchorX=Number(O[1]),B.viewportAnchorY=Number(O[2]);else{if(!/^scroll=up$/.exec(F)){O=!1;break e}B.scroll="up"}O=!0}O||G.m("VTT parser encountered an invalid VTTRegion setting: ",_," The setting will be ignored."),Ug(j),_=Wg(j)}C.push(U)}for(l=[],j=1;j<o.length;j++){if(O=R=o[j].split("\n"),B=s,R=C,1==O.length&&!O[0]||/^NOTE($|[ \t])/.test(O[0])||"STYLE"==O[0])R=null;else{U=null,O[0].includes("--\x3e")||(U=O[0],O.splice(0,1)),F=Go(_=new Tg(O[0]));var H=Vg(_,/[ \t]+--\x3e[ \t]+/g),W=Go(_);if(null==F||null==H||null==W)throw new D(2,2,2001);for(O=new Hd(F+B,W+B,O.slice(1).join("\n").trim()),Ug(_),B=Wg(_);B;)Ho(O,B,R)||G.m("VTT parser encountered an invalid VTT setting: ",B," The setting will be ignored."),Ug(_),B=Wg(_);null!=U&&(O.id=U),R=O}R&&l.push(R)}return l},Fo.prototype.parseMedia=Fo.prototype.parseMedia,pt["text/vtt"]=Fo,pt['text/vtt; codecs="vtt"']=Fo,pt['text/vtt; codecs="wvtt"']=Fo,A("shaka.text.Mp4VttParser",Jo),Jo.prototype.parseInit=function(i){var a=!1;if((new T).L("moov",Cf).L("trak",Cf).L("mdia",Cf).ia("mdhd",function(i){0==i.version?(i.reader.P(4),i.reader.P(4),this.a=i.reader.I(),i.reader.P(4)):(i.reader.P(8),i.reader.P(8),this.a=i.reader.I(),i.reader.P(8)),i.reader.P(4)}.bind(this)).L("minf",Cf).L("stbl",Cf).ia("stsd",Ef).L("wvtt",(function(){a=!0})).parse(i),!this.a)throw new D(2,2,2008);if(!a)throw new D(2,2,2008)},Jo.prototype.parseInit=Jo.prototype.parseInit,Jo.prototype.parseMedia=function(i,a){var o=this;if(!this.a)throw G.error("No init segment for MP4+VTT!"),new D(2,2,2008);var s,l=0,C=[],R=[],j=!1,U=!1,_=!1,O=null;if((new T).L("moof",Cf).L("traf",Cf).ia("tfdt",(function(i){j=!0,l=0==i.version?i.reader.I():i.reader.Kb()})).ia("tfhd",(function(i){var a=i.flags;(i=i.reader).P(4),1&a&&i.P(8),2&a&&i.P(4),O=8&a?i.I():null})).ia("trun",(function(i){U=!0;var a=i.version,o=i.flags,s=(i=i.reader).I();1&o&&i.P(4),4&o&&i.P(4);for(var l=[],R=0;R<s;R++){var j={duration:null,sampleSize:null,Md:null};256&o&&(j.duration=i.I()),512&o&&(j.sampleSize=i.I()),1024&o&&i.P(4),2048&o&&(j.Md=0==a?i.I():i.xe()),l.push(j)}C=l})).L("mdat",Ff((function(i){_=!0,s=i}))).parse(i),!_&&!j&&!U)throw new D(2,2,2008);var B=l,F=new S(new DataView(s.buffer,s.byteOffset,s.byteLength),0);return C.forEach((function(i){var s=i.duration||O,C=i.Md?l+i.Md:B;B=C+(s||0);var j=0;do{var U=F.I();j+=U;var _=F.I(),H=null;"vttc"==(_=Bf(_))?8<U&&(H=F.gb(U-8)):("vtte"!=_&&G.error("Unknown box "+_+"! Skipping!"),F.P(U-8)),s?H&&R.push(Ko(H,a.periodStart+C/o.a,a.periodStart+B/o.a)):G.error("WVTT sample duration unknown, and no default found!")}while(i.sampleSize&&j<i.sampleSize)})),R.filter(Ie.Na)},Jo.prototype.parseMedia=Jo.prototype.parseMedia,pt['application/mp4; codecs="wvtt"']=Jo,A("shaka.util.Dom.createHTMLElement",(function(i){return document.createElement(i)})),A("shaka.util.Dom.createVideoElement",(function(){var i=document.createElement("video");return i.muted=!0,i.width=600,i.height=400,i})),A("shaka.util.Dom.asHTMLElement",(function(i){return i})),A("shaka.util.Dom.asHTMLMediaElement",(function(i){return i})),A("shaka.util.Dom.removeAllChildren",(function(i){for(;i.firstChild;)i.removeChild(i.firstChild)})),A("EmeEncryptionSchemePolyfill",Mo),Mo.install=Oo,A("McEncryptionSchemePolyfill",Vo),Vo.install=Xo,Uo.prototype.getConfiguration=function(){var i=this.b.getConfiguration();if(i.videoCapabilities)for(var a=t(i.videoCapabilities),o=a.next();!o.done;o=a.next())o.value.encryptionScheme=this.a;if(i.audioCapabilities)for(o=(a=t(i.audioCapabilities)).next();!o.done;o=a.next())o.value.encryptionScheme=this.a;return i},Uo.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},A("EncryptionSchemePolyfills",$o),$o.install=cn,void 0!==o&&o.af&&(o.af=$o)}.call(s,o,o,void 0),s.shaka)a[l]=s.shaka[l]}()}).call(this,o("n3a2"))}}]);